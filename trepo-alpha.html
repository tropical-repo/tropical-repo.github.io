<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; } /* Alert */
code span.an { color: #008000; } /* Annotation */
code span.at { } /* Attribute */
code span.bu { } /* BuiltIn */
code span.cf { color: #0000ff; } /* ControlFlow */
code span.ch { color: #008080; } /* Char */
code span.cn { } /* Constant */
code span.co { color: #008000; } /* Comment */
code span.cv { color: #008000; } /* CommentVar */
code span.do { color: #008000; } /* Documentation */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.im { } /* Import */
code span.in { color: #008000; } /* Information */
code span.kw { color: #0000ff; } /* Keyword */
code span.op { } /* Operator */
code span.ot { color: #ff4000; } /* Other */
code span.pp { color: #ff4000; } /* Preprocessor */
code span.sc { color: #008080; } /* SpecialChar */
code span.ss { color: #008080; } /* SpecialString */
code span.st { color: #008080; } /* String */
code span.va { } /* Variable */
code span.vs { color: #008080; } /* VerbatimString */
code span.wa { color: #008000; font-weight: bold; } /* Warning */
</style>

  <!--radix_placeholder_meta_tags-->
  <title>TropicalRepo: 6 Alpha Diversity Estimates</title>

  <meta property="description" itemprop="description" content="Reproducible workflow for ... In this workflow, ...."/>

  <link rel="license" href="https://creativecommons.org/licenses/by/4.0/"/>
  <link rel="icon" type="image/vnd.microsoft.icon" href="assets/favicon.ico"/>


  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="TropicalRepo: 6 Alpha Diversity Estimates"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="Reproducible workflow for ... In this workflow, ...."/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:site_name" content="TropicalRepo"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="TropicalRepo: 6 Alpha Diversity Estimates"/>
  <meta property="twitter:description" content="Reproducible workflow for ... In this workflow, ...."/>

  <!--/radix_placeholder_meta_tags-->
  
  <meta name="citation_reference" content="citation_title=A guide to the application of hill numbers to DNA-based diversity analyses;citation_publication_date=2019;citation_volume=19;citation_author=Antton Alberdi;citation_author=M Thomas P Gilbert"/>
  <meta name="citation_reference" content="citation_title=Hilldiv: An r package for the integral analysis of diversity based on hill numbers;citation_publication_date=2019;citation_author=Antton Alberdi;citation_author=M Thomas P Gilbert"/>
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","bibliography","output"]}},"value":[{"type":"character","attributes":{},"value":["6 Alpha Diversity Estimates"]},{"type":"character","attributes":{},"value":["Reproducible workflow for ... In this workflow, ....\n"]},{"type":"character","attributes":{},"value":["assets/cite.bib"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["css","toc","toc_depth"]}},"value":[{"type":"character","attributes":{},"value":["assets/styles.css"]},{"type":"logical","attributes":{},"value":[true]},{"type":"integer","attributes":{},"value":[3]}]}]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  <!--radix_placeholder_navigation_in_header-->
  <meta name="distill:offset" content=""/>

  <script type="application/javascript">

    window.headroom_prevent_pin = false;

    window.document.addEventListener("DOMContentLoaded", function (event) {

      // initialize headroom for banner
      var header = $('header').get(0);
      var headerHeight = header.offsetHeight;
      var headroom = new Headroom(header, {
        tolerance: 5,
        onPin : function() {
          if (window.headroom_prevent_pin) {
            window.headroom_prevent_pin = false;
            headroom.unpin();
          }
        }
      });
      headroom.init();
      if(window.location.hash)
        headroom.unpin();
      $(header).addClass('headroom--transition');

      // offset scroll location for banner on hash change
      // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
      window.addEventListener("hashchange", function(event) {
        window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
      });

      // responsive menu
      $('.distill-site-header').each(function(i, val) {
        var topnav = $(this);
        var toggle = topnav.find('.nav-toggle');
        toggle.on('click', function() {
          topnav.toggleClass('responsive');
        });
      });

      // nav dropdowns
      $('.nav-dropbtn').click(function(e) {
        $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
        $(this).parent().siblings('.nav-dropdown')
           .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $("body").click(function(e){
        $('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $(".nav-dropdown").click(function(e){
        e.stopPropagation();
      });
    });
  </script>

  <style type="text/css">

  /* Theme (user-documented overrideables for nav appearance) */

  .distill-site-nav {
    color: rgba(255, 255, 255, 0.8);
    background-color: #0F2E3D;
    font-size: 15px;
    font-weight: 300;
  }

  .distill-site-nav a {
    color: inherit;
    text-decoration: none;
  }

  .distill-site-nav a:hover {
    color: white;
  }

  @media print {
    .distill-site-nav {
      display: none;
    }
  }

  .distill-site-header {

  }

  .distill-site-footer {

  }


  /* Site Header */

  .distill-site-header {
    width: 100%;
    box-sizing: border-box;
    z-index: 3;
  }

  .distill-site-header .nav-left {
    display: inline-block;
    margin-left: 8px;
  }

  @media screen and (max-width: 768px) {
    .distill-site-header .nav-left {
      margin-left: 0;
    }
  }


  .distill-site-header .nav-right {
    float: right;
    margin-right: 8px;
  }

  .distill-site-header a,
  .distill-site-header .title {
    display: inline-block;
    text-align: center;
    padding: 14px 10px 14px 10px;
  }

  .distill-site-header .title {
    font-size: 18px;
    min-width: 150px;
  }

  .distill-site-header .logo {
    padding: 0;
  }

  .distill-site-header .logo img {
    display: none;
    max-height: 20px;
    width: auto;
    margin-bottom: -4px;
  }

  .distill-site-header .nav-image img {
    max-height: 18px;
    width: auto;
    display: inline-block;
    margin-bottom: -3px;
  }



  @media screen and (min-width: 1000px) {
    .distill-site-header .logo img {
      display: inline-block;
    }
    .distill-site-header .nav-left {
      margin-left: 20px;
    }
    .distill-site-header .nav-right {
      margin-right: 20px;
    }
    .distill-site-header .title {
      padding-left: 12px;
    }
  }


  .distill-site-header .nav-toggle {
    display: none;
  }

  .nav-dropdown {
    display: inline-block;
    position: relative;
  }

  .nav-dropdown .nav-dropbtn {
    border: none;
    outline: none;
    color: rgba(255, 255, 255, 0.8);
    padding: 16px 10px;
    background-color: transparent;
    font-family: inherit;
    font-size: inherit;
    font-weight: inherit;
    margin: 0;
    margin-top: 1px;
    z-index: 2;
  }

  .nav-dropdown-content {
    display: none;
    position: absolute;
    background-color: white;
    min-width: 200px;
    border: 1px solid rgba(0,0,0,0.15);
    border-radius: 4px;
    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
    z-index: 1;
    margin-top: 2px;
    white-space: nowrap;
    padding-top: 4px;
    padding-bottom: 4px;
  }

  .nav-dropdown-content hr {
    margin-top: 4px;
    margin-bottom: 4px;
    border: none;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .nav-dropdown-active {
    display: block;
  }

  .nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
    color: black;
    padding: 6px 24px;
    text-decoration: none;
    display: block;
    text-align: left;
  }

  .nav-dropdown-content .nav-dropdown-header {
    display: block;
    padding: 5px 24px;
    padding-bottom: 0;
    text-transform: uppercase;
    font-size: 14px;
    color: #999999;
    white-space: nowrap;
  }

  .nav-dropdown:hover .nav-dropbtn {
    color: white;
  }

  .nav-dropdown-content a:hover {
    background-color: #ddd;
    color: black;
  }

  .nav-right .nav-dropdown-content {
    margin-left: -45%;
    right: 0;
  }

  @media screen and (max-width: 768px) {
    .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
    .distill-site-header a.nav-toggle {
      float: right;
      display: block;
    }
    .distill-site-header .title {
      margin-left: 0;
    }
    .distill-site-header .nav-right {
      margin-right: 0;
    }
    .distill-site-header {
      overflow: hidden;
    }
    .nav-right .nav-dropdown-content {
      margin-left: 0;
    }
  }


  @media screen and (max-width: 768px) {
    .distill-site-header.responsive {position: relative; min-height: 500px; }
    .distill-site-header.responsive a.nav-toggle {
      position: absolute;
      right: 0;
      top: 0;
    }
    .distill-site-header.responsive a,
    .distill-site-header.responsive .nav-dropdown {
      display: block;
      text-align: left;
    }
    .distill-site-header.responsive .nav-left,
    .distill-site-header.responsive .nav-right {
      width: 100%;
    }
    .distill-site-header.responsive .nav-dropdown {float: none;}
    .distill-site-header.responsive .nav-dropdown-content {position: relative;}
    .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
      display: block;
      width: 100%;
      text-align: left;
    }
  }

  /* Site Footer */

  .distill-site-footer {
    width: 100%;
    overflow: hidden;
    box-sizing: border-box;
    z-index: 3;
    margin-top: 30px;
    padding-top: 30px;
    padding-bottom: 30px;
    text-align: center;
  }

  /* Headroom */

  d-title {
    padding-top: 6rem;
  }

  @media print {
    d-title {
      padding-top: 4rem;
    }
  }

  .headroom {
    z-index: 1000;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
  }

  .headroom--transition {
    transition: all .4s ease-in-out;
  }

  .headroom--unpinned {
    top: -100px;
  }

  .headroom--pinned {
    top: 0;
  }

  /* adjust viewport for navbar height */
  /* helps vertically center bootstrap (non-distill) content */
  .min-vh-100 {
    min-height: calc(100vh - 100px) !important;
  }

  </style>

  <script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
  <link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
  <link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
  <script src="site_libs/headroom-0.9.4/headroom.min.js"></script>
  <script src="site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
  <script src="site_libs/fuse-6.4.1/fuse.min.js"></script>

  <script type="application/javascript">

  function getMeta(metaName) {
    var metas = document.getElementsByTagName('meta');
    for (let i = 0; i < metas.length; i++) {
      if (metas[i].getAttribute('name') === metaName) {
        return metas[i].getAttribute('content');
      }
    }
    return '';
  }

  function offsetURL(url) {
    var offset = getMeta('distill:offset');
    return offset ? offset + '/' + url : url;
  }

  function createFuseIndex() {

    // create fuse index
    var options = {
      keys: [
        { name: 'title', weight: 20 },
        { name: 'categories', weight: 15 },
        { name: 'description', weight: 10 },
        { name: 'contents', weight: 5 },
      ],
      ignoreLocation: true,
      threshold: 0
    };
    var fuse = new window.Fuse([], options);

    // fetch the main search.json
    return fetch(offsetURL('search.json'))
      .then(function(response) {
        if (response.status == 200) {
          return response.json().then(function(json) {
            // index main articles
            json.articles.forEach(function(article) {
              fuse.add(article);
            });
            // download collections and index their articles
            return Promise.all(json.collections.map(function(collection) {
              return fetch(offsetURL(collection)).then(function(response) {
                if (response.status === 200) {
                  return response.json().then(function(articles) {
                    articles.forEach(function(article) {
                      fuse.add(article);
                    });
                  })
                } else {
                  return Promise.reject(
                    new Error('Unexpected status from search index request: ' +
                              response.status)
                  );
                }
              });
            })).then(function() {
              return fuse;
            });
          });

        } else {
          return Promise.reject(
            new Error('Unexpected status from search index request: ' +
                        response.status)
          );
        }
      });
  }

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // get search element (bail if we don't have one)
    var searchEl = window.document.getElementById('distill-search');
    if (!searchEl)
      return;

    createFuseIndex()
      .then(function(fuse) {

        // make search box visible
        searchEl.classList.remove('hidden');

        // initialize autocomplete
        var options = {
          autoselect: true,
          hint: false,
          minLength: 2,
        };
        window.autocomplete(searchEl, options, [{
          source: function(query, callback) {
            const searchOptions = {
              isCaseSensitive: false,
              shouldSort: true,
              minMatchCharLength: 2,
              limit: 10,
            };
            var results = fuse.search(query, searchOptions);
            callback(results
              .map(function(result) { return result.item; })
            );
          },
          templates: {
            suggestion: function(suggestion) {
              var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
                ? `<img src="${offsetURL(suggestion.preview)}"</img>`
                : '';
              var html = `
                <div class="search-item">
                  <h3>${suggestion.title}</h3>
                  <div class="search-item-description">
                    ${suggestion.description || ''}
                  </div>
                  <div class="search-item-preview">
                    ${img}
                  </div>
                </div>
              `;
              return html;
            }
          }
        }]).on('autocomplete:selected', function(event, suggestion) {
          window.location.href = offsetURL(suggestion.path);
        });
        // remove inline display style on autocompleter (we want to
        // manage responsive display via css)
        $('.algolia-autocomplete').css("display", "");
      })
      .catch(function(error) {
        console.log(error);
      });

  });

  </script>

  <style type="text/css">

  .nav-search {
    font-size: x-small;
  }

  /* Algolioa Autocomplete */

  .algolia-autocomplete {
    display: inline-block;
    margin-left: 10px;
    vertical-align: sub;
    background-color: white;
    color: black;
    padding: 6px;
    padding-top: 8px;
    padding-bottom: 0;
    border-radius: 6px;
    border: 1px #0F2E3D solid;
    width: 180px;
  }


  @media screen and (max-width: 768px) {
    .distill-site-nav .algolia-autocomplete {
      display: none;
      visibility: hidden;
    }
    .distill-site-nav.responsive .algolia-autocomplete {
      display: inline-block;
      visibility: visible;
    }
    .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
      margin-left: 0;
      width: 400px;
      max-height: 400px;
    }
  }

  .algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
    width: 90%;
    outline: none;
    border: none;
  }

  .algolia-autocomplete .aa-hint {
    color: #999;
  }
  .algolia-autocomplete .aa-dropdown-menu {
    width: 550px;
    max-height: 70vh;
    overflow-x: visible;
    overflow-y: scroll;
    padding: 5px;
    margin-top: 3px;
    margin-left: -150px;
    background-color: #fff;
    border-radius: 5px;
    border: 1px solid #999;
    border-top: none;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
    cursor: pointer;
    padding: 5px 4px;
    border-bottom: 1px solid #eee;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
    border-bottom: none;
    margin-bottom: 2px;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
    overflow: hidden;
    font-size: 0.8em;
    line-height: 1.4em;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
    font-size: 1rem;
    margin-block-start: 0;
    margin-block-end: 5px;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
    display: inline-block;
    overflow: hidden;
    height: 2.8em;
    width: 80%;
    margin-right: 4%;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
    display: inline-block;
    width: 15%;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
    height: 3em;
    width: auto;
    display: none;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
    display: initial;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
    background-color: #eee;
  }
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
    font-weight: bold;
    font-style: normal;
  }

  </style>


  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure img {
    width: 100%;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        var refHtml = $('#ref-' + $(this).attr('data-cites')).html();
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="site_libs/header-attrs-2.6/header-attrs.js"></script>
  <script src="site_libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
  <script src="site_libs/jquery-3.5.1/jquery.min.js"></script>
  <link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
  <script src="site_libs/datatables-binding-0.17/datatables.js"></script>
  <link href="site_libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
  <link href="site_libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
  <script src="site_libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
  <script src="site_libs/jszip-1.10.20/jszip.min.js"></script>
  <link href="site_libs/dt-ext-buttons-1.10.20/css/buttons.dataTables.min.css" rel="stylesheet" />
  <script src="site_libs/dt-ext-buttons-1.10.20/js/dataTables.buttons.min.js"></script>
  <script src="site_libs/dt-ext-buttons-1.10.20/js/buttons.flash.min.js"></script>
  <script src="site_libs/dt-ext-buttons-1.10.20/js/buttons.html5.min.js"></script>
  <script src="site_libs/dt-ext-buttons-1.10.20/js/buttons.colVis.min.js"></script>
  <script src="site_libs/dt-ext-buttons-1.10.20/js/buttons.print.min.js"></script>
  <link href="site_libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet" />
  <script src="site_libs/nouislider-7.0.10/jquery.nouislider.min.js"></script>
  <link href="site_libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet" />
  <script src="site_libs/selectize-0.12.0/selectize.min.js"></script>
  <link href="site_libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
  <script src="site_libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>
  <script src="site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <style type="text/css">
  /* Whole document: */
  @import url('https://fonts.googleapis.com/css?family=PT+Sans|PT+Serif|Lato:300|Roboto:300|Nunito+Sans:300|Inconsolata|Source+Sans+Pro|Work+Sans:200,300,400,500');
  /********************************/
  /* controls general properties of site*/
  /********************************/

  body {
    color: #414141;
  /*  line-height: 1.7;
    font-size: 17px; */
    background-color: #FEFEFE;
  }

  d-title h1{
  font-size: 2.1em;
  font-family: 'Work Sans';
  font-weight: 300;
  }

  d-article h1 {
    font-size: 1.8em;
    font-family: 'Work Sans', 'Source Sans Pro', 'PT Sans';
    font-weight: 300;
  }

  d-article h2 {
    font-size: 1.65em;
    font-family: 'Work Sans', 'Source Sans Pro', 'PT Sans';
    font-weight: 500;
  }

  d-article h3 {
    margin-top: 1em;
  }

  d-byline .authors-affiliations {
    grid-column-end: span 3;
    grid-column-gap: 8px;
  }

  img.orcid-id {
    margin: 0;
  }

  a.name:-webkit-any-link {
    text-decoration: underline;
    text-decoration-style: dotted;
  }

  a.affiliation:-webkit-any-link {
    text-decoration: underline;
    text-decoration-style: dotted;
  }

  blockquote p {
  	font-size: 1.3em;
  	font-family: 'Lato';
    font-style: normal;
    margin: 0.5em 0 0.5em;
  }

  d-article li {
    margin: 0px 0px 4px;
  }

  /********************************/
  /* controls CODE*/
  /********************************/

  /** pre.sourceCode controls code block without lang **/

  /** Controls r code  **/

  pre.sourceCode.r {
    margin-top: 0px;
     color: #333333;
     background-color: #E8E8E8;
     border-radius: 3px;
     font-size: 0.80em;
     font-family: 'Monaco', 'PT Mono', monospace;
     overflow-x: scroll !important;
     border-left: 6px solid #323232;
     border-top: 1px solid #B7B7B7;
     border-right: 1px solid #B7B7B7;
     border-bottom: 1px solid #B7B7B7;
     padding: 18px 0px 18px 20px;
   }

   pre.sourceCode.bash {
     margin-top: 0px;
      color: #333333;
      background-color: #E8E8E8;
      border-radius: 3px;
      font-size: 0.80em;
      font-family: 'Monaco', 'PT Mono', monospace;
      overflow-x: scroll !important;
      border-left: 6px solid #FC6464;
      border-top: 1px solid #B7B7B7;
      border-right: 1px solid #B7B7B7;
      border-bottom: 1px solid #B7B7B7;
      padding: 18px 0px 18px 20px;
    }
  /** Controls code output **/

  d-article pre {
     margin-top: 0px;
      color: #333333;
      background-color: #FAFAFA;
      font-size: 0.8em;
      border: 1px solid #ccc;
      overflow-x: scroll !important;
      padding:  10px 10px 10px 18px;
      border-radius: 5px;

    }

  /** Controls inline code  **/

  p code {
    background-color: #E8E8E8;
    border-radius: 3px;
    font-size: 0.8em;
    font-family: 'Monaco', 'PT Mono', monospace;
    overflow-x: scroll !important;
    margin-bottom: 20px;
    color: #BF2727;
  }

  d-article aside code {
    background-color: #E8E8E8;
    border-radius: 3px;
    font-family: 'Monaco', 'PT Mono', monospace;
    color: #BF2727;
  }

  /********************************/
  /* controls NAV BAR and HEADERS*/
  /********************************/

  .nav-dropdown-content .nav-dropdown-header {
    text-transform: none;
  }

  .distill-site-header .logo {
    padding: 0;
  }

  .distill-site-header  {
    width: 100%;
    box-sizing: border-box;
    z-index: 3;
  }

  .headroom {
      z-index: 1000;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
  }
  .distill-site-nav {
      background-color: #00203F;
      font-size: 15px;
      font-weight: 300;
  }

  img {
    margin: 5px;
  }

  /** LIGHTBOX MARKUP **/
  .thumbnail {
    max-width: 100%;
    position: relative;
  }

  /** DETAILS fold down**/

  details {
    background-color: hsla(206, 95%, 20%, 0.2);
    cursor: pointer;
    color: #2d2d2d;
    margin-bottom:1vh;
    padding: 1em;
    border: none;
    text-align: left;
    outline: none;
  }

  .active, details:hover {
    transition: max-height 0.2s ease-out;
    outline: none;

    /* background-color: #acc2c2; */
  }


  details {
    display: flex;
    justify-content: space-between;
    align-content: center;
    border-radius: 4px;
    outline: none;
  }

  details.active {
    border-bottom-left-radius: 0;
    border-bottom-right-radius: 0;
    outline: none;
  }

  summary::-webkit-details-marker {
    display: none;
    outline: none;
  }

  summary:focus {
    outline: none;
  }

  summary::after {
    float: right;
    font-family: "Font Awesome 5 Free";
    content: "\f0fe";
  }

  details[open] summary::after {
    float: right;
    font-family: "Font Awesome 5 Free";
    content: "\f146";
  }


  /********************************/
  /* dygraph*/
  /********************************/

  </style>
  <!--/radix_placeholder_site_in_header-->

  <link rel="stylesheet" href="assets/styles.css" type="text/css"/>

</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"6 Alpha Diversity Estimates","description":"Reproducible workflow for ... In this workflow, ....","authors":[]}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a class="logo" href="index.html">
<img src="assets/icon.png" alt="Logo"/>
</a>
<a href="index.html" class="title">TropicalRepo</a>
<input id="distill-search" class="nav-search hidden" type="text" placeholder="Search..."/>
</div>
<div class="nav-right">
<a href="trepo-summary.html">Summary</a>
<a href="trepo-physical.html">Physical</a>
<div class="nav-dropdown">
<button class="nav-dropbtn">
Macrofauna
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<hr/>
<a href="trepo-macrotaxa.html">4. Macrofauna Taxa</a>
<a href="trepo-temporal.html">3. Temporal Diversity</a>
<a href="trepo-macrobeta.html">2. Beta Diversity</a>
<a href="trepo-macroalpha.html">1. Alpha Diversity</a>
</div>
</div>
<div class="nav-dropdown">
<button class="nav-dropbtn">
Microbial
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<span class="nav-dropdown-header">Diversity Workflows</span>
<hr/>
<a href="trepo-metadata.html">9. Metadata</a>
<a href="trepo-da.html">8. DA ASVs &amp; OTUs</a>
<a href="trepo-beta.html">7. Beta Diversity</a>
<a href="trepo-alpha.html">6. Alpha Diversity</a>
<a href="trepo-taxa.html">5. Taxonomic</a>
<hr/>
<span class="nav-dropdown-header">Processing Workflows</span>
<a href="trepo-pime.html">4. PIME</a>
<a href="trepo-otu.html">3. OTU Clustering</a>
<a href="trepo-data-prep.html">2. Data Set Prep</a>
<a href="trepo-dada2.html">1. DADA2</a>
<hr/>
</div>
</div>
<a href="trepo-data.html">Data</a>
<a href="https://github.com/tropical-repo/web/" aria-label="Link to source">
<i class="fab fa-github" aria-hidden="true"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>6 Alpha Diversity Estimates</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p>Reproducible workflow for … In this workflow, ….</p></p>
</div>


<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#synopsis">Synopsis</a></li>
<li><a href="#full-data-set-asv">Full Data Set (ASV)</a>
<ul>
<li><a href="#read-distribution">Read Distribution</a>
<ul>
<li><a href="#histogram-of-read-counts">Histogram of Read Counts</a></li>
<li><a href="#rarefaction-curves">Rarefaction Curves</a></li>
</ul></li>
<li><a href="#alpha-diversity">Alpha Diversity</a>
<ul>
<li><a href="#calculate-hill-numbers">Calculate Hill Numbers</a></li>
<li><a href="#sample-summary">Sample Summary</a></li>
<li><a href="#normality-tests">Normality Tests</a></li>
<li><a href="#significance-tests">Significance Tests</a></li>
<li><a href="#posthoc-analyses">PostHoc Analyses</a></li>
<li><a href="#alpha-diversity-plots">Alpha Diversity Plots</a></li>
</ul></li>
<li><a href="#alpha-diversity-by-site">Alpha Diversity by Site</a>
<ul>
<li><a href="#full-data-set-split-by-site">Full data set split by site</a></li>
<li><a href="#pime-filtered-data-set">PIME filtered data set</a></li>
</ul></li>
</ul></li>
<li><a href="#merged-data-set-asv">Merged Data Set (ASV)</a>
<ul>
<li><a href="#read-distribution-1">Read Distribution</a>
<ul>
<li><a href="#histogram-of-read-counts-1">Histogram of Read Counts</a></li>
<li><a href="#rarefaction-curves-1">Rarefaction Curves</a></li>
</ul></li>
<li><a href="#alpha-diversity-1">Alpha Diversity</a>
<ul>
<li><a href="#calculate-hill-numbers-1">Calculate Hill Numbers</a></li>
<li><a href="#sample-summary-1">Sample Summary</a></li>
<li><a href="#normality-tests-1">Normality Tests</a></li>
<li><a href="#significance-tests-1">Significance Tests</a></li>
<li><a href="#posthoc-analyses-1">PostHoc Analyses</a></li>
<li><a href="#alpha-diversity-plots-1">Alpha Diversity Plots</a></li>
</ul></li>
<li><a href="#alpha-diversity-by-site-1">Alpha Diversity by Site</a>
<ul>
<li><a href="#full-data-set-split-by-site-1">Full data set split by site</a></li>
<li><a href="#pime-filtered-data-set-1">PIME filtered data set</a></li>
</ul></li>
<li><a href="#source-code">Source Code</a></li>
</ul></li>
</ul>
</nav>
</div>
<blockquote>
<p>Hit the <em>Hide Code</em> button to hide the R code.</p>
</blockquote>
<aside>
<div class="layout-chunk" data-layout="l-body">
<input onclick="codefolder(&#39;pre.sourceCode&#39;);" type="button" value="Hide Code" id="codefolder-button" style="position: absolute; right: 14%; z-index: 200"/>
<script>
  function codefolder(query) {

    var x = document.querySelectorAll(query);
    if (x.length === 0) return;

    function toggle_vis(o) {
      var d = o.style.display;
      o.style.display = (d === 'block' || d === '') ? 'none':'block';
    }

    for (i = 0; i < x.length; i++) {
      var y = x[i];
      toggle_vis(y);
    }

    var elem = document.getElementById("codefolder-button");
    if (elem.value === "Hide Code") elem.value = "Show Code";
    else elem.value = "Hide Code";
  }
</script>
</div>
</aside>
<h1 id="synopsis">Synopsis</h1>
<p>This workflow contains diversity assessments for the <strong>full</strong> data set—all replicate samples—and the <strong>merged</strong> data set—replicates combined by sample. In order to run the workflow, you either need to first run the <a href="trepo-dada2.html">DADA2 Workflow</a> <strong>and</strong> the <a href="trepo-data-prep.html">Data Preparation workflow</a> <strong>or</strong> begin with the output files from the Data Preparation workflow. See the <a href="data-availability.html">Data Availability</a> page for complete details.</p>
<p>In this workflow…</p>
<h1 id="full-data-set-asv">Full Data Set (ASV)</h1>
<div class="layout-chunk" data-layout="l-body">

</div>
<h2 id="read-distribution">Read Distribution</h2>
<h3 id="histogram-of-read-counts">Histogram of Read Counts</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>ssu_max <span class="ot">&lt;-</span> <span class="fu">max</span>(ssu_ps_samp_data<span class="sc">$</span>total_reads) <span class="sc">+</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  (<span class="fl">0.2</span> <span class="sc">*</span> <span class="fu">max</span>(ssu_ps_samp_data<span class="sc">$</span>total_reads))</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>ssu_p_hist <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(ssu_ps_samp_data,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(ssu_ps_samp_data<span class="sc">$</span>total_reads)) <span class="sc">+</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>         <span class="fu">geom_histogram</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, ssu_max, <span class="at">by =</span> <span class="dv">5000</span>),</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;grey&quot;</span>) <span class="sc">+</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>         <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Distribution of total reads (FULL)&quot;</span>,</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">caption =</span> <span class="st">&quot;Bin width equals 5000 reads&quot;</span>) <span class="sc">+</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;No. of reads&quot;</span>, <span class="at">y =</span> <span class="st">&quot;No. of samples&quot;</span>) <span class="sc">+</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
</div>
<div class="layout-chunk" data-layout="l-body">
<p><img src="trepo-alpha_files/figure-html5/unnamed-chunk-5-1.png" width="624" /></p>
</div>
<h3 id="rarefaction-curves">Rarefaction Curves</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>tmp_select <span class="ot">&lt;-</span> ssu_amp_data</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>tmp_select<span class="sc">$</span>metadata<span class="sc">$</span>SITE <span class="ot">&lt;-</span> <span class="fu">factor</span>(tmp_select<span class="sc">$</span>metadata<span class="sc">$</span>SITE, </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;ALMR&quot;</span>, <span class="st">&quot;PAST&quot;</span>, <span class="st">&quot;CRIS&quot;</span>, <span class="st">&quot;PUCL&quot;</span>))</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>ssu_rare_curve1 <span class="ot">&lt;-</span> <span class="fu">amp_rarecurve</span>(</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  tmp_select,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">stepsize =</span> <span class="dv">1000</span>,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">color_by =</span> <span class="st">&quot;SITE&quot;</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> swel_col) </span></code></pre></div>
</div>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>ssu_rare_curve1  </span></code></pre></div>
<p><img src="trepo-alpha_files/figure-html5/unnamed-chunk-7-1.png" width="624" /></p>
</div>
<p>For a quick comparison, we can facet the above data by Site.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>ssu_rare_curve2 <span class="ot">&lt;-</span> <span class="fu">amp_rarecurve</span>(</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  tmp_select,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">stepsize =</span> <span class="dv">1000</span>,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">color_by =</span> <span class="st">&quot;SITE&quot;</span>,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">facet_by =</span> <span class="st">&quot;SITE&quot;</span>,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">facet_scales =</span> <span class="st">&quot;free&quot;</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>)  <span class="sc">+</span> <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> swel_col)</span></code></pre></div>
</div>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>ssu_rare_curve2</span></code></pre></div>
<p><img src="trepo-alpha_files/figure-html5/unnamed-chunk-9-1.png" width="624" /></p>
</div>
<p>In the <strong>full</strong> data set, there was a minimum read count of 2699, a median of 13974 reads, and a maximum of 182257 reads. After PIME filtering, there was a minimum read count of 2027, a median of 2347.5 reads, and a maximum of 2482 reads.</p>
<h2 id="alpha-diversity">Alpha Diversity</h2>
<p>To account for presence of rare sequence variants caused by sequencing errors or other technical artifacts, we use Hill numbers <span class="citation" data-cites="alberdi2019guide">(<a href="#ref-alberdi2019guide" role="doc-biblioref">Alberdi and Gilbert 2019a</a>)</span>. Hill numbers allow the weight put on rare versus abundant sequence variants to be scaled while providing intuitive comparisons of diversity levels using “effective number of ASVs” as a measuring unit. This approach allows for balancing the over representation of rare ASVs that might be inflated due to sequencing errors.</p>
<p>We will then use Shapiro-Wilk tests to test for normalcy and then, depending on the results, either use parametric ANOVA or non-parametric Kruskal-Wallis to compare alpha diversity among treatments.</p>
<h3 id="calculate-hill-numbers">Calculate Hill Numbers</h3>
<p>To calculate Hill numbers, we use the R package <code>hilldiv</code> <span class="citation" data-cites="alberdi2019hilldiv">(<a href="#ref-alberdi2019hilldiv" role="doc-biblioref">Alberdi and Gilbert 2019b</a>)</span>. We calculate three metrics that put more or less weight on common species:</p>
<ol type="1">
<li>Observed richness, where <code>q-value = 0</code>.</li>
<li>Shannon exponential, which weighs ASVs by their frequency, where <code>q-value = 1</code>.</li>
<li>Simpson multiplicative inverse, which over weighs abundant ASVs, where <code>q-value = 2</code>.</li>
</ol>
<p>We perform each analysis against the full data set and the PIME filtered data set using the function <code>hill_div</code>.</p>
<p>The command is as follows:</p>
<p><code>hill_div(count = x, qvalue = i, tree = ultrametric_tree)</code>, where <code>x</code> is the sample by ASV table, <code>i</code> is the q-value corresponding to the metric of interest and <code>tree</code> is an ultrametric formatted phylogenetic tree (see below).</p>
<p>We first transform all the data to relative abundance values, and compute new trees.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>ssu_alpha_ds <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;ssu_ps_work&quot;</span>, <span class="st">&quot;ssu_ps_pime&quot;</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>()</span></code></pre></div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> ssu_alpha_ds) {</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  tmp_ps <span class="ot">&lt;-</span> <span class="fu">transform_sample_counts</span>(<span class="fu">get</span>(i), <span class="cf">function</span>(otu) otu<span class="sc">/</span><span class="fu">sum</span>(otu))</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  tmp_ps<span class="sc">@</span>phy_tree <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  tmp_tree <span class="ot">&lt;-</span> <span class="fu">rtree</span>(<span class="fu">ntaxa</span>(tmp_ps), <span class="at">rooted =</span> <span class="cn">TRUE</span>,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">tip.label =</span> <span class="fu">taxa_names</span>(tmp_ps))</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  tmp_ps_norm <span class="ot">&lt;-</span> <span class="fu">merge_phyloseq</span>(tmp_ps, sample_data, tmp_tree)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  tmp_asv <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">t</span>(<span class="fu">otu_table</span>(tmp_ps_norm)))</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  tmp_ps_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_norm&quot;</span>))</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(tmp_ps_name, tmp_ps_norm)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  tmp_asv_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_tu&quot;</span>))</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(tmp_asv_name, tmp_asv)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<h4 id="no-phylogenetic-tree">No phylogenetic tree</h4>
<p>Next, we run the analysis for all three metrics on the data sets without a tree.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>qvalue <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> qvalue) {</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> ssu_alpha_ds) {</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>     tmp_asv <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(j, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_tu&quot;</span>)))</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>     tmp_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">hill_div</span>(tmp_asv, <span class="at">qvalue =</span> i))</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>     tmp_df <span class="ot">&lt;-</span> tmp_df <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;tmp_name&quot;</span> <span class="ot">=</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>                              tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">&quot;SamName&quot;</span>)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>     tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(j, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_h&quot;</span>, i))</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>     <span class="fu">print</span>(tmp_name)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>     <span class="fu">assign</span>(tmp_name, tmp_df)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>(<span class="at">pattern =</span> <span class="st">&quot;_h&quot;</span>)</span></code></pre></div>
</div>
<p>And make summary tables to add back into each <code>ps</code> object.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> ssu_alpha_ds) {</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>     tmp_obs <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_h0&quot;</span>)))</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>     tmp_sha <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_h1&quot;</span>)))</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>     tmp_sim <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_h2&quot;</span>)))</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>     tmp_hill <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(tmp_obs, tmp_sha, <span class="at">by =</span> <span class="st">&quot;SamName&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>       dplyr<span class="sc">::</span><span class="fu">left_join</span>(., tmp_sim, <span class="at">by =</span> <span class="st">&quot;SamName&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>       dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;Observed&quot;</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">&quot;Shannon_exp&quot;</span> <span class="ot">=</span> <span class="dv">3</span>, <span class="st">&quot;InvSimpson&quot;</span> <span class="ot">=</span> <span class="dv">4</span>)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>     tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_hill&quot;</span>))</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>     <span class="fu">assign</span>(tmp_name, tmp_hill)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>(<span class="at">pattern =</span> <span class="st">&quot;_hill&quot;</span>)</span></code></pre></div>
</div>
<p>And then create the new objects with the diversity data.</p>
<div class="layout-chunk" data-layout="l-body">

</div>
<h4 id="with-a-phylogenetic-tree">With a phylogenetic tree</h4>
<p>We can also run the tests using the phylogenetic tree to assess <strong>lineage</strong> diversity rather that ASV diversity for the PIME data set. For this part we will only use PIME filtered data sets. We do a quick check to ensure the ASV names in the ASV table and the tip names in the new phylogenetic tree are identical.</p>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>ssu_alpha_ds_tree <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;ssu_ps_pime&quot;</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>qvalue <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> qvalue) {</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> ssu_alpha_ds_tree) {</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>     tmp_asv <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(j, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_tu&quot;</span>)))</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>     tmp_tree <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(j, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_tree_ult&quot;</span>)))</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>     tmp_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">hill_div</span>(tmp_asv, <span class="at">qvalue =</span> i, <span class="at">tree =</span> tmp_tree))</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>     tmp_df <span class="ot">&lt;-</span> tmp_df <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;tmp_name&quot;</span> <span class="ot">=</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>                              tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">&quot;SamName&quot;</span>)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>     tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(j, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_ht&quot;</span>, i))</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>     <span class="fu">print</span>(tmp_name)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>     <span class="fu">assign</span>(tmp_name, tmp_df)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>(<span class="at">pattern=</span><span class="st">&quot;_ht&quot;</span>)</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(ssu_ps_pime_ht0, ssu_ps_pime_ht1, ssu_ps_pime_ht2, ssu_ps_pime_merge_ht0, </span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>     ssu_ps_pime_merge_ht1, ssu_ps_pime_merge_ht2, </span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>     <span class="at">file =</span> <span class="st">&quot;files/trepo/alpha/rdata/ssu_ps_pime_hill_tree_tests.rdata&quot;</span>)</span></code></pre></div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> ssu_alpha_ds_tree) {</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>     tmp_obs <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_ht0&quot;</span>)))</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>     tmp_sha <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_ht1&quot;</span>)))</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>     tmp_sim <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_ht2&quot;</span>)))</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>     tmp_hill <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(tmp_obs, tmp_sha, <span class="at">by =</span> <span class="st">&quot;SamName&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>       dplyr<span class="sc">::</span><span class="fu">left_join</span>(., tmp_sim, <span class="at">by =</span> <span class="st">&quot;SamName&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>       dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;Observed_pt&quot;</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">&quot;Shannon_exp_pt&quot;</span> <span class="ot">=</span> <span class="dv">3</span>, <span class="st">&quot;InvSimpson_pt&quot;</span> <span class="ot">=</span> <span class="dv">4</span>)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>     tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_hill_t&quot;</span>))</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>     <span class="fu">assign</span>(tmp_name, tmp_hill)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>()</span></code></pre></div>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<h3 id="sample-summary">Sample Summary</h3>
<p>Now we summarize the data for each sample against all three metrics. The table contains the results of ASV diversity estimates from the full data set and the PIME filtered data set, as well as the lineage diversity from the PIME data set.</p>
<p>The suffix <code>_p</code> indicates metrics for the PIME data set and the suffix <code>_pt</code> indicates the lineage diversity for the PIME data set.</p>
<div class="layout-chunk" data-layout="l-body">

</div>
<p><br/></p>
<div class="layout-chunk" data-layout="l-page">
<div id="cbl6xscg20l628pi6qc4" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="cbl6xscg20l628pi6qc4">{"x":{"filter":"top","filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"851\" data-max=\"8733\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"665\" data-max=\"1381\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"434.565831333878\" data-max=\"856.615316789306\" data-scale=\"13\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"589.176825315374\" data-max=\"3427.53084106575\" data-scale=\"13\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"437.598878519005\" data-max=\"1092.16841771729\" data-scale=\"13\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"130.555529592224\" data-max=\"241.107486764345\" data-scale=\"13\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"323.44449975112\" data-max=\"1511.05836924269\" data-scale=\"13\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"248.500363049617\" data-max=\"767.6609365738\" data-scale=\"13\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"12.9017769300623\" data-max=\"15.3918494310283\" data-scale=\"14\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","extensions":["Buttons"],"caption":"<caption style=\"caption-side: bottom; text-align: left;\">\n  Table: \n  <em>Sample summary table including\n            ASV diversity indices for FULL and PIME filtered data.\n            Use the buttons to navigate through the table or\n            download a copy.<\/em>\n<\/caption>","data":[["ALMR_W01_IB_HS_R1","ALMR_W01_IB_HS_R2","ALMR_W01_IB_HS_R3","ALMR_W03_IB_HS_R1","ALMR_W03_IB_HS_R2","ALMR_W03_IB_HS_R3","ALMR_W05_IB_HS_R1","ALMR_W05_IB_HS_R2","ALMR_W05_IB_HS_R3","ALMR_W07_IB_HS_R1","ALMR_W07_IB_HS_R2","ALMR_W07_IB_HS_R3","ALMR_W09_IB_HS_R1","ALMR_W09_IB_HS_R2","ALMR_W09_IB_HS_R3","ALMR_W11_IB_HS_R1","ALMR_W11_IB_HS_R2","ALMR_W11_IB_HS_R3","ALMR_W13_IB_NS_R1","ALMR_W13_IB_NS_R2","ALMR_W13_IB_NS_R3","ALMR_W15_IB_NS_R1","ALMR_W15_IB_NS_R2","ALMR_W15_IB_NS_R3","ALMR_W17_IB_NS_R1","ALMR_W17_IB_NS_R2","ALMR_W17_IB_NS_R3","ALMR_W19_IB_NS_R1","ALMR_W19_IB_NS_R2","ALMR_W19_IB_NS_R3","ALMR_W21_IB_NS_R1","ALMR_W21_IB_NS_R2","ALMR_W21_IB_NS_R3","ALMR_W23_IB_NS_R1","ALMR_W23_IB_NS_R2","ALMR_W23_IB_NS_R3","ALMR_W25_IB_NS_R1","ALMR_W25_IB_NS_R2","ALMR_W25_IB_NS_R3","ALMR_W27_IB_NS_R1","ALMR_W27_IB_NS_R2","ALMR_W27_IB_NS_R3","ALMR_W29_IB_NS_R1","ALMR_W29_IB_NS_R2","ALMR_W31_IB_NS_R1","ALMR_W31_IB_NS_R2","ALMR_W31_IB_NS_R3","ALMR_W33_IB_NS_R1","ALMR_W33_IB_NS_R2","ALMR_W33_IB_NS_R3","ALMR_W35_IB_NS_R1","ALMR_W35_IB_NS_R2","ALMR_W35_IB_NS_R3","ALMR_W37_IB_NS_R2","ALMR_W37_IB_NS_R3","ALMR_W39_IB_NS_R1","ALMR_W39_IB_NS_R2","ALMR_W39_IB_NS_R3","ALMR_W41_IB_HS_R1","ALMR_W41_IB_HS_R2","ALMR_W41_IB_HS_R3","ALMR_W43_IB_HS_R1","ALMR_W43_IB_HS_R2","ALMR_W43_IB_HS_R3","ALMR_W45_IB_HS_R1","ALMR_W45_IB_HS_R2","ALMR_W45_IB_HS_R3","ALMR_W47_IB_HS_R1","ALMR_W47_IB_HS_R2","ALMR_W47_IB_HS_R3","ALMR_W49_IB_HS_R1","ALMR_W49_IB_HS_R2","ALMR_W49_IB_HS_R3","ALMR_W51_IB_HS_R1","ALMR_W51_IB_HS_R2","ALMR_W51_IB_HS_R3","CRIS_W01_OB_HS_R1","CRIS_W01_OB_HS_R2","CRIS_W01_OB_HS_R3","CRIS_W03_OB_HS_R1","CRIS_W03_OB_HS_R2","CRIS_W03_OB_HS_R3","CRIS_W05_OB_HS_R1","CRIS_W05_OB_HS_R2","CRIS_W05_OB_HS_R3","CRIS_W07_OB_HS_R1","CRIS_W07_OB_HS_R2","CRIS_W07_OB_HS_R3","CRIS_W09_OB_HS_R1","CRIS_W09_OB_HS_R2","CRIS_W09_OB_HS_R3","CRIS_W11_OB_HS_R1","CRIS_W11_OB_HS_R2","CRIS_W11_OB_HS_R3","CRIS_W13_OB_NS_R1","CRIS_W13_OB_NS_R2","CRIS_W13_OB_NS_R3","CRIS_W15_OB_NS_R1","CRIS_W15_OB_NS_R2","CRIS_W15_OB_NS_R3","CRIS_W17_OB_NS_R1","CRIS_W17_OB_NS_R2","CRIS_W17_OB_NS_R3","CRIS_W19_OB_NS_R1","CRIS_W19_OB_NS_R2","CRIS_W19_OB_NS_R3","CRIS_W21_OB_NS_R1","CRIS_W21_OB_NS_R2","CRIS_W21_OB_NS_R3","CRIS_W23_OB_NS_R1","CRIS_W23_OB_NS_R2","CRIS_W23_OB_NS_R3","CRIS_W25_OB_NS_R1","CRIS_W25_OB_NS_R2","CRIS_W25_OB_NS_R3","CRIS_W27_OB_NS_R1","CRIS_W27_OB_NS_R2","CRIS_W27_OB_NS_R3","CRIS_W29_OB_NS_R1","CRIS_W29_OB_NS_R2","CRIS_W29_OB_NS_R3","CRIS_W31_OB_NS_R1","CRIS_W31_OB_NS_R2","CRIS_W31_OB_NS_R3","CRIS_W33_OB_NS_R1","CRIS_W33_OB_NS_R2","CRIS_W33_OB_NS_R3","CRIS_W35_OB_NS_R1","CRIS_W35_OB_NS_R2","CRIS_W35_OB_NS_R3","CRIS_W37_OB_NS_R1","CRIS_W37_OB_NS_R2","CRIS_W37_OB_NS_R3","CRIS_W39_OB_NS_R1","CRIS_W39_OB_NS_R2","CRIS_W39_OB_NS_R3","CRIS_W41_OB_HS_R1","CRIS_W41_OB_HS_R2","CRIS_W43_OB_HS_R1","CRIS_W43_OB_HS_R2","CRIS_W43_OB_HS_R3","CRIS_W45_OB_HS_R2","CRIS_W45_OB_HS_R3","CRIS_W47_OB_HS_R1","CRIS_W47_OB_HS_R2","CRIS_W47_OB_HS_R3","CRIS_W49_OB_HS_R1","CRIS_W49_OB_HS_R2","CRIS_W49_OB_HS_R3","CRIS_W51_OB_HS_R1","CRIS_W51_OB_HS_R2","CRIS_W51_OB_HS_R3","PAST_W01_IB_HS_R1","PAST_W01_IB_HS_R2","PAST_W01_IB_HS_R3","PAST_W03_IB_HS_R1","PAST_W03_IB_HS_R2","PAST_W03_IB_HS_R3","PAST_W05_IB_HS_R1","PAST_W05_IB_HS_R2","PAST_W05_IB_HS_R3","PAST_W07_IB_HS_R1","PAST_W07_IB_HS_R2","PAST_W07_IB_HS_R3","PAST_W09_IB_HS_R1","PAST_W09_IB_HS_R2","PAST_W09_IB_HS_R3","PAST_W11_IB_HS_R1","PAST_W11_IB_HS_R2","PAST_W11_IB_HS_R3","PAST_W13_IB_NS_R1","PAST_W13_IB_NS_R2","PAST_W13_IB_NS_R3","PAST_W15_IB_NS_R1","PAST_W15_IB_NS_R2","PAST_W15_IB_NS_R3","PAST_W17_IB_NS_R1","PAST_W17_IB_NS_R2","PAST_W17_IB_NS_R3","PAST_W19_IB_NS_R1","PAST_W19_IB_NS_R2","PAST_W19_IB_NS_R3","PAST_W21_IB_NS_R1","PAST_W21_IB_NS_R2","PAST_W21_IB_NS_R3","PAST_W23_IB_NS_R1","PAST_W23_IB_NS_R2","PAST_W23_IB_NS_R3","PAST_W25_IB_NS_R1","PAST_W25_IB_NS_R2","PAST_W25_IB_NS_R3","PAST_W27_IB_NS_R1","PAST_W27_IB_NS_R2","PAST_W29_IB_NS_R1","PAST_W29_IB_NS_R2","PAST_W29_IB_NS_R3","PAST_W31_IB_NS_R1","PAST_W31_IB_NS_R2","PAST_W31_IB_NS_R3","PAST_W33_IB_NS_R1","PAST_W33_IB_NS_R2","PAST_W33_IB_NS_R3","PAST_W35_IB_NS_R1","PAST_W35_IB_NS_R2","PAST_W35_IB_NS_R3","PAST_W37_IB_NS_R1","PAST_W37_IB_NS_R3","PAST_W39_IB_NS_R1","PAST_W39_IB_NS_R2","PAST_W39_IB_NS_R3","PAST_W41_IB_HS_R1","PAST_W41_IB_HS_R2","PAST_W41_IB_HS_R3","PAST_W43_IB_HS_R1","PAST_W43_IB_HS_R2","PAST_W43_IB_HS_R3","PAST_W45_IB_HS_R1","PAST_W45_IB_HS_R2","PAST_W45_IB_HS_R3","PAST_W47_IB_HS_R1","PAST_W47_IB_HS_R2","PAST_W47_IB_HS_R3","PAST_W49_IB_HS_R1","PAST_W49_IB_HS_R2","PAST_W49_IB_HS_R3","PAST_W51_IB_HS_R1","PAST_W51_IB_HS_R2","PAST_W51_IB_HS_R3","PUCL_W01_OB_HS_R1","PUCL_W01_OB_HS_R2","PUCL_W01_OB_HS_R3","PUCL_W03_OB_HS_R1","PUCL_W03_OB_HS_R2","PUCL_W03_OB_HS_R3","PUCL_W05_OB_HS_R1","PUCL_W05_OB_HS_R2","PUCL_W05_OB_HS_R3","PUCL_W07_OB_HS_R1","PUCL_W07_OB_HS_R2","PUCL_W07_OB_HS_R3","PUCL_W09_OB_HS_R1","PUCL_W09_OB_HS_R2","PUCL_W09_OB_HS_R3","PUCL_W11_OB_HS_R1","PUCL_W11_OB_HS_R2","PUCL_W11_OB_HS_R3","PUCL_W13_OB_NS_R1","PUCL_W13_OB_NS_R2","PUCL_W13_OB_NS_R3","PUCL_W15_OB_NS_R1","PUCL_W15_OB_NS_R2","PUCL_W15_OB_NS_R3","PUCL_W17_OB_NS_R1","PUCL_W17_OB_NS_R2","PUCL_W17_OB_NS_R3","PUCL_W19_OB_NS_R1","PUCL_W19_OB_NS_R2","PUCL_W19_OB_NS_R3","PUCL_W21_OB_NS_R1","PUCL_W21_OB_NS_R2","PUCL_W21_OB_NS_R3","PUCL_W23_OB_NS_R1","PUCL_W23_OB_NS_R2","PUCL_W23_OB_NS_R3","PUCL_W25_OB_NS_R1","PUCL_W25_OB_NS_R2","PUCL_W25_OB_NS_R3","PUCL_W27_OB_NS_R1","PUCL_W27_OB_NS_R2","PUCL_W27_OB_NS_R3","PUCL_W29_OB_NS_R1","PUCL_W29_OB_NS_R2","PUCL_W29_OB_NS_R3","PUCL_W31_OB_NS_R1","PUCL_W31_OB_NS_R2","PUCL_W31_OB_NS_R3","PUCL_W33_OB_NS_R1","PUCL_W33_OB_NS_R2","PUCL_W33_OB_NS_R3","PUCL_W35_OB_NS_R1","PUCL_W35_OB_NS_R2","PUCL_W37_OB_NS_R1","PUCL_W37_OB_NS_R2","PUCL_W37_OB_NS_R3","PUCL_W39_OB_NS_R1","PUCL_W39_OB_NS_R2","PUCL_W39_OB_NS_R3","PUCL_W41_OB_HS_R1","PUCL_W41_OB_HS_R2","PUCL_W41_OB_HS_R3","PUCL_W43_OB_HS_R1","PUCL_W43_OB_HS_R3","PUCL_W45_OB_HS_R1","PUCL_W45_OB_HS_R2","PUCL_W45_OB_HS_R3","PUCL_W47_OB_HS_R1","PUCL_W47_OB_HS_R2","PUCL_W47_OB_HS_R3","PUCL_W49_OB_HS_R1","PUCL_W49_OB_HS_R2","PUCL_W49_OB_HS_R3","PUCL_W51_OB_HS_R1","PUCL_W51_OB_HS_R2","PUCL_W51_OB_HS_R3"],["ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL"],["W01","W01","W01","W03","W03","W03","W05","W05","W05","W07","W07","W07","W09","W09","W09","W11","W11","W11","W13","W13","W13","W15","W15","W15","W17","W17","W17","W19","W19","W19","W21","W21","W21","W23","W23","W23","W25","W25","W25","W27","W27","W27","W29","W29","W31","W31","W31","W33","W33","W33","W35","W35","W35","W37","W37","W39","W39","W39","W41","W41","W41","W43","W43","W43","W45","W45","W45","W47","W47","W47","W49","W49","W49","W51","W51","W51","W01","W01","W01","W03","W03","W03","W05","W05","W05","W07","W07","W07","W09","W09","W09","W11","W11","W11","W13","W13","W13","W15","W15","W15","W17","W17","W17","W19","W19","W19","W21","W21","W21","W23","W23","W23","W25","W25","W25","W27","W27","W27","W29","W29","W29","W31","W31","W31","W33","W33","W33","W35","W35","W35","W37","W37","W37","W39","W39","W39","W41","W41","W43","W43","W43","W45","W45","W47","W47","W47","W49","W49","W49","W51","W51","W51","W01","W01","W01","W03","W03","W03","W05","W05","W05","W07","W07","W07","W09","W09","W09","W11","W11","W11","W13","W13","W13","W15","W15","W15","W17","W17","W17","W19","W19","W19","W21","W21","W21","W23","W23","W23","W25","W25","W25","W27","W27","W29","W29","W29","W31","W31","W31","W33","W33","W33","W35","W35","W35","W37","W37","W39","W39","W39","W41","W41","W41","W43","W43","W43","W45","W45","W45","W47","W47","W47","W49","W49","W49","W51","W51","W51","W01","W01","W01","W03","W03","W03","W05","W05","W05","W07","W07","W07","W09","W09","W09","W11","W11","W11","W13","W13","W13","W15","W15","W15","W17","W17","W17","W19","W19","W19","W21","W21","W21","W23","W23","W23","W25","W25","W25","W27","W27","W27","W29","W29","W29","W31","W31","W31","W33","W33","W33","W35","W35","W37","W37","W37","W39","W39","W39","W41","W41","W41","W43","W43","W45","W45","W45","W47","W47","W47","W49","W49","W49","W51","W51","W51"],["IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB"],["HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS"],["R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R1","R2","R3","R1","R2","R3","R1","R2","R3","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R1","R2","R3","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3","R1","R2","R3"],[2729,3067,3533,3491,3192,3182,3612,3445,1772,4743,3560,4665,3585,3696,3091,2432,2413,2487,4025,1745,2339,2798,3040,1562,3240,4240,3591,1845,1740,1863,2313,2061,2015,1415,5053,2216,2101,2305,2030,3570,3631,2578,2191,2509,1468,1759,2142,3660,5221,4713,4976,4350,4016,1651,2108,2075,4291,3970,3314,2479,1850,974,2524,2691,5006,2374,4881,6150,6094,7230,5207,4958,5320,4685,5072,4716,3090,3230,2822,3452,3720,1878,2320,1149,3267,3055,3169,3037,2456,3880,2195,2108,2023,1699,2359,3857,1429,1801,5665,1516,2165,2143,2171,4025,1960,2176,3098,851,1545,1458,2701,1895,1524,1867,2021,2352,2252,1884,1912,1539,1810,2000,1946,1805,6946,4139,3279,1925,2363,2862,1943,1306,2748,2373,2457,1638,1356,1917,2028,2019,2112,1886,3811,2850,3115,3725,3404,1344,5232,3627,2554,3623,3566,2749,3380,2567,2894,3836,3428,2707,3624,3520,3778,3410,3985,3687,3086,2455,1685,2444,3344,1867,2346,2219,2413,1991,4660,3080,1973,1721,2265,2253,3639,3073,1985,2116,2688,1938,2575,3726,4244,2052,2378,1818,2161,2158,2697,2884,2752,3778,8010,8165,2662,2778,2586,3135,2347,2253,2048,1534,3009,882,3022,2442,1672,1246,6273,7337,7255,8733,2156,7989,4682,2576,2864,3716,3615,3463,2704,2153,3389,2996,3490,3196,3148,3617,2818,3249,3110,2389,1904,1811,3107,2491,1988,1682,1704,3257,3194,2970,2789,2750,2594,1528,2201,2111,2865,2598,2260,1754,2131,1595,1839,1537,3344,3100,2995,1811,2332,1043,2264,1629,1978,1139,4028,5754,3415,6994,6135,3168,3201,1369,2167,2956,1406,953,2040,2940,2784,1944,1961,1619,6694,6030,3469,6890,6133,3827,4363,5309,2239,2633,2056,3563],[969,1128,1155,1068,1062,1062,1154,1103,918,1195,1129,1217,1131,1125,1051,1009,1074,1030,1167,930,1016,1054,1107,917,1111,1107,1128,915,926,933,1004,1004,965,854,1156,933,993,1007,956,1126,1068,1032,979,1016,892,969,1013,1134,1214,1183,1169,1138,1123,918,1023,996,1184,1157,1114,1042,968,730,1016,1040,1092,1048,1185,1099,1191,1213,1187,1128,1187,1181,1125,1144,1111,1137,1124,1102,1142,940,1016,691,1133,1106,1083,1164,1073,1157,1008,994,977,951,1014,1153,883,972,1191,880,995,1049,1018,1159,963,1006,1098,682,912,836,1089,999,895,978,951,1043,1011,964,950,911,944,966,963,906,1207,1129,1135,1021,1026,1069,961,805,1069,1051,1077,942,820,962,979,984,1015,947,1119,1088,1082,1149,1102,724,1150,1117,1062,1120,1129,1058,1123,985,1016,1139,1150,1088,1161,1121,1155,1127,1164,1172,1116,1048,892,968,1079,978,1044,907,927,884,1138,1094,990,923,986,994,1139,1103,976,965,1068,970,1058,1143,1193,945,1002,937,958,952,1111,1041,1027,900,1004,1008,1077,1070,1088,1053,1052,1023,969,886,1102,665,1076,1011,900,794,1224,1208,1225,1172,993,1125,1133,1063,1102,1129,1146,992,1161,1078,1240,1244,1286,1252,1246,1311,1131,1192,1181,1073,1040,1026,1230,1142,1075,1038,950,1229,1228,1200,1134,1151,1163,934,1113,1031,1172,1119,1093,1048,1089,972,1065,971,1250,1183,1217,998,1123,740,1084,966,1041,817,1261,1300,1233,1368,1350,1262,1220,922,1115,1199,902,728,1077,1192,1211,1057,1063,965,1363,1340,1229,1323,1381,1193,1293,1348,1130,1061,1054,1238],[616.159611352728,709.922765997159,724.448779744529,672.880318232231,668.995072331473,667.429176140979,722.8504146267,697.22291059246,586.023059886187,748.751114132634,702.495846323126,758.079010384748,706.520156160493,703.383400163731,664.573508897519,642.046255701698,682.969123410914,654.709817766063,736.854902174971,598.703446405734,641.899646384573,668.401688774134,702.009728205349,589.219693214469,702.078846812632,697.233309286795,707.932021575458,589.834571371285,585.789741299834,594.511419932832,636.508931031228,637.991537236546,611.924996192156,547.84627536388,721.434327740641,594.93330725543,628.247274482147,635.771993927961,612.046158262251,707.293446980456,674.929054019335,657.229712552741,622.617056823629,644.755664846166,570.681962378198,611.377035458997,643.272099609882,717.171042653379,755.886163771665,740.013610187386,732.864808174593,709.758503757936,701.518598636112,583.01222659209,647.604820678372,632.618440321747,744.049293416917,721.7277972506,696.519892575899,661.612382499806,614.037172825099,475.846704149634,640.366459379815,660.95348789537,687.246618053754,664.930774459183,743.543149293071,689.94424629895,751.2608689619,761.636557097359,739.426264097513,712.049335015752,739.776744402314,742.442090970138,707.742558204264,710.74785764061,695.676156324441,713.526540494741,710.455748740383,693.731674038433,714.81120835771,594.821605515768,637.320197707708,444.024262149022,705.023221822258,699.186737849529,684.657015421309,733.909386100315,672.752246428398,726.47867139523,638.152814684982,632.206445426759,620.499035660721,606.264749841743,639.009013501618,724.136294328931,566.090825351031,618.451809329233,739.370322988334,560.5097698209,631.611978623454,663.757771602623,642.190715778611,724.843805931817,611.764411615011,637.205272135332,690.775999087518,443.55443378661,578.611581252882,539.444268775703,688.786443630194,631.349669289867,574.599214631562,622.038479503618,602.056711358102,662.592116741587,638.271522658636,617.903214679374,594.683800111623,582.398992235684,602.529487277146,607.505181126856,616.978575534823,581.836928920583,754.855895403075,705.223587954957,715.693519647871,638.290199337136,648.742232667085,672.951050159895,607.455707532495,520.78261097532,670.496372376248,664.129114939924,680.965592399546,599.849173613194,524.807938754927,615.758935105654,625.032450292497,623.339377853164,635.832249791298,605.14462398135,697.602847832129,687.390566231745,682.48031196879,722.623803049411,697.188350397631,468.874141480514,723.33432204376,694.882269090387,669.91535673065,708.660962049857,707.897380988786,662.857865400997,706.701373587514,631.394537014417,642.676186595531,721.179612569904,717.862666536552,688.916669161109,728.849358501497,703.617900198486,725.684906554354,704.780328020658,727.527367186438,736.653290161733,701.481336244986,664.294798441256,567.350759621199,613.577465958919,679.904160959971,618.455371960596,661.343125671763,578.393785441474,587.488564910469,568.537340262972,714.676230657061,688.799647930967,627.799077644705,588.724922091426,620.881483168699,634.374605851632,715.345131455963,690.36739175837,623.273732487962,611.375288979412,668.076739738094,614.952569719598,668.192418570884,713.47414499773,746.912661209111,601.551768798263,636.15363111289,597.403204409055,605.208943091953,606.843015028518,694.15501405013,656.371665754227,647.701767476448,576.321283758293,642.021841552696,637.59757571271,680.633088065592,667.186305595111,681.252501880102,671.289194253242,664.447851264111,654.056567595588,615.962868044051,568.025768064089,701.713633598404,434.565831333878,680.749969892453,649.082079040964,576.424979567493,509.461454579922,760.825990656198,758.408855174199,766.347811675953,738.260435083288,625.913809763557,711.514791648933,709.981110059342,669.180994233068,692.683915734272,706.407080610787,718.097919847071,628.280679382219,731.481417508647,681.847790984561,773.674076635769,776.952533034571,798.459866604418,774.333915252138,772.612043577902,815.662341840795,706.161204860292,739.736149571483,743.418623017543,672.20264105007,655.624169974296,647.598101431718,760.510599544776,717.554905804555,679.287180466292,654.45042992506,597.764363572094,763.913402114684,761.793159383544,751.508818887614,708.871741074324,714.497322293975,731.935415224307,598.015469480009,697.508469281696,654.73998416812,732.069052769466,695.723844177245,684.772766675442,659.726335617226,686.883903935638,610.776018884301,666.991283101667,617.633946485659,774.385801316564,745.710453824873,761.520122314441,632.379169900808,704.763553389131,479.930997285064,684.812809472524,613.009659210717,653.62030647822,523.24006937389,780.841731080375,812.596321110704,770.574166611781,845.313798738973,834.735908565686,783.939167221423,757.966755908254,585.421314787617,698.372097818543,753.588207107029,576.670373859163,470.155978867576,671.631401098902,748.184500317123,759.002130905972,671.017764099134,670.03830815004,612.003276018242,846.025970582455,829.563821913559,770.540849704429,815.263589716385,856.615316789306,744.828494664055,798.935435310605,834.000819802723,707.309582848323,672.916606445536,662.625768754706,771.003652584382],[1268.12035567941,1468.44377377455,1749.9802536977,1440.95145795304,1373.03482124674,1397.84094420783,1595.17831685916,1609.95450673292,969.446016236686,2157.07777179003,1620.33812382845,2132.02713951968,1749.74886539656,1733.05304346537,1584.56721814171,1323.87128237761,1264.45533287266,1339.06106500611,1816.88627344955,936.172962327063,1261.64274170635,1382.67667137758,1442.45151919506,885.37983199916,1480.53208236969,1876.69523900671,1656.59377692335,986.326890456036,997.824053907926,970.278134992992,1272.12641171586,1171.72128794889,1209.8896017236,870.575321659767,2142.53187538549,1173.35735365248,1080.95835472089,1243.97237332009,1085.34929963707,1787.29135241076,1476.96663289558,1381.66334325416,1144.35238390802,1279.80825204884,882.286083770875,1002.07570941696,1092.45388404081,1655.31663439359,2317.44106229287,2063.69277542716,1936.53557824447,1829.43780195689,1738.63653716728,951.039567273959,1171.5854292732,1108.79832779599,1859.53509405758,1699.82303699008,1551.39813480228,1250.76065536008,1021.03242448757,609.164356240448,1309.62741283501,1256.66072367913,1808.54886941846,1252.40598601736,1885.56060588938,2152.64353725365,2377.71197518293,2559.46123331707,2092.93985951738,2013.89974129434,2286.04107697177,2010.77220635518,2007.9906712187,2016.39801246152,1663.32512887819,1704.05449983129,1521.45217172026,1849.90633791402,1948.38575660238,1164.15440300278,1333.49612450273,642.158669990138,1727.17263475224,1636.55768858911,1715.89371440018,1666.6256994379,1415.57923987927,2042.41852388593,1306.37876363231,1225.59635942728,1216.65960772357,1041.96887141733,1365.98658823236,1982.09444790612,878.279407326538,1127.72849115606,2583.48360351046,989.829256193828,1234.33998018939,1240.54845231767,1280.65154015283,1976.70730280195,1165.66440359488,1279.59855474474,1698.90218798136,612.786139198558,1022.02427864173,962.035950507433,1497.51164999713,1165.44715159327,945.140470987438,1119.27150268666,1184.14041237025,1342.78647925383,1353.01331629913,1145.60826491327,1151.40727311333,948.949284963411,1120.93730626979,1203.16311911973,1202.00852659259,1091.23155417163,2768.53089370033,1954.95107763235,1704.57050668191,1180.11426155784,1344.14393832627,1574.40748516925,1217.90067338892,832.30717916368,1557.73940014209,1414.6144397107,1405.62736129283,1031.61046243887,876.028651031683,1186.79071668367,1243.54086666689,1180.3992683702,1272.2510649103,1075.59718852071,1806.11368616643,1618.63178308717,1679.66982639519,1955.96682056261,1793.69977335116,890.260527781788,2217.40515116165,1903.15042307833,1451.49691832228,1834.21456896872,1726.31279863417,1427.54265928007,1667.44058126437,1447.95760242828,1554.26177765372,1951.97123297255,1785.34467558306,1531.29118198377,1928.47025131872,1859.92814658336,1924.66477424784,1784.79323809643,2002.73666777661,1924.21618228857,1623.3822457044,1406.55047871733,1031.60854267783,1378.6975619148,1575.31372745458,1043.17563488088,1312.69739425519,1254.95347769151,1283.66003263193,1138.80073846777,2084.20481552664,1619.49540939663,1156.73830638836,1007.66109831201,1274.33325711662,1287.79793971428,1840.54958930687,1595.50395634877,1182.84428926579,1210.06862915789,1391.46303042387,1100.41329907831,1419.56742960839,1780.314353291,2068.79827293256,1169.4932830048,1200.46363919425,1104.58352551663,1345.66870622828,1329.55496117315,1508.84535825233,1463.38413231627,1498.34813779023,1649.57829051957,2577.86922557726,2725.22807228908,1471.60835393062,1455.16917734134,1384.30018865743,1576.61518265511,1291.02427109651,1267.55004959499,1184.50890680822,914.639925403101,1494.16240170216,589.176825315374,1674.53545217447,1414.91252739629,1012.06799216886,803.234314265343,2607.45570363153,2854.66718197412,2881.43792436683,2934.56336162739,1222.8056451444,2853.67113888042,2080.11943448549,1433.64476793491,1448.55644339065,1767.15732246159,1816.80621283369,1611.52168277182,1723.97816146476,1387.45198465954,2082.43853450976,1838.88406197722,2077.65618326584,1891.36933490148,1921.67488130871,2109.54046544839,1700.21039440046,1829.41157380313,1793.78152948092,1458.94093382736,1236.21595907477,1204.15766119409,1832.57856329964,1580.68598660593,1333.31771172357,1164.09530599157,1103.11292511389,2038.57673380883,2011.42265642808,1768.04449881427,1697.34383657668,1696.6032255854,1655.21234192825,1079.34858245778,1477.52159704179,1369.97951664241,1731.67321396509,1578.83901920665,1510.01197646147,1197.26120933368,1459.31750023239,1133.39061594723,1272.19689572635,1076.9016213448,2010.17829814238,1855.13507577117,1836.98531140927,1200.98243711652,1500.24530459025,707.606871251535,1451.3144516496,1126.6124464703,1319.10815104993,797.788216486924,2239.45433046074,2983.25369511289,2010.43405517444,3427.53084106575,3120.34273257447,2000.79638206949,1899.53085093408,934.864637310617,1392.9725932954,1779.61854878707,980.009788802219,675.831775510692,1339.839023369,1846.40855881109,1747.99767339582,1286.80071509436,1306.17454715201,1092.77263279758,3341.87381614811,2978.61666319373,1991.11082380832,3211.84671156603,3147.03262900966,2152.06339974324,2422.02561205471,2770.98352721005,1431.32133941128,1577.23544463169,1317.65734830633,2094.23881556212],[625.129661300631,743.106554528948,779.54111902092,649.765632456184,663.189842117596,652.770078324005,749.157558312212,711.819528201617,580.5697543088,867.22810142836,734.544534958247,835.991038867174,774.726011981323,742.595204559534,713.621891975524,690.112294848658,711.787044136911,682.450026778219,794.055460908199,590.069984761804,671.492998951384,708.522984582567,718.067817331355,601.097877323658,711.872436608216,743.519882145379,746.532380258947,601.433213504,616.701271521732,597.444357177091,689.593140135976,681.701172808115,675.522084394901,574.787134915661,788.577727659748,623.273963110634,624.169155091313,668.391084064825,614.892414133695,768.056341564449,680.11853829466,695.094714296857,635.83017511861,646.509579381887,589.735579102465,628.913875816757,636.242691150454,748.545493678447,858.480049174004,787.776090652837,777.643056692787,752.990004733191,735.408835469522,594.820805839291,713.467097423259,616.607158855486,810.129808295053,768.795345641974,739.147509047582,681.923444288397,581.186217848709,474.282928091548,661.5342317741,643.343111699505,669.970452889472,705.955070054498,773.239226275046,731.846429170848,834.892193248439,843.839842092656,804.191268242264,755.058137815178,826.652621788159,794.829196705347,758.38049196984,767.019871174939,780.138385816639,802.270284603215,786.660836357544,790.216970270541,811.349904597204,667.19154167388,681.51551890136,437.598878519005,802.286416649281,760.050066072583,772.318254037408,830.262559382107,730.069185586231,846.102117077989,727.131624326316,677.684627770662,690.475703531103,654.152602600168,690.452762485958,838.754741481926,574.112012423992,689.924286930373,878.821374583213,626.810357594868,699.066328208992,729.111290721754,695.643249717191,822.932045330447,661.801550296259,692.913851069146,783.717744925094,491.729556285426,658.785389557774,598.478286914968,757.379896912153,704.58383589472,599.29333430444,675.95808722913,641.145247498132,732.680629770539,718.510723640433,677.486836769817,659.546388549072,623.595852495387,657.294425659534,656.351655890786,660.440751021272,624.245704160916,864.653256881941,766.589659392133,815.237201691711,713.018511655973,716.233476820782,748.119566350756,689.072035724922,545.113641680206,764.275811928959,745.760157732154,761.087702306226,666.088623045248,561.196630582922,670.996174750954,685.888790328623,674.452497674102,731.120279923772,622.850721883856,743.659302244665,788.119504606129,762.167028307467,823.155434130141,781.441777399556,505.11888926999,786.68284082977,791.086704781453,746.954735374361,780.819692901579,770.368755342892,712.369742305719,736.930982636886,694.960016500862,693.3522173934,832.176139267248,807.604554625163,776.860193056355,829.579799620791,815.692605855446,816.40290926386,802.208051720103,843.066482399911,842.616626873804,767.229244046426,737.599417680775,620.714701276831,661.085210792865,699.471339292861,661.809416962639,708.446544203695,609.606014758966,597.316176676637,594.179046485752,760.223531042626,745.864020406192,689.18553483223,615.463126736443,693.707589389226,691.377524481366,820.175598969335,768.185309917571,687.457993591558,640.027686700653,695.569257098744,646.450924607392,738.206332272301,816.197433685445,847.873247372825,632.515148631595,627.16537376858,649.96564695094,683.413844474011,681.273245881397,795.179202796604,730.680249053295,725.7302903382,600.783825103434,676.438458436765,679.09808247291,749.555178398414,741.793948334941,740.479637683115,722.102488449111,707.486332242636,712.19839395282,658.650959898453,587.111564516735,726.617377629328,442.579995315402,746.966411973628,721.616280574107,592.765520511308,538.790239192774,855.344610235898,876.301721094257,891.886551335322,817.413051083022,691.063119843494,785.53741140691,749.770412137069,762.259965803776,737.968769482618,790.174665206386,815.55401370375,679.479146490785,872.200369350564,800.925340921603,928.506526616226,950.058127022166,1019.46532632344,931.204146222631,943.119577475772,1011.05786812264,842.338234839207,874.983929159209,856.049699605003,769.277965018864,764.535210135902,742.783931984979,911.556590572275,834.666190708534,794.86440782086,770.36712573185,687.068962801492,956.712542619098,952.341943320043,896.357755600527,851.77810880084,854.094659511188,883.000803345929,702.907691590266,870.012833374001,760.085419639252,864.625517147557,828.18422541675,839.984529471256,782.089429868302,836.240410366714,731.67947671059,806.934776489441,723.244956077849,945.862121952955,881.379854973289,939.859131561204,724.722337256435,858.540082057601,504.563107868658,810.87628043538,723.111584045452,754.158542138877,583.689689531539,931.127420928361,1002.49327012978,937.532372872571,1075.18860964245,1034.79951833298,974.205265615499,926.091300518035,674.32421000037,834.376432827235,891.922024621421,670.56463115758,518.383711350238,794.491133142002,906.929893903459,929.169871509148,783.162957908706,782.731668134183,709.272696861894,1064.81920407833,1020.76248683589,922.14846800512,1005.56275378689,1092.16841771729,870.058025506535,988.6216262509,1037.53876855756,836.322941305192,760.542048088587,780.081416085306,940.53174163782],[168.49187952209,192.035339626478,198.840333833177,175.932995683551,177.333557071275,174.726518301638,191.380016032853,187.898874739551,165.193922924129,212.077212277254,184.40096814843,205.902543624678,193.191839113181,189.890636827257,187.304994492763,183.763060641324,187.336331628141,183.479829427861,204.356027674642,167.877188490289,177.644818988227,186.005514382229,190.323915529598,168.838214968818,186.067161048741,194.760045158556,188.964491218082,167.811960805268,166.887800303096,166.259711524375,183.883230195207,182.989847712189,181.7333908468,165.491661696526,198.432559746901,170.949678355926,168.51257478356,180.27586340762,172.348727003133,196.313526244119,177.575976624429,184.608586399821,172.096669184262,176.959472662593,167.083907440442,169.860038532802,173.154106681994,192.962734770989,206.261208292142,197.502923207118,196.106866450558,189.303103520864,185.911779835478,164.610727344237,187.062050931722,169.447574545626,204.563081505397,193.19960222949,187.413751984268,181.677817915164,157.615149979492,144.185802165079,178.041365214977,177.728451826862,176.115725374881,187.41123801421,195.696123438083,188.923155891268,208.31384407287,210.893930965844,199.236639692641,196.324670217929,201.856927110418,202.491282780105,193.90432126914,187.907429839591,196.623418701888,197.9643318468,201.229723405965,196.611782475115,199.245200879356,177.882447312189,176.646393684157,130.555529592224,191.906243318279,194.900579164564,195.835336224571,206.343276614321,186.506090665654,206.435509024182,190.473640810853,180.871387023317,182.462316867934,178.593816425562,177.319537320407,204.511051540663,163.092500296922,185.207470462568,207.359647417562,168.302835921195,181.395205699135,187.234594301127,178.885021149127,201.648747003738,177.485825490247,181.668730939577,196.310607413309,144.150508152165,174.077841240735,166.12121726807,193.977461891144,184.681767695649,169.047891226008,180.747293927458,173.552122566597,192.544900060904,185.601244437674,181.91504842987,172.213110824706,171.486781438183,180.341444956328,172.395151284595,177.116288378619,170.559840221998,208.385135772858,192.416919760939,201.186416792983,180.670982183424,184.923708477102,187.335577897789,180.255020894577,156.235014263138,193.566715909959,191.488497890907,196.005367539254,175.982932113538,158.643546996218,181.886235481406,181.369845605884,175.808534507203,180.357799287098,169.825702191386,186.457357443599,198.770139624137,195.146603500366,206.611423012434,199.625094427098,147.688853170903,198.23799231298,190.169101628328,192.005261099244,199.400997556618,190.264951531749,182.491604927513,189.564953462475,193.64621273127,183.919061979975,215.0652750378,195.494618331057,197.926533108468,201.439538955764,204.517618846593,202.457758515918,199.995495171619,205.113452541605,206.39849362775,194.212453902149,192.686499230464,169.054538506617,181.94478864522,181.845826198531,177.586980846951,189.454629764946,169.249717125485,165.308997499061,167.634028058639,191.411165858456,192.820124054067,181.528737939925,170.938390070118,179.751093680121,181.989555378823,201.649911136045,194.308447847672,182.459885476109,174.531151235431,176.460266338097,175.71838837441,188.26841105757,203.096042300145,208.571210727642,168.097482687513,169.538434079699,175.576900963375,177.480046622135,182.491544894326,193.763725662215,185.932835998786,183.89029799005,165.075291026882,183.539507197741,180.280098871879,191.28901556403,186.828603711646,186.609928116792,189.014358454719,183.014146920052,190.637258777824,175.181846724577,163.555738098675,190.001660090666,135.544428529386,195.762460529294,191.305177562345,165.329397062766,148.78125050974,203.398781138895,211.269942438717,214.00112382905,206.741902233614,178.378743952097,202.979398082685,192.125209884134,191.571886468463,189.780277631151,194.60864495903,202.824227216948,175.847493561209,213.780702558322,197.863961641765,216.685369241487,221.729329414733,229.207810374818,212.347930255302,220.055128929948,231.308257735893,206.679963454529,204.378313621126,209.083517381335,194.558313200862,195.294695894245,191.979071926333,211.558129727977,206.042722835058,199.977532327516,191.208927532751,177.142605360371,222.186052416287,221.487940380273,215.939674563329,208.172750840507,206.528603125361,213.810249579102,185.912001699565,210.139173881199,194.077331333612,208.093478195852,200.096026971163,201.721876740791,196.836695953352,207.223628063147,184.84052090758,198.179887651507,188.723060936037,218.044444691179,217.987226477469,226.802661190379,186.594812953772,208.035143590162,152.33554774408,204.648579492113,185.098715080497,192.214796591663,161.417717112074,216.713431014059,234.542772523242,221.507875641669,240.197551660857,230.400466394691,227.096815994688,213.967734297228,178.021403018195,199.299703610699,217.553791840132,178.218355318234,151.237195422956,192.156925365156,218.820230001904,219.243772968501,198.868787169329,198.577227825377,180.848034088624,237.355728719875,230.710878440564,218.309305005333,225.930766665058,241.107486764345,207.492998509222,224.096657360559,234.107314135437,202.045374971851,198.626058609422,196.58929441639,218.043612783386],[529.791469606847,505.892362524488,626.608313610084,390.364761920601,377.310309319398,415.58909854553,513.785978374608,498.670370938152,374.528498249396,746.045098186272,472.791518018841,712.83546976533,635.14340236902,570.026838860544,633.061342471533,594.496111412552,472.643571941037,538.938579291133,635.36708221564,383.015986104019,530.813565048382,493.947935175438,457.504315974146,376.357360702741,470.012439405219,681.600898897315,565.66423184802,464.431824386314,414.511692401023,389.595850552119,569.922230906205,543.061671850369,622.403669979457,452.946892931266,680.565415891953,556.97612144928,389.795098484418,501.12229491147,415.37980994051,669.893381590065,396.484553770353,583.195766637891,425.128582739509,458.990511737737,411.967478498871,440.295067422404,417.080811331699,535.271596975516,795.82527555578,680.094874862043,559.938722846522,601.998611210134,547.472176803551,441.122942692842,521.512336203578,434.97890879516,586.692527474978,505.203406563314,529.156982610244,484.312894999744,399.701930613672,323.44449975112,539.07218474837,421.94041076254,525.184632557727,531.188058607812,528.540977424766,696.214549694298,759.871894211177,720.646757427827,624.337829354428,603.241889005236,707.27408871776,653.621181604565,681.954066878469,676.229451755208,710.869040838816,735.919907135506,675.882536414638,820.128310093386,825.758472437098,632.080505225032,598.311446801045,341.424830295156,735.848319457237,702.218278208955,785.329553814012,755.779607991847,670.50223013536,896.254763599364,682.436436246078,573.802147312127,631.098176718093,518.611077121236,638.708184001101,828.172121269856,431.606546050706,597.118390030313,953.583189777681,553.394798287716,581.832818289664,602.816961453398,611.368491186854,759.052383952416,589.487431628658,630.031353604244,783.343528373994,384.716186955374,603.189198400029,541.105330720897,671.395825235545,623.07617351306,493.207289506187,564.911969419862,568.830435922695,646.216890344269,702.94678452587,611.419738682223,577.925452185721,508.081842236253,588.585213305536,602.336851989768,622.66046215889,546.015589338904,854.212798210285,692.92607986024,675.608180114867,583.602624517311,626.24411401403,711.785664732593,640.261035330001,418.445841219245,721.414641975582,712.630717969622,647.727382136934,549.562918517956,466.612087584063,631.38083857664,649.000996926144,534.709848455881,630.66922163446,467.066194149042,618.021348383482,778.887588407935,750.064139714132,869.519497590185,758.543218433992,550.996718398913,746.955603222214,825.190397629709,687.681124886703,734.622746742937,625.702311692324,562.0378195214,623.8341529849,705.756993307019,700.009172936606,833.054582060076,732.056338787867,722.169803230055,886.616742357191,802.342384172807,795.646090617331,755.766282286824,808.866145563601,807.152451309604,699.077651945713,670.463233198165,547.486469263308,669.629307809749,567.960081927165,481.541252380662,586.164753497168,516.725482036343,474.283767916645,454.990344039656,734.227425956099,693.822004813896,592.494181504453,515.088951271276,672.93744673324,626.959907613196,761.884389288047,653.1618048558,579.058904570921,566.756909992913,517.653000949334,524.67431843183,680.666197046438,666.072416204874,811.058768692356,552.112517684872,459.052272767697,559.832821269989,715.099523626648,708.692674315975,730.437561784878,699.708311739708,754.451013984621,652.14910090724,708.152761462245,788.857617228248,679.229491312315,632.403839938593,601.497763397018,705.081448783621,600.049540008731,610.317610869008,567.476164731472,463.433720219914,559.877311200592,352.302041325406,765.759943510078,681.493056076871,525.780647546612,454.669773568961,878.566637003117,927.519673521482,988.89641065708,904.336431099983,587.163399421842,938.41157715083,740.460158795329,700.222392587463,593.612376738838,707.565524168731,736.336727620485,739.61627318816,1013.09187004263,827.490524745895,1151.51374200048,998.932486793581,1091.49128300292,986.002067556718,1049.32590523992,1076.3939567657,880.699019663614,843.582061911879,878.943684919941,753.844595553526,708.189967644863,712.4727194769,928.045705717612,895.369294605809,821.15352058484,751.152641034854,655.257677569834,1146.69009509717,1159.6441650548,894.498986065739,907.269958570798,902.273059030139,1005.38670639524,737.856205315427,934.733222992704,808.612490779444,892.4383503452,817.592310689206,962.132174655209,771.589193436282,944.161702877017,758.727138824107,839.135612680998,724.311152764761,1042.89905109449,959.868348763498,1022.97248586712,745.900563311291,886.930504049357,430.643507710519,865.353542046681,729.972307412018,823.276995251705,512.41751552795,1047.51201503823,1288.11452268952,1037.23881328701,1511.05836924269,1396.55384932391,1130.19213308359,980.560803757829,596.47619812338,792.554761532015,941.753159726746,628.508289547518,445.506345115963,766.817932638399,1052.46926084661,987.28427655126,780.259647762785,789.200050709939,670.726140031375,1424.27842196455,1269.51215874064,986.443864427654,1245.69752081483,1398.51674630034,997.19104425217,1161.64781907195,1237.43560318811,821.61112738166,818.753670031752,743.698998089047,1047.70671225763],[355.459704953939,384.727712684666,394.317285093654,251.836051428078,276.73665480427,277.91365567276,343.922696205515,313.315556564167,285.879337027607,522.874729596854,301.369721027677,398.740120368356,408.804453775212,351.023477989385,389.896797153025,403.965657478536,356.680560724476,354.319773257753,448.595342983008,285.243375207395,351.847566748722,375.301488750918,324.160970777613,315.932521450318,321.571574063596,416.21847518544,368.516730114206,343.434464875059,312.420805893515,302.455191823434,398.288108654819,375.092266666667,407.953249886895,342.123036649215,410.1488941248,378.706170821414,280.906389515626,346.593405901969,296.316535114349,411.995975696362,285.250443239957,380.080641741466,324.029059636895,283.567578319244,311.92509603073,324.110454418734,315.266921890785,355.998973832735,477.689365504915,395.76340002921,392.141311312024,391.059703599153,380.43069605413,318.224719101124,427.74842910137,269.502304147465,412.356590858909,384.729455529253,379.371197687406,354.447568436013,248.554884982069,266.283386740082,357.551386218446,302.866722242484,322.807643015263,397.117157134925,361.911459340943,394.016763181957,476.4375,461.427656850192,395.093994778068,389.729900762261,428.407805752465,410.819099206055,408.393701393701,400.786554115164,455.059453624512,479.515318679453,473.167100075497,492.269001346931,471.202274649873,400.001915268521,362.941279182565,248.500363049617,477.689184333453,408.635439581279,466.168783393186,505.337014606341,407.932696420933,540.149398849974,487.053658536585,379.709845984598,436.25251396648,383.474174544458,373.840092699884,527.179068842021,303.852610084298,432.569825436409,563.828660436137,399.59671641791,428.513632901752,422.598799249531,396.931562167907,454.098887938409,392.027826948949,409.849282116816,475.338714090287,312.440748898678,436.196368311104,369.890621584202,439.190591462923,438.620255158293,335.961570996979,402.853545950483,358.893664723592,436.159711327267,428.711634546752,422.893775070569,394.013738672903,389.980321765723,401.320850052014,389.70466245036,370.869799314733,375.684076433121,494.941615883625,388.016351249054,494.229951342584,424.885727122959,424.885727122959,461.319713993871,439.927469263141,307.431524547804,461.850008580745,449.584540658236,444.520214320507,407.510791366906,326.287954206073,399.950361868558,422.611637790127,364.283422459893,462.320988688731,334.052173913043,352.439469320066,496.403453379378,446.18480404768,516.588000389598,464.81983304284,328.418230563003,431.251308900524,482.327217686451,460.195245615493,438.613006056742,407.354763973357,387.040506329114,378.446301037596,438.596077069953,405.56707175478,533.586565752129,458.632028409571,475.135655522493,523.21633769787,509.727435744172,482.032520325203,464.521119461,495.906694284907,496.555197421434,436.362277580071,448.484412272765,386.527779774312,387.527393676657,338.945565006075,386.40701381509,398.248723766307,304.695431472081,277.92584829774,305.107456140351,400.574902652267,422.381303813038,424.216126098818,361.534649822151,460.309228824273,421.703308431163,502.989946993237,441.158784332846,420.89256263253,357.305487032469,325.804742539664,353.635355350393,464.1922853105,498.398560626765,505.269029246451,358.935368043088,301.968307412752,385.282748747316,408.164800267424,438.446366782007,487.281894055527,461.6,483.394247191011,337.972619409796,352.832030914556,369.465256262725,450.089100970407,453.898218629836,401.901313950238,422.109158186864,408.431633027523,434.577141966165,377.896012399605,332.277356951404,371.362499177036,272.473816971042,430.130194805195,445.211666084527,336.272526799387,330.104584701447,472.865682794695,539.34530095037,555.001737053523,484.406319451155,434.414626588162,453.264062353273,392.597724081874,485.205569275313,400.141262643879,461.40574536801,498.252659332667,431.837874659401,596.225091456854,555.399613339778,609.789631533847,642.604057518671,745.534131736527,616.070709235055,646.642564162663,686.207390737889,550.675697290813,529.071548240859,539.654081930525,474.443128374848,515.471227911192,480.540524584634,579.379200636309,540.57010947168,538.39034354689,529.422906693162,456.343958786123,687.000524934383,685.842039955329,591.107243063494,582.437667488477,558.785699351871,621.101608992727,504.788141239174,652.119039291127,514.853699085619,559.172571312557,526.923100090352,615.927208166889,550.415498999142,610.890799005298,518.447239954938,573.930481283422,508.649289099526,628.517311840163,572.183338527059,664.332274615197,481.068351977451,614.474845542807,313.688852687922,566.962502506517,515.077355189244,503.178750897344,376.507688083471,577.760393525865,678.344600696684,623.895705521472,767.6609365738,672.777834008097,675.052631578947,623.015657735142,463.113957385683,571.623169376831,580.159951894167,467.04012345679,351.78856840434,529.679238237491,635.110372340426,647.412772404149,532.115851272016,511.024886466848,492.152787579393,735.611474013064,663.668189316077,596.675864325444,662.516637033274,752.156112138893,541.719089280067,679.954608673663,709.063234191452,552.825237349064,473.86310688659,518.563503649635,642.785407725322],[14.1303817860707,14.5963353107222,14.7234135305285,14.2783013843674,14.2551252620454,14.3002340857847,14.4660170796319,14.2863481199655,14.5325484831324,14.7640137066175,14.0695613489066,14.5817771614694,14.3674911289178,14.4409605647964,14.3722066584548,14.172802218662,14.3652237287006,14.5430529348948,15.0168992881149,14.4790985718205,14.2027127759725,14.4561390844033,14.644608015442,14.3802280350973,14.2235978223218,14.8786365225761,13.9797940641365,14.6201345131012,13.961738561265,14.5069452564235,14.5260957322794,14.5816929540773,14.6039174217467,14.8576387735224,14.3678903382742,14.2913662658752,14.0149939653727,14.8981286464365,14.3344507381502,14.496113139323,13.6137814394123,14.4280763721753,14.0679897370407,14.4704655525897,14.2753239070824,14.1783438019256,14.5436358062933,14.1352542754228,14.0714954332591,14.4005863342863,14.4771423784952,14.1275661531977,13.8034450394843,14.2838999808874,14.5439825670586,14.2412507134219,14.6931293410637,14.2091149596643,14.2752550897116,14.5239139213922,13.4612888150652,14.1002611505841,14.3101793825875,14.685850787914,14.010572181717,14.5751181765008,14.2986388751012,14.4551602468376,14.594627251354,14.7993061929459,14.3485419503248,14.7025017074175,14.2987012670713,14.7677305114408,14.4795716684654,13.9240277596058,14.1446091439759,13.5708697776153,14.3357068767254,13.8040840236858,13.881419080092,14.1419419656994,13.6505518153573,12.9017769300623,13.3343933395969,13.9825218706052,14.0321262789891,14.2598377940472,13.7109376044527,13.8544504710261,14.1288633497424,14.1579479179887,13.793302546658,14.3836752486844,13.7099304019046,13.8560716021588,13.8970692411695,14.3996043169372,13.6156482196422,13.6559536060951,13.8347284143184,13.7924969924189,13.5798648659375,13.8223811226626,14.0013480907025,13.7533414116662,13.9099815645283,13.5110891511861,13.7168146632559,13.6812953263928,13.9175108863202,14.2958694227283,14.1761255078864,14.1135089268795,13.9969159633661,14.244684331027,13.8820488160011,13.8289451272384,13.8400991453328,13.9495244921795,14.2833360175205,13.6961427179942,13.8511022493503,13.7791880317634,14.0090164463485,13.9505034671745,13.8091644458907,13.6437651203502,13.9766024802829,13.4458810092169,14.2723342303104,13.6377483023947,14.2361933007002,14.1309597166418,14.4031724390592,13.674621937593,13.8398643312683,14.1991625392789,14.1041276650194,13.6139867993303,13.1863977822305,13.7872390457253,13.7967407908456,14.1042388196463,14.4454459750077,14.197494194347,14.2701761896041,13.6604570223735,14.1307628430046,13.4470124074545,13.6936771854514,14.1985220701843,13.6578836913033,13.9230745497973,14.2409753588194,15.3918494310283,14.2431861022815,15.3201474044855,13.728643958925,14.2948043335557,14.0460353504824,14.5555353534564,14.2480806533519,14.4304878537354,14.4887861222388,14.0462932098351,13.9577665125058,14.6528941804342,14.2462767241193,14.8632582855102,14.1184888969915,14.2124860473816,14.8027884105974,14.3084013241876,14.1075627225857,14.1817652777604,14.1382165416366,14.7676833253529,14.1642767458625,14.4332440553867,14.1056136544265,14.3660654503092,13.9483678300805,14.2642568748326,14.2411220271999,14.6824246584981,13.5704836315235,14.3213520402794,13.9297354963463,14.6349321948452,14.7548718717072,13.51535403303,14.2053311724437,14.1972090147497,13.9156609244317,14.7434577658552,14.0251974557959,13.9173781463569,13.9506220515635,13.534846616199,14.4737645950734,14.4057945155023,13.9874470492355,14.1499299284435,13.8954645219451,14.3803815747746,14.2523139393984,14.8322097347413,13.9106202242777,13.9085711058666,14.180690413254,13.9749893340221,14.8629209913499,14.3857939717054,13.8832139705468,13.1542911533279,14.0110666063289,14.30901933658,14.2106263712565,14.5804952406507,13.9573754319399,14.7201903334125,14.4086289314082,14.168283082323,14.2635730556407,13.8221566152691,14.3954720144529,13.6339820457707,14.3169502202647,13.8196187716689,14.0078007450069,14.094065115357,13.9531445089585,13.5911126581596,14.0059938726642,14.2254299411796,14.099925073994,13.668383647348,13.9967523889748,13.9919110940465,14.1335631714302,14.309111864338,13.8148147005516,14.2520334725646,13.8425380246463,13.7160570811847,13.7603895496096,14.197203632918,14.0273277679143,14.0879253442983,14.0896982053605,14.2412143495203,14.0578032001996,14.0964230779821,14.4907770509903,14.0052623508139,13.7557838714305,13.9123961843767,13.6975753015037,13.9305211421038,14.2859107304257,13.9626127280926,13.6796522160088,14.1798910374491,13.8713240589915,14.6305985835313,14.6090902213511,13.6447910363629,14.2214223330622,14.4477983005545,14.4570841202773,13.6849646819771,13.9142608238503,13.5296996293737,13.8763129804706,14.4155334204225,14.4319156440922,14.2850619124197,13.8845167868919,14.3736988330988,13.8175667271912,13.8963077580458,13.4112030779708,14.3927728258037,13.8283306317775,14.1526200347717,13.6895050654655,14.5557556556093,13.9244167675495,14.138188409526,14.0555448143559,13.2732912427731,14.0139787561142,13.9557237272943,14.1570915740038,13.9627076797392,13.8464682481459,13.8339475787753,13.7142781339151,14.097144972818,13.8586289315438,14.3459798275085,13.9310696428001,13.878398333294]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>sample_id<\/th>\n      <th>SITE<\/th>\n      <th>WEEK<\/th>\n      <th>REGION<\/th>\n      <th>SEASON<\/th>\n      <th>REP<\/th>\n      <th>Observed<\/th>\n      <th>Observed_p<\/th>\n      <th>Observed_pt<\/th>\n      <th>Shannon_exp<\/th>\n      <th>Shannon_exp_p<\/th>\n      <th>Shannon_exp_pt<\/th>\n      <th>InvSimpson<\/th>\n      <th>InvSimpson_p<\/th>\n      <th>InvSimpson_pt<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"dom":"Blfrtip","buttons":["copy","csv","excel"],"pageLength":5,"lengthMenu":[[5,-1],["5","All"]],"columnDefs":[{"targets":8,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\");\n  }"},{"targets":9,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\");\n  }"},{"targets":10,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\");\n  }"},{"targets":11,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\");\n  }"},{"targets":12,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\");\n  }"},{"targets":13,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\");\n  }"},{"targets":14,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\");\n  }"},{"className":"dt-right","targets":[6,7,8,9,10,11,12,13,14]}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true,"rowCallback":"function(row, data) {\nvar value=data[0]; $(this.api().cell(row, 0).node()).css({'font-size':'80%'});\nvar value=data[1]; $(this.api().cell(row, 1).node()).css({'font-size':'80%'});\nvar value=data[2]; $(this.api().cell(row, 2).node()).css({'font-size':'80%'});\nvar value=data[3]; $(this.api().cell(row, 3).node()).css({'font-size':'80%'});\nvar value=data[4]; $(this.api().cell(row, 4).node()).css({'font-size':'80%'});\nvar value=data[5]; $(this.api().cell(row, 5).node()).css({'font-size':'80%'});\nvar value=data[6]; $(this.api().cell(row, 6).node()).css({'font-size':'80%'});\nvar value=data[7]; $(this.api().cell(row, 7).node()).css({'font-size':'80%'});\nvar value=data[8]; $(this.api().cell(row, 8).node()).css({'font-size':'80%'});\nvar value=data[9]; $(this.api().cell(row, 9).node()).css({'font-size':'80%'});\nvar value=data[10]; $(this.api().cell(row, 10).node()).css({'font-size':'80%'});\nvar value=data[11]; $(this.api().cell(row, 11).node()).css({'font-size':'80%'});\nvar value=data[12]; $(this.api().cell(row, 12).node()).css({'font-size':'80%'});\nvar value=data[13]; $(this.api().cell(row, 13).node()).css({'font-size':'80%'});\nvar value=data[14]; $(this.api().cell(row, 14).node()).css({'font-size':'80%'});\n}"}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render","options.columnDefs.4.render","options.columnDefs.5.render","options.columnDefs.6.render","options.rowCallback"],"jsHooks":[]}</script>
</div>
<h3 id="normality-tests">Normality Tests</h3>
<p>Before running significance tests, we need to know if data is normally distributed, which will tell use whether to use a parametric or non-parametric test. To test if the data are normally distributed, we use the Shapiro-Wilk Normality test and the Bartlett Test of Homogeneity of Variances.</p>
<p>If the p-values are both <strong>not significant</strong> (p &gt; 0.05) from the tests, we accept the null hypothesis (that the results are normally distributed) and test for significance between samples using an ANOVA. If the p-values are both <strong>significant</strong> (p &lt; 0.05), we reject the null hypothesis (that the results are normally distributed) and test for significance between samples using Kruskal-Wallis (non-parametric equivalent of ANOVA).</p>
<p>The commands are as follows:</p>
<p><code>shapiro.test(x)</code>, where <code>x</code> is a numeric vector of alpha diversity values from the sample data table.</p>
<p><code>bartlett.test(Value ~ Group, data = df)</code> Where <code>Value</code> is the metric of interest, <code>Group</code> in the treatment to compare, and <code>df</code> is the data frame.</p>
<p>First the Shapiro-Wilk Normality test.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>ssu_div_tab <span class="ot">&lt;-</span> ssu_samp_data_tab</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>ssu_shap_tests <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">colnames</span>(ssu_div_tab[,<span class="dv">7</span><span class="sc">:</span><span class="dv">15</span>])) {</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>   tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">&quot;ssu_shap_&quot;</span>, .))</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>   ssu_shap_tests <span class="ot">&lt;-</span> <span class="fu">append</span>(ssu_shap_tests, tmp_name)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>   tmp_test <span class="ot">&lt;-</span> <span class="fu">eval</span>(<span class="fu">shapiro.test</span>(ssu_div_tab[[i]]))</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>   tmp_test<span class="sc">$</span>data.name <span class="ot">&lt;-</span> tmp_name</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">assign</span>(tmp_name, tmp_test)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<p>And then the Bartlett Test of Homogeneity of Variances.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>ssu_div_tab <span class="ot">&lt;-</span> ssu_samp_data_tab</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>ssu_bart_tests <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">colnames</span>(ssu_div_tab[,<span class="dv">7</span><span class="sc">:</span><span class="dv">15</span>])) {</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>   tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">&quot;ssu_bart_&quot;</span>, .))</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>   ssu_bart_tests <span class="ot">&lt;-</span> <span class="fu">append</span>(ssu_bart_tests, tmp_name)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>   tmp_test <span class="ot">&lt;-</span> <span class="fu">eval</span>(<span class="fu">bartlett.test</span>(ssu_div_tab[[i]] <span class="sc">~</span> SITE, <span class="at">data =</span> ssu_div_tab))</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>   tmp_test<span class="sc">$</span>data.name <span class="ot">&lt;-</span> tmp_name</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">assign</span>(tmp_name, tmp_test)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<p>Here we see which Shapiro-Wilk Normality <strong>and</strong> Bartlett tests were significant and which were not for the FULL data set analysis?</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">colnames</span>(ssu_div_tab[,<span class="dv">7</span><span class="sc">:</span><span class="dv">15</span>])) {</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  tmp_get_shap <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">&quot;ssu_shap_&quot;</span>, .)))</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  tmp_shap_p <span class="ot">&lt;-</span> <span class="fu">round</span>(tmp_get_shap[[<span class="dv">2</span>]], <span class="dv">4</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  tmp_get_bart <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">&quot;ssu_bart_&quot;</span>, .)))</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  tmp_bart_p <span class="ot">&lt;-</span> <span class="fu">round</span>(tmp_get_bart[[<span class="dv">3</span>]], <span class="dv">4</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  tmp_res <span class="ot">&lt;-</span> <span class="fu">eval</span>(<span class="fu">isTRUE</span>(tmp_get_shap[[<span class="dv">2</span>]] <span class="sc">&gt;</span> <span class="fl">0.05</span>) <span class="sc">&amp;</span> <span class="fu">isTRUE</span>(tmp_get_bart[[<span class="dv">3</span>]] <span class="sc">&gt;</span> <span class="fl">0.05</span>))</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  tmp_print <span class="ot">&lt;-</span> <span class="fu">c</span>(i, <span class="st">&quot;Shapiro p-value =&quot;</span>, tmp_shap_p, </span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;Bartlett p-value =&quot;</span>, tmp_bart_p, </span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;Are both p-values &gt; 0.05?&quot;</span>, tmp_res)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(tmp_print,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>Observed Shapiro p-value = 0 Bartlett p-value = 0.0025 Are both p-values &gt; 0.05? FALSE 
Observed_p Shapiro p-value = 0.0062 Bartlett p-value = 0.0099 Are both p-values &gt; 0.05? FALSE 
Observed_pt Shapiro p-value = 0.0026 Bartlett p-value = 0.0106 Are both p-values &gt; 0.05? FALSE 
Shannon_exp Shapiro p-value = 0 Bartlett p-value = 0.0017 Are both p-values &gt; 0.05? FALSE 
Shannon_exp_p Shapiro p-value = 0.008 Bartlett p-value = 0.0006 Are both p-values &gt; 0.05? FALSE 
Shannon_exp_pt Shapiro p-value = 0.1395 Bartlett p-value = 0.024 Are both p-values &gt; 0.05? FALSE 
InvSimpson Shapiro p-value = 0 Bartlett p-value = 0 Are both p-values &gt; 0.05? FALSE 
InvSimpson_p Shapiro p-value = 0 Bartlett p-value = 0.0002 Are both p-values &gt; 0.05? FALSE 
InvSimpson_pt Shapiro p-value = 0.5597 Bartlett p-value = 0.0068 Are both p-values &gt; 0.05? FALSE </code></pre>
</div>
<p>So wherever the value of both p-values in <code>&gt; 0.05</code> we can use an ANOVA, otherwise we use Kruskal-Wallis.</p>
<h3 id="significance-tests">Significance Tests</h3>
<p>To begin, we need to create a hierarchy variable; a two-column matrix specifying the relationship between samples (first column) and groups (second column).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>ssu_hill_hier <span class="ot">&lt;-</span> ssu_samp_data_tab</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>ssu_hill_hier <span class="ot">&lt;-</span> ssu_hill_hier <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="st">&quot;sample_id&quot;</span>, <span class="st">&quot;SITE&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">remove_rownames</span>()</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>ssu_hill_hier <span class="ot">&lt;-</span> ssu_hill_hier[<span class="fu">order</span>(ssu_hill_hier<span class="sc">$</span>SITE), ]</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co">#ssu_hill_hier$SITE = paste(ssu_hill_hier$SITE, &#39;C&#39;, sep=&#39;&#39;)</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co"># ADD NEXT LINE TO REORDER BY SITE</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co">#ssu_hill_hier &lt;- ssu_hill_hier[order(factor(ssu_hill_hier$SITE,levels=c(c(&quot;ALMR&quot;, &quot;PAST&quot;, &quot;CRIS&quot;, &quot;PUCL&quot;)))),]</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>ssu_hill_hier <span class="ot">&lt;-</span> ssu_hill_hier <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">remove_rownames</span>()</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(ssu_hill_hier, <span class="st">&quot;files/trepo/alpha/rdata/ssu_hill_hier.rds&quot;</span>)</span></code></pre></div>
</div>
<p>Again, we start by testing significance of ASV diversity for the full data set against each of the three metrics using the <code>div_test</code> function.</p>
<p>The command is as follows:</p>
<p><code>div_test(countable = x, qvalue = i, hierarchy = hier, tree = ultrametric_tree, posthoc = TRUE)</code>, where <code>x</code> is ASV by sample table, <code>i</code> is the q-value corresponding to the metric of interest, <code>hier</code> is the hierarchy matrix, <code>tree</code> is an ultrametric formatted phylogenetic tree (see below), and <code>posthoc</code> indicates whether to run post hoc pairwise analyses.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>ssu_alpha_ds_full <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;ssu_ps_work&quot;</span>, <span class="st">&quot;ssu_ps_pime&quot;</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>qvalue <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> ssu_alpha_ds_full) {</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>     <span class="cf">for</span> (j <span class="cf">in</span> qvalue) {</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>         tmp_get <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_tu&quot;</span>)))</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>         tmp_test <span class="ot">&lt;-</span> <span class="fu">div_test</span>(tmp_get, <span class="at">qvalue =</span> j,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">hierarchy =</span> ssu_hill_hier,</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">posthoc =</span> <span class="cn">TRUE</span>)</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>         tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_q&quot;</span>, j, <span class="st">&quot;_adt&quot;</span>))</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>         <span class="fu">print</span>(tmp_name)</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>         <span class="fu">assign</span>(tmp_name, tmp_test)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>         <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>(<span class="at">pattern =</span> <span class="st">&quot;_tu&quot;</span>)</span></code></pre></div>
</div>
<p>And then test significance of lineage diversity for the PIME filtered data set only.</p>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>ssu_alpha_ds_full_tree <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;ssu_ps_pime&quot;</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>qvalue <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> ssu_alpha_ds_full_tree) {</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>     <span class="cf">for</span> (j <span class="cf">in</span> qvalue) {</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>         tmp_get <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_tu&quot;</span>)))</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>         tmp_tree <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_tree_ult&quot;</span>)))</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>         tmp_test <span class="ot">&lt;-</span> <span class="fu">div_test</span>(tmp_get, <span class="at">qvalue =</span> j,</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">hierarchy =</span> ssu_hill_hier,</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">posthoc =</span> <span class="cn">TRUE</span>,</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">tree =</span> tmp_tree)</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>         tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_t_q&quot;</span>, j, <span class="st">&quot;_adt&quot;</span>))</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>         <span class="fu">print</span>(tmp_name)</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>         <span class="fu">assign</span>(tmp_name, tmp_test)</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>         <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(ssu_ps_pime_t_q0_adt, ssu_ps_pime_t_q1_adt, ssu_ps_pime_t_q2_adt, </span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>     <span class="at">file =</span> <span class="st">&quot;files/trepo/alpha/rdata/ssu_ps_pime_hill_lineage_test.rdata&quot;</span>)</span></code></pre></div>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<p><br/></p>
<div class="layout-chunk" data-layout="l-page">
<table>
<colgroup>
<col style="width: 13%" />
<col style="width: 5%" />
<col style="width: 12%" />
<col style="width: 13%" />
<col style="width: 13%" />
<col style="width: 30%" />
<col style="width: 10%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">metric</th>
<th style="text-align: left;">q-value</th>
<th style="text-align: right;">normality p-value</th>
<th style="text-align: right;">homogeneity p-value</th>
<th style="text-align: left;">method</th>
<th style="text-align: left;">posthoc method</th>
<th style="text-align: right;">posthoc p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Observed</td>
<td style="text-align: left;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.002473</td>
<td style="text-align: left;">Kruskal-Wallis Test</td>
<td style="text-align: left;">Dunn test with Benjamini-Hochberg correction</td>
<td style="text-align: right;">0.0009835</td>
</tr>
<tr class="even">
<td style="text-align: left;">Shannon exponential</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.001670</td>
<td style="text-align: left;">Kruskal-Wallis Test</td>
<td style="text-align: left;">Dunn test with Benjamini-Hochberg correction</td>
<td style="text-align: right;">0.0022118</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inverse Simpson</td>
<td style="text-align: left;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: left;">Kruskal-Wallis Test</td>
<td style="text-align: left;">Dunn test with Benjamini-Hochberg correction</td>
<td style="text-align: right;">0.0000000</td>
</tr>
</tbody>
</table>
</div>
<p><em>Summary of significant tests (<strong>ASV diversity</strong>).</em></p>
<p><br/></p>
<div class="layout-chunk" data-layout="l-page">
<table>
<colgroup>
<col style="width: 13%" />
<col style="width: 5%" />
<col style="width: 12%" />
<col style="width: 13%" />
<col style="width: 13%" />
<col style="width: 30%" />
<col style="width: 10%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">metric</th>
<th style="text-align: left;">q-value</th>
<th style="text-align: right;">normality p-value</th>
<th style="text-align: right;">homogeneity p-value</th>
<th style="text-align: left;">method</th>
<th style="text-align: left;">posthoc method</th>
<th style="text-align: right;">posthoc p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Observed</td>
<td style="text-align: left;">0</td>
<td style="text-align: right;">0.0062042</td>
<td style="text-align: right;">0.0099368</td>
<td style="text-align: left;">Kruskal-Wallis Test</td>
<td style="text-align: left;">Dunn test with Benjamini-Hochberg correction</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Shannon exponential</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">0.0079976</td>
<td style="text-align: right;">0.0005554</td>
<td style="text-align: left;">Kruskal-Wallis Test</td>
<td style="text-align: left;">Dunn test with Benjamini-Hochberg correction</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inverse Simpson</td>
<td style="text-align: left;">2</td>
<td style="text-align: right;">0.0000012</td>
<td style="text-align: right;">0.0001712</td>
<td style="text-align: left;">Kruskal-Wallis Test</td>
<td style="text-align: left;">Dunn test with Benjamini-Hochberg correction</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
<p><em>Summary of significant tests for PIME filtered data (<strong>ASV diversity</strong>).</em></p>
<p><br/></p>
<div class="layout-chunk" data-layout="l-page">
<table>
<colgroup>
<col style="width: 13%" />
<col style="width: 5%" />
<col style="width: 12%" />
<col style="width: 13%" />
<col style="width: 13%" />
<col style="width: 30%" />
<col style="width: 10%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">metric</th>
<th style="text-align: left;">q-value</th>
<th style="text-align: right;">normality p-value</th>
<th style="text-align: right;">homogeneity p-value</th>
<th style="text-align: left;">method</th>
<th style="text-align: left;">posthoc method</th>
<th style="text-align: right;">posthoc p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Observed</td>
<td style="text-align: left;">0</td>
<td style="text-align: right;">0.0025645</td>
<td style="text-align: right;">0.0106439</td>
<td style="text-align: left;">Kruskal-Wallis Test</td>
<td style="text-align: left;">Dunn test with Benjamini-Hochberg correction</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Shannon exponential</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">0.1395494</td>
<td style="text-align: right;">0.0240482</td>
<td style="text-align: left;">Kruskal-Wallis Test</td>
<td style="text-align: left;">Dunn test with Benjamini-Hochberg correction</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inverse Simpson</td>
<td style="text-align: left;">2</td>
<td style="text-align: right;">0.5596707</td>
<td style="text-align: right;">0.0067826</td>
<td style="text-align: left;">Kruskal-Wallis Test</td>
<td style="text-align: left;">Dunn test with Benjamini-Hochberg correction</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
<p><em>Summary of significant tests the PIME filtered data (<strong>ASV Lineage diversity</strong>).</em></p>
<p><br/></p>
<h3 id="posthoc-analyses">PostHoc Analyses</h3>
<p>First let’s check the results of each posthoc analysis.</p>
<details>
<summary>
Detailed results of PostHoc Analyses for each metric
</summary>
<h4 id="observed-q-value-0">Observed (q-value = 0)</h4>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;ASV diversity FULL data set (Observed)&quot;
[1] &quot;Dunn test with Benjamini-Hochberg correction&quot;
                   Z      P.unadj       P.adj
ALMR-CRIS  3.7269738 0.0001937926 0.001162755
ALMR-PAST  0.6975965 0.4854295800 0.485429580
CRIS-PAST -3.0293773 0.0024505840 0.007351752
ALMR-PUCL  2.1066307 0.0351496072 0.070299214
CRIS-PUCL -1.6203432 0.1051585825 0.157737874
PAST-PUCL  1.4090342 0.1588250641 0.190590077</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;ASV diversity PIME data set (Observed)&quot;
[1] &quot;Dunn test with Benjamini-Hochberg correction&quot;
                  Z           P.unadj            P.adj
ALMR-CRIS  2.395023 0.016619322370942 0.02492898355641
ALMR-PAST  1.050562 0.293459797296229 0.29345979729623
CRIS-PAST -1.344461 0.178799360063878 0.21455923207665
ALMR-PUCL -3.550780 0.000384091870839 0.00076818374168
CRIS-PUCL -5.945803 0.000000002751055 0.00000001650633
PAST-PUCL -4.601342 0.000004197782442 0.00001259334733</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;Lineage diversity PIME data set (Observed)&quot;
[1] &quot;Dunn test with Benjamini-Hochberg correction&quot;
                    Z           P.unadj            P.adj
ALMRC-CRISC  2.451736 0.014216899625714 0.02132534943857
ALMRC-PASTC  1.097145 0.272578073360994 0.27257807336099
CRISC-PASTC -1.354591 0.175547915069169 0.21065749808300
ALMRC-PUCLC -3.393859 0.000689150724264 0.00137830144853
CRISC-PUCLC -5.845595 0.000000005047602 0.00000003028561
PASTC-PUCLC -4.491004 0.000007088814413 0.00002126644324</code></pre>
</div>
<h4 id="shannon-exponential-q-value-1">Shannon exponential (q-value = 1)</h4>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;ASV diversity FULL data set(Shannon exponential)&quot;
[1] &quot;Dunn test with Benjamini-Hochberg correction&quot;
                   Z      P.unadj       P.adj
ALMR-CRIS  1.6184963 0.1055556870 0.158333531
ALMR-PAST -0.6809865 0.4958800556 0.495880056
CRIS-PAST -2.2994827 0.0214775419 0.064432626
ALMR-PUCL -2.1370795 0.0325915283 0.065183057
CRIS-PUCL -3.7555758 0.0001729434 0.001037661
PAST-PUCL -1.4560930 0.1453669102 0.174440292</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;ASV diversity PIME data set (Shannon exponential)&quot;
[1] &quot;Dunn test with Benjamini-Hochberg correction&quot;
                   Z                 P.unadj                 P.adj
ALMR-CRIS -0.6902139 0.490059669147922316590 0.5880716029775067133
ALMR-PAST -1.2410932 0.214571315164399700759 0.3218569727465995234
CRIS-PAST -0.5508793 0.581716422577364000723 0.5817164225773640007
ALMR-PUCL -7.8977820 0.000000000000002839101 0.0000000000000170346
CRIS-PUCL -7.2075681 0.000000000000569599495 0.0000000000017087985
PAST-PUCL -6.6566888 0.000000000028006526604 0.0000000000560130532</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;Lineage diversity PIME data set (Shannon exponential)&quot;
[1] &quot;Dunn test with Benjamini-Hochberg correction&quot;
                     Z                P.unadj                 P.adj
ALMRC-CRISC -0.2454504 0.80610770428757572148 0.8061077042875757215
ALMRC-PASTC -0.9882608 0.32302491678442862844 0.4845373751766429704
CRISC-PASTC -0.7428104 0.45759645497694334537 0.5491157459723320367
ALMRC-PUCLC -7.4696279 0.00000000000008042188 0.0000000000004825313
CRISC-PUCLC -7.2241775 0.00000000000050414359 0.0000000000015124308
PASTC-PUCLC -6.4813671 0.00000000009089521102 0.0000000001817904220</code></pre>
</div>
<h4 id="simpson-multiplicative-i.e.-inverse-simpson-q-value-2">Simpson multiplicative (i.e., Inverse Simpson) (q-value = 2)</h4>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;ASV diversity FULL data set (Inverse Simpson)&quot;
[1] &quot;Dunn test with Benjamini-Hochberg correction&quot;
                    Z                                  P.unadj
ALMR-CRIS  -4.4448669 0.00000879462849718933470551107678403469
ALMR-PAST  -5.0225059 0.00000051001641381274983960919609110585
CRIS-PAST  -0.5776389 0.56350792156263629362200617833877913654
ALMR-PUCL -11.7262547 0.00000000000000000000000000000009350517
CRIS-PUCL  -7.2813878 0.00000000000033040341947259097524294659
PAST-PUCL  -6.7037489 0.00000000002031392709066478291892885248
                                           P.adj
ALMR-CRIS 0.000010553554196627201985426471042562
ALMR-PAST 0.000000765024620719124759413794136659
CRIS-PAST 0.563507921562636293622006178338779137
ALMR-PUCL 0.000000000000000000000000000000561031
CRIS-PUCL 0.000000000000991210258417772925728840
PAST-PUCL 0.000000000040627854181329565837857705</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;ASV diversity PIME data set (Inverse Simpson)&quot;
[1] &quot;Dunn test with Benjamini-Hochberg correction&quot;
                    Z                                      P.unadj
ALMR-CRIS  -4.6155749 0.000003920085860223148198767766092753817020
ALMR-PAST  -4.4337940 0.000009258910705804900429720209753536863673
CRIS-PAST   0.1817809 0.855754643343926035825575127091724425554276
ALMR-PUCL -12.5244299 0.000000000000000000000000000000000005488429
CRIS-PUCL  -7.9088550 0.000000000000002597669818405954978492621859
PAST-PUCL  -8.0906359 0.000000000000000593540206641369710923507350
                                                P.adj
ALMR-CRIS 0.00000588012879033472229815164913913072553
ALMR-PAST 0.00001111069284696588085447743060596437203
CRIS-PAST 0.85575464334392603582557512709172442555428
ALMR-PUCL 0.00000000000000000000000000000000003293057
CRIS-PUCL 0.00000000000000519533963681190995698524372
PAST-PUCL 0.00000000000000178062061992410923137813520</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;Lineage diversity PIME data set (Inverse Simpson)&quot;
[1] &quot;Dunn test with Benjamini-Hochberg correction&quot;
                    Z                   P.unadj
ALMRC-CRISC  8.545550 0.00000000000000001279259
ALMRC-PASTC  3.057057 0.00223521677281054336264
CRISC-PASTC -5.488493 0.00000004053784114726088
ALMRC-PUCLC  6.641925 0.00000000003096127478469
CRISC-PUCLC -1.903625 0.05695907142577186221821
PASTC-PUCLC  3.584868 0.00033724903279147225169
                                P.adj
ALMRC-CRISC 0.00000000000000007675557
ALMRC-PASTC 0.00268226012737265203517
CRISC-PASTC 0.00000008107568229452176
ALMRC-PUCLC 0.00000000009288382435408
CRISC-PUCLC 0.05695907142577186221821
PASTC-PUCLC 0.00050587354918720840464</code></pre>
</div>
</details>
<h3 id="alpha-diversity-plots">Alpha Diversity Plots</h3>
<p>Now we can plot the results from the posthoc analyses for each metric and data set using the function <code>div_test_plot_jjs</code>. I modified the orihginal function (<code>div_test_plot</code>) to control a little of the formatting.</p>
<p>The command is as follows:</p>
<p><code>div_test_plot(divtest = x, chart = "type", colour = col.pal, posthoc = TRUE, threshold = value))</code>, where <code>x</code> is the results from the <code>div_test</code> function, <code>"type"</code> is chart type (box, jitter, or violin),<code>colour</code> is is a color palette, <code>posthoc</code> indicates whether to run posthoc pairwise analyses, and <code>value</code> is the maximum p-value to show in pairwise posthoc results. <strong>WARNING</strong> if none of the posthoc results are below the specified threshold, the function will throw an error. Therefore, until this is fixed, all posthoc values are shown.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;hack_code/div_test_plot_jjs.R&quot;</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>(<span class="at">pattern=</span><span class="st">&quot;_adt_plot&quot;</span>))</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">objects</span>(<span class="at">pattern=</span><span class="st">&quot;_adt&quot;</span>)) {</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>     tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_plot&quot;</span>))</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>     tmp_get <span class="ot">&lt;-</span> <span class="fu">get</span>(i)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>     tmp_get<span class="sc">$</span>data <span class="ot">&lt;-</span> tmp_get<span class="sc">$</span>data[<span class="fu">order</span>(<span class="fu">factor</span>(tmp_get<span class="sc">$</span>data<span class="sc">$</span>Group,</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>                                <span class="at">levels=</span><span class="fu">c</span>(<span class="fu">c</span>(<span class="st">&quot;ALMR&quot;</span>, <span class="st">&quot;PAST&quot;</span>, <span class="st">&quot;CRIS&quot;</span>, <span class="st">&quot;PUCL&quot;</span>)))),]</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>     tmp_get<span class="sc">$</span>data <span class="ot">&lt;-</span> tmp_get<span class="sc">$</span>data <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">remove_rownames</span>()</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>     tmp_df <span class="ot">&lt;-</span> <span class="fu">div_test_plot_jjs</span>(tmp_get, <span class="at">chart =</span> <span class="st">&quot;box&quot;</span>,</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">colour =</span> swel_col, <span class="at">posthoc =</span> <span class="cn">TRUE</span>)</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>     tmp_df <span class="ot">&lt;-</span> <span class="fu">ggpar</span>(tmp_df, <span class="at">legend =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>     <span class="fu">print</span>(tmp_name)</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>     <span class="fu">assign</span>(tmp_name, tmp_df)</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<p><br/></p>
<p>Posthoc adjusted p-values given for each pairwise comparison.</p>
<div class="layout-chunk" data-layout="l-page">
<div class="figure"><span id="fig:unnamed-chunk-45"></span>
<img src="include/trepo/alpha/ssu_alph_div_plots_asv.png" alt="**Top row** = Observed; **middle row** = Shannon exponential; **bottom row** = Inverse Simpson. **Left** = ASV diversity full data set; **middle** = ASV diversity PIME data set; **right** = Lineage diversity PIME data set." width="4724" />
<p class="caption">
Figure 1: <strong>Top row</strong> = Observed; <strong>middle row</strong> = Shannon exponential; <strong>bottom row</strong> = Inverse Simpson. <strong>Left</strong> = ASV diversity full data set; <strong>middle</strong> = ASV diversity PIME data set; <strong>right</strong> = Lineage diversity PIME data set.
</p>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<h2 id="alpha-diversity-by-site">Alpha Diversity by Site</h2>
<p>Next, we calculate alpha diversity for each site using <code>alpha_div()</code> function, which computes a single alpha diversity value for a <strong>group of samples</strong>. So we need to create/use data frames containing samples split by group. If a tree object is provided, the computed alpha diversity is based on lineage diversity. We will run the analysis on the FULL and PIME data sets, both with and without trees.</p>
<p>The command is as follows:</p>
<p><code>alpha_div(countable = x, qvalue = j, tree = ultrametric_tree)</code>, where <code>x</code> is a count table , <code>j</code> is the q-value corresponding to the metric of interest, and <code>tree</code> is an ultrametric formatted phylogenetic tree.</p>
<h3 id="full-data-set-split-by-site">Full data set split by site</h3>
<p>We will start by splitting the full data set by treatment then generating new trees and ASV tables for each split.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>site <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;ALMR&quot;</span>,<span class="st">&quot;PAST&quot;</span>,<span class="st">&quot;CRIS&quot;</span>, <span class="st">&quot;PUCL&quot;</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> site) {</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>     tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">&quot;ssu_ps_work_&quot;</span>, .))</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>     tmp_ps <span class="ot">&lt;-</span> <span class="fu">subset_samples</span>(ssu_ps_work, SITE <span class="sc">==</span> i)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>     tmp_ps <span class="ot">&lt;-</span>  <span class="fu">prune_taxa</span>(<span class="fu">taxa_sums</span>(tmp_ps) <span class="sc">&gt;</span> <span class="dv">0</span>, tmp_ps)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>     tmp_ps<span class="sc">@</span>phy_tree <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>     tmp_ps_tree <span class="ot">&lt;-</span> <span class="fu">rtree</span>(<span class="fu">ntaxa</span>(tmp_ps), <span class="at">rooted =</span> <span class="cn">TRUE</span>,</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>                            <span class="at">tip.label =</span> <span class="fu">taxa_names</span>(tmp_ps))</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>     tmp_ps <span class="ot">&lt;-</span> <span class="fu">merge_phyloseq</span>(tmp_ps, sample_data, tmp_ps_tree)</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>     <span class="fu">print</span>(tmp_name)</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>     <span class="fu">assign</span>(tmp_name, tmp_ps)</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>     tmp_asv <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(tmp_name, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_tu&quot;</span>))</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>     tmp_get <span class="ot">&lt;-</span> <span class="fu">get</span>(tmp_name)</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>     tmp_get_asv <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">otu_table</span>(tmp_get))</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>     <span class="fu">print</span>(tmp_asv)</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>     <span class="fu">assign</span>(tmp_asv, tmp_get_asv)</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 19954 taxa and 76 samples ]
sample_data() Sample Data:       [ 76 samples by 6 sample variables ]
tax_table()   Taxonomy Table:    [ 19954 taxa by 8 taxonomic ranks ]
phy_tree()    Phylogenetic Tree: [ 19954 tips and 19953 internal nodes ]
phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 23048 taxa and 76 samples ]
sample_data() Sample Data:       [ 76 samples by 6 sample variables ]
tax_table()   Taxonomy Table:    [ 23048 taxa by 8 taxonomic ranks ]
phy_tree()    Phylogenetic Tree: [ 23048 tips and 23047 internal nodes ]
phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 19062 taxa and 76 samples ]
sample_data() Sample Data:       [ 76 samples by 6 sample variables ]
tax_table()   Taxonomy Table:    [ 19062 taxa by 8 taxonomic ranks ]
phy_tree()    Phylogenetic Tree: [ 19062 tips and 19061 internal nodes ]
phyloseq-class experiment-level object
otu_table()   OTU Table:         [ 20042 taxa and 76 samples ]
sample_data() Sample Data:       [ 76 samples by 6 sample variables ]
tax_table()   Taxonomy Table:    [ 20042 taxa by 8 taxonomic ranks ]
phy_tree()    Phylogenetic Tree: [ 20042 tips and 20041 internal nodes ]</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<p>As mentioned above, any tree used in the <code>hilldv</code> package must be <strong>ultrametric</strong>. So we need to convert the trees in order to look at lineage diversity. We will also save copies of each tree since this process takes a while to run.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>site <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;ALMR&quot;</span>,<span class="st">&quot;PAST&quot;</span>,<span class="st">&quot;CRIS&quot;</span>, <span class="st">&quot;PUCL&quot;</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> site) {</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>     tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">&quot;ssu_ps_work_&quot;</span>, .))</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>     tmp_name_tr <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(tmp_name, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_tree_ult&quot;</span>))</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>     tmp_get_name <span class="ot">&lt;-</span> <span class="fu">get</span>(tmp_name)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>     tmp_ult_tree <span class="ot">&lt;-</span> <span class="fu">force.ultrametric</span>(tmp_get_name<span class="sc">@</span>phy_tree, <span class="at">method=</span><span class="fu">c</span>(<span class="st">&quot;extend&quot;</span>))</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>     <span class="fu">print</span>(tmp_name_tr)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>     <span class="fu">assign</span>(tmp_name_tr, tmp_ult_tree)</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>     save_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(tmp_name_tr, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">&quot;files/trepo/alpha/rdata/&quot;</span>, ., <span class="st">&quot;.rds&quot;</span>))</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>     tree <span class="ot">&lt;-</span> <span class="fu">get</span>(tmp_name_tr)</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>     <span class="fu">saveRDS</span>(tree, save_name)</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rm</span>(save_name)</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>qvalue <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> site) {</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> qvalue){</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>     tmp_asv_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">&quot;ssu_ps_work_&quot;</span>, ., <span class="st">&quot;_tu&quot;</span>))</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>     tmp_asv_name <span class="ot">&lt;-</span> <span class="fu">get</span>(tmp_asv_name)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>     tmp_div_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">&quot;ssu_ps_work_&quot;</span>, ., <span class="st">&quot;_aldiv_&quot;</span>, j))</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>     <span class="fu">print</span>(tmp_div_name)</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>     tmp_alpha_div <span class="ot">&lt;-</span> <span class="fu">alpha_div</span>(<span class="at">countable =</span> tmp_asv_name, <span class="at">qvalue =</span> j)</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>     <span class="fu">assign</span>(tmp_div_name, tmp_alpha_div)</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>qvalue <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> site) {</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> qvalue){</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>     tmp_asv_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">&quot;ssu_ps_work_&quot;</span>, ., <span class="st">&quot;_tu&quot;</span>))</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>     tmp_asv_name <span class="ot">&lt;-</span> <span class="fu">get</span>(tmp_asv_name)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>     tmp_tree_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">&quot;ssu_ps_work_&quot;</span>, ., <span class="st">&quot;_tree_ult&quot;</span>))</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>     tmp_tree_name <span class="ot">&lt;-</span> <span class="fu">get</span>(tmp_tree_name)</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>     tmp_div_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">&quot;ssu_ps_work_&quot;</span>, ., <span class="st">&quot;_aldiv_&quot;</span>, j, <span class="st">&quot;t&quot;</span>))</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>     <span class="fu">print</span>(tmp_div_name)</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>     tmp_alpha_div <span class="ot">&lt;-</span> <span class="fu">alpha_div</span>(<span class="at">countable =</span> tmp_asv_name, <span class="at">qvalue =</span> j, <span class="at">tree =</span> tmp_tree_name)</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>     <span class="fu">assign</span>(tmp_div_name, tmp_alpha_div)</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<h3 id="pime-filtered-data-set">PIME filtered data set</h3>
<p>For this step, we will use the PIME data set. We start by making new trees and ASV tables for each split.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> site) {</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>     tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">&quot;ssu_ps_pime_&quot;</span>, .))</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>     tmp_ps <span class="ot">&lt;-</span> <span class="fu">get</span>(tmp_name)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>     tmp_ps<span class="sc">@</span>phy_tree <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>     tmp_ps_tree <span class="ot">&lt;-</span> <span class="fu">rtree</span>(<span class="fu">ntaxa</span>(tmp_ps), <span class="at">rooted =</span> <span class="cn">TRUE</span>,</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>                            <span class="at">tip.label =</span> <span class="fu">taxa_names</span>(tmp_ps))</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>     tmp_ps <span class="ot">&lt;-</span> <span class="fu">merge_phyloseq</span>(tmp_ps, sample_data, tmp_ps_tree)</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>     <span class="fu">print</span>(tmp_name)</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>     <span class="fu">assign</span>(tmp_name, tmp_ps)</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>     tmp_asv_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(tmp_name, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_tu&quot;</span>))</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>     tmp_get <span class="ot">&lt;-</span> <span class="fu">get</span>(tmp_name)</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>     tmp_asv_tab <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">otu_table</span>(tmp_get))</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>     <span class="fu">print</span>(tmp_asv_name)</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>     <span class="fu">assign</span>(tmp_asv_name, tmp_asv_tab)</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> site) {</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>     tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">&quot;ssu_ps_pime_&quot;</span>, .))</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>     tmp_tr_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(tmp_name, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_tree_ult&quot;</span>))</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>     tmp_get_name <span class="ot">&lt;-</span> <span class="fu">get</span>(tmp_name)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>     ultra_tree <span class="ot">&lt;-</span> <span class="fu">force.ultrametric</span>(tmp_get_name<span class="sc">@</span>phy_tree, <span class="at">method=</span><span class="fu">c</span>(<span class="st">&quot;extend&quot;</span>))</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>     <span class="fu">print</span>(tmp_tr_name)</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>     <span class="fu">assign</span>(tmp_tr_name, ultra_tree)</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>     tmp_save_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(tmp_tr_name, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">&quot;files/trepo/alpha/rdata/&quot;</span>, ., <span class="st">&quot;.rds&quot;</span>))</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>     tmp_tree <span class="ot">&lt;-</span> <span class="fu">get</span>(tmp_tr_name)</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>     <span class="fu">saveRDS</span>(tmp_tree, tmp_save_name)</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rm</span>(ultra_tree)</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>qvalue <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> site) {</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> qvalue){</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>     tmp_asv_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">&quot;ssu_ps_pime_&quot;</span>, ., <span class="st">&quot;_tu&quot;</span>))</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>     tmp_asv_name <span class="ot">&lt;-</span> <span class="fu">get</span>(tmp_asv_name)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>     tmp_spl_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">&quot;ssu_ps_pime_&quot;</span>, ., <span class="st">&quot;_tree_ult&quot;</span>))</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>     tmp_spl_name <span class="ot">&lt;-</span> <span class="fu">get</span>(tmp_spl_name)</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>     tmp_div_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">&quot;ssu_ps_pime_&quot;</span>, ., <span class="st">&quot;_aldiv_&quot;</span>, j))</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>     <span class="fu">print</span>(tmp_div_name)</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>     tmp_alpha_div <span class="ot">&lt;-</span> <span class="fu">alpha_div</span>(<span class="at">countable =</span> tmp_asv_name, <span class="at">qvalue =</span> j)</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>     <span class="fu">assign</span>(tmp_div_name, tmp_alpha_div)</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>qvalue <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> site) {</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> qvalue){</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>     tmp_asv_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">&quot;ssu_ps_pime_&quot;</span>, ., <span class="st">&quot;_tu&quot;</span>))</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>     tmp_asv_name <span class="ot">&lt;-</span> <span class="fu">get</span>(tmp_asv_name)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>     tmp_spl_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">&quot;ssu_ps_pime_&quot;</span>, ., <span class="st">&quot;_tree_ult&quot;</span>))</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>     tmp_spl_name <span class="ot">&lt;-</span> <span class="fu">get</span>(tmp_spl_name)</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>     tmp_div_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">&quot;ssu_ps_pime_&quot;</span>, ., <span class="st">&quot;_aldiv_&quot;</span>, j, <span class="st">&quot;t&quot;</span>))</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>     <span class="fu">print</span>(tmp_div_name)</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>     tmp_alpha_div <span class="ot">&lt;-</span> <span class="fu">alpha_div</span>(<span class="at">countable =</span> tmp_asv_name, <span class="at">qvalue =</span> j, <span class="at">tree =</span> tmp_spl_name)</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>     <span class="fu">assign</span>(tmp_div_name, tmp_alpha_div)</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<p><br/></p>
<div class="layout-chunk" data-layout="l-page">
<table>
<colgroup>
<col style="width: 9%" />
<col style="width: 5%" />
<col style="width: 8%" />
<col style="width: 18%" />
<col style="width: 30%" />
<col style="width: 26%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">data set</th>
<th style="text-align: left;">site</th>
<th style="text-align: left;">type</th>
<th style="text-align: right;">Observed (q = 0)</th>
<th style="text-align: right;">Shannon exponential (q = 1)</th>
<th style="text-align: right;">Inverse Simpson (q = 2)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">full</td>
<td style="text-align: left;">ALMR</td>
<td style="text-align: left;">asv</td>
<td style="text-align: right;">3271.5263</td>
<td style="text-align: right;">1445.8889</td>
<td style="text-align: right;">512.37855</td>
</tr>
<tr class="even">
<td style="text-align: left;">full</td>
<td style="text-align: left;">CRIS</td>
<td style="text-align: left;">asv</td>
<td style="text-align: right;">2537.6184</td>
<td style="text-align: right;">1347.6545</td>
<td style="text-align: right;">625.02252</td>
</tr>
<tr class="odd">
<td style="text-align: left;">full</td>
<td style="text-align: left;">PAST</td>
<td style="text-align: left;">asv</td>
<td style="text-align: right;">3211.1184</td>
<td style="text-align: right;">1513.6198</td>
<td style="text-align: right;">640.85116</td>
</tr>
<tr class="even">
<td style="text-align: left;">full</td>
<td style="text-align: left;">PUCL</td>
<td style="text-align: left;">asv</td>
<td style="text-align: right;">2902.5526</td>
<td style="text-align: right;">1629.9940</td>
<td style="text-align: right;">872.49427</td>
</tr>
<tr class="odd">
<td style="text-align: left;">full</td>
<td style="text-align: left;">ALMR</td>
<td style="text-align: left;">lineage</td>
<td style="text-align: right;">1873.7057</td>
<td style="text-align: right;">255.9520</td>
<td style="text-align: right;">12.04205</td>
</tr>
<tr class="even">
<td style="text-align: left;">full</td>
<td style="text-align: left;">CRIS</td>
<td style="text-align: left;">lineage</td>
<td style="text-align: right;">1576.5119</td>
<td style="text-align: right;">349.7861</td>
<td style="text-align: right;">26.64806</td>
</tr>
<tr class="odd">
<td style="text-align: left;">full</td>
<td style="text-align: left;">PAST</td>
<td style="text-align: left;">lineage</td>
<td style="text-align: right;">2011.0123</td>
<td style="text-align: right;">385.1964</td>
<td style="text-align: right;">25.15195</td>
</tr>
<tr class="even">
<td style="text-align: left;">full</td>
<td style="text-align: left;">PUCL</td>
<td style="text-align: left;">lineage</td>
<td style="text-align: right;">1751.5174</td>
<td style="text-align: right;">321.8964</td>
<td style="text-align: right;">13.04036</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pime</td>
<td style="text-align: left;">ALMR</td>
<td style="text-align: left;">asv</td>
<td style="text-align: right;">1062.9868</td>
<td style="text-align: right;">698.6075</td>
<td style="text-align: right;">351.26526</td>
</tr>
<tr class="even">
<td style="text-align: left;">pime</td>
<td style="text-align: left;">CRIS</td>
<td style="text-align: left;">asv</td>
<td style="text-align: right;">1015.8158</td>
<td style="text-align: right;">705.1187</td>
<td style="text-align: right;">413.32458</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pime</td>
<td style="text-align: left;">PAST</td>
<td style="text-align: left;">asv</td>
<td style="text-align: right;">1043.8684</td>
<td style="text-align: right;">716.1092</td>
<td style="text-align: right;">409.95653</td>
</tr>
<tr class="even">
<td style="text-align: left;">pime</td>
<td style="text-align: left;">PUCL</td>
<td style="text-align: left;">asv</td>
<td style="text-align: right;">1136.9079</td>
<td style="text-align: right;">844.4067</td>
<td style="text-align: right;">562.14996</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pime</td>
<td style="text-align: left;">ALMR</td>
<td style="text-align: left;">lineage</td>
<td style="text-align: right;">579.7505</td>
<td style="text-align: right;">131.1795</td>
<td style="text-align: right;">14.48609</td>
</tr>
<tr class="even">
<td style="text-align: left;">pime</td>
<td style="text-align: left;">CRIS</td>
<td style="text-align: left;">lineage</td>
<td style="text-align: right;">610.4956</td>
<td style="text-align: right;">176.7367</td>
<td style="text-align: right;">19.43099</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pime</td>
<td style="text-align: left;">PAST</td>
<td style="text-align: left;">lineage</td>
<td style="text-align: right;">587.4818</td>
<td style="text-align: right;">130.8675</td>
<td style="text-align: right;">10.21248</td>
</tr>
<tr class="even">
<td style="text-align: left;">pime</td>
<td style="text-align: left;">PUCL</td>
<td style="text-align: left;">lineage</td>
<td style="text-align: right;">655.1196</td>
<td style="text-align: right;">184.8650</td>
<td style="text-align: right;">20.12690</td>
</tr>
</tbody>
</table>
</div>
<p><em>Alpha diversity for sample groups from the full and PIME filtered data.</em> <br/></p>
<div class="layout-chunk" data-layout="l-page">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<h1 id="merged-data-set-asv">Merged Data Set (ASV)</h1>
<div class="layout-chunk" data-layout="l-body">

</div>
<h2 id="read-distribution-1">Read Distribution</h2>
<h3 id="histogram-of-read-counts-1">Histogram of Read Counts</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>ssu_max <span class="ot">&lt;-</span> <span class="fu">max</span>(ssu_ps_samp_data<span class="sc">$</span>total_reads) <span class="sc">+</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  (<span class="fl">0.2</span> <span class="sc">*</span> <span class="fu">max</span>(ssu_ps_samp_data<span class="sc">$</span>total_reads))</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>ssu_p_hist <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(ssu_ps_samp_data,</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(ssu_ps_samp_data<span class="sc">$</span>total_reads)) <span class="sc">+</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>         <span class="fu">geom_histogram</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, ssu_max, <span class="at">by =</span> <span class="dv">5000</span>),</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;grey&quot;</span>) <span class="sc">+</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>         <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Distribution of total reads (MERGED)&quot;</span>,</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">caption =</span> <span class="st">&quot;Bin width equals 5000 reads&quot;</span>) <span class="sc">+</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;No. of reads&quot;</span>, <span class="at">y =</span> <span class="st">&quot;No. of samples&quot;</span>) <span class="sc">+</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
</div>
<div class="layout-chunk" data-layout="l-body">
<p><img src="trepo-alpha_files/figure-html5/unnamed-chunk-68-1.png" width="624" /></p>
</div>
<h3 id="rarefaction-curves-1">Rarefaction Curves</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>tmp_select <span class="ot">&lt;-</span> ssu_amp_data</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>tmp_select<span class="sc">$</span>metadata<span class="sc">$</span>SITE <span class="ot">&lt;-</span> <span class="fu">factor</span>(tmp_select<span class="sc">$</span>metadata<span class="sc">$</span>SITE, </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;ALMR&quot;</span>, <span class="st">&quot;PAST&quot;</span>, <span class="st">&quot;CRIS&quot;</span>, <span class="st">&quot;PUCL&quot;</span>))</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>ssu_rare_curve1 <span class="ot">&lt;-</span> <span class="fu">amp_rarecurve</span>(</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  tmp_select,</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">stepsize =</span> <span class="dv">1000</span>,</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">color_by =</span> <span class="st">&quot;SITE&quot;</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> swel_col) </span></code></pre></div>
</div>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>ssu_rare_curve1  </span></code></pre></div>
<p><img src="trepo-alpha_files/figure-html5/unnamed-chunk-70-1.png" width="624" /></p>
</div>
<p>For a quick comparison, we can facet the above data by Site.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>ssu_rare_curve2 <span class="ot">&lt;-</span> <span class="fu">amp_rarecurve</span>(</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  tmp_select,</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">stepsize =</span> <span class="dv">1000</span>,</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">color_by =</span> <span class="st">&quot;SITE&quot;</span>,</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">facet_by =</span> <span class="st">&quot;SITE&quot;</span>,</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">facet_scales =</span> <span class="st">&quot;free&quot;</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>)  <span class="sc">+</span> <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> swel_col)</span></code></pre></div>
</div>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>ssu_rare_curve2</span></code></pre></div>
<p><img src="trepo-alpha_files/figure-html5/unnamed-chunk-72-1.png" width="624" /></p>
</div>
<p>In the <strong>full</strong> data set, there was a minimum read count of 12882, a median of 44092 reads, and a maximum of 399900 reads. After PIME filtering, there was a minimum read count of 10654, a median of 11922 reads, and a maximum of 12171 reads.</p>
<h2 id="alpha-diversity-1">Alpha Diversity</h2>
<p>To account for presence of rare sequence variants caused by sequencing errors or other technical artifacts, we use Hill numbers <span class="citation" data-cites="alberdi2019guide">(<a href="#ref-alberdi2019guide" role="doc-biblioref">Alberdi and Gilbert 2019a</a>)</span>. Hill numbers allow the weight put on rare versus abundant sequence variants to be scaled while providing intuitive comparisons of diversity levels using “effective number of ASVs” as a measuring unit. This approach allows for balancing the over representation of rare ASVs that might be inflated due to sequencing errors.</p>
<p>We will then use Shapiro-Wilk tests to test for normalcy and then, depending on the results, either use parametric ANOVA or non-parametric Kruskal-Wallis to compare alpha diversity among treatments.</p>
<h3 id="calculate-hill-numbers-1">Calculate Hill Numbers</h3>
<p>To calculate Hill numbers, we use the R package <code>hilldiv</code> <span class="citation" data-cites="alberdi2019hilldiv">(<a href="#ref-alberdi2019hilldiv" role="doc-biblioref">Alberdi and Gilbert 2019b</a>)</span>. We calculate three metrics that put more or less weight on common species:</p>
<ol type="1">
<li>Observed richness, where <code>q-value = 0</code>.</li>
<li>Shannon exponential, which weighs ASVs by their frequency, where <code>q-value = 1</code>.</li>
<li>Simpson multiplicative inverse, which over weighs abundant ASVs, where <code>q-value = 2</code>.</li>
</ol>
<p>We perform each analysis against the full data set and the PIME filtered data set using the function <code>hill_div</code>.</p>
<p>The command is as follows:</p>
<p><code>hill_div(count = x, qvalue = i, tree = ultrametric_tree)</code>, where <code>x</code> is the sample by ASV table, <code>i</code> is the q-value corresponding to the metric of interest and <code>tree</code> is an ultrametric formatted phylogenetic tree (see below).</p>
<p>We first transform all the data to relative abundance values, and compute new trees.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>ssu_alpha_ds <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;ssu_ps_work_merge&quot;</span>, <span class="st">&quot;ssu_ps_pime_merge&quot;</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>()</span></code></pre></div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> ssu_alpha_ds) {</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  tmp_ps <span class="ot">&lt;-</span> <span class="fu">transform_sample_counts</span>(<span class="fu">get</span>(i), <span class="cf">function</span>(otu) otu<span class="sc">/</span><span class="fu">sum</span>(otu))</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  tmp_ps<span class="sc">@</span>phy_tree <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  tmp_tree <span class="ot">&lt;-</span> <span class="fu">rtree</span>(<span class="fu">ntaxa</span>(tmp_ps), <span class="at">rooted =</span> <span class="cn">TRUE</span>,</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">tip.label =</span> <span class="fu">taxa_names</span>(tmp_ps))</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  tmp_ps_norm <span class="ot">&lt;-</span> <span class="fu">merge_phyloseq</span>(tmp_ps, sample_data, tmp_tree)</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>  tmp_asv <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">t</span>(<span class="fu">otu_table</span>(tmp_ps_norm)))</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  tmp_ps_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_norm&quot;</span>))</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(tmp_ps_name, tmp_ps_norm)</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>  tmp_asv_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_tu&quot;</span>))</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(tmp_asv_name, tmp_asv)</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<h4 id="no-phylogenetic-tree-1">No phylogenetic tree</h4>
<p>Next, we run the analysis for all three metrics on the data sets without a tree.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>qvalue <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> qvalue) {</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> ssu_alpha_ds) {</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>     tmp_asv <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(j, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_tu&quot;</span>)))</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>     tmp_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">hill_div</span>(tmp_asv, <span class="at">qvalue =</span> i))</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>     tmp_df <span class="ot">&lt;-</span> tmp_df <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;tmp_name&quot;</span> <span class="ot">=</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>                              tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">&quot;SamName&quot;</span>)</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>     tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(j, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_h&quot;</span>, i))</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>     <span class="fu">print</span>(tmp_name)</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>     <span class="fu">assign</span>(tmp_name, tmp_df)</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>(<span class="at">pattern =</span> <span class="st">&quot;_h&quot;</span>)</span></code></pre></div>
</div>
<p>And make summary tables to add back into each <code>ps</code> object.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> ssu_alpha_ds) {</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>     tmp_obs <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_h0&quot;</span>)))</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>     tmp_sha <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_h1&quot;</span>)))</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>     tmp_sim <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_h2&quot;</span>)))</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>     tmp_hill <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(tmp_obs, tmp_sha, <span class="at">by =</span> <span class="st">&quot;SamName&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>       dplyr<span class="sc">::</span><span class="fu">left_join</span>(., tmp_sim, <span class="at">by =</span> <span class="st">&quot;SamName&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>       dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;Observed&quot;</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">&quot;Shannon_exp&quot;</span> <span class="ot">=</span> <span class="dv">3</span>, <span class="st">&quot;InvSimpson&quot;</span> <span class="ot">=</span> <span class="dv">4</span>)</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>     tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_hill&quot;</span>))</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>     <span class="fu">assign</span>(tmp_name, tmp_hill)</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>(<span class="at">pattern =</span> <span class="st">&quot;_hill&quot;</span>)</span></code></pre></div>
</div>
<p>And then create the new objects with the diversity data.</p>
<div class="layout-chunk" data-layout="l-body">

</div>
<h4 id="with-a-phylogenetic-tree-1">With a phylogenetic tree</h4>
<p>We can also run the tests using the phylogenetic tree to assess <strong>lineage</strong> diversity rather that ASV diversity for the PIME data set. For this part we will only use PIME filtered data sets. We do a quick check to ensure the ASV names in the ASV table and the tip names in the new phylogenetic tree are identical.</p>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>ssu_alpha_ds_tree <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;ssu_ps_pime_merge&quot;</span>)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>qvalue <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> qvalue) {</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> ssu_alpha_ds_tree) {</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>     tmp_asv <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(j, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_tu&quot;</span>)))</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>     tmp_tree <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(j, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_tree_ult&quot;</span>)))</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>     tmp_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">hill_div</span>(tmp_asv, <span class="at">qvalue =</span> i, <span class="at">tree =</span> tmp_tree))</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>     tmp_df <span class="ot">&lt;-</span> tmp_df <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;tmp_name&quot;</span> <span class="ot">=</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>                              tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">&quot;SamName&quot;</span>)</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>     tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(j, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_ht&quot;</span>, i))</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>     <span class="fu">print</span>(tmp_name)</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>     <span class="fu">assign</span>(tmp_name, tmp_df)</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>(<span class="at">pattern=</span><span class="st">&quot;_ht&quot;</span>)</span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(ssu_ps_pime_ht0, ssu_ps_pime_ht1, ssu_ps_pime_ht2, ssu_ps_pime_merge_ht0, </span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>     ssu_ps_pime_merge_ht1, ssu_ps_pime_merge_ht2, </span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>     <span class="at">file =</span> <span class="st">&quot;files/trepo/alpha/rdata/ssu_ps_pime_hill_tree_tests.rdata&quot;</span>)</span></code></pre></div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> ssu_alpha_ds_tree) {</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>     tmp_obs <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_ht0&quot;</span>)))</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>     tmp_sha <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_ht1&quot;</span>)))</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>     tmp_sim <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_ht2&quot;</span>)))</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>     tmp_hill <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(tmp_obs, tmp_sha, <span class="at">by =</span> <span class="st">&quot;SamName&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>       dplyr<span class="sc">::</span><span class="fu">left_join</span>(., tmp_sim, <span class="at">by =</span> <span class="st">&quot;SamName&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>       dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;Observed_pt&quot;</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">&quot;Shannon_exp_pt&quot;</span> <span class="ot">=</span> <span class="dv">3</span>, <span class="st">&quot;InvSimpson_pt&quot;</span> <span class="ot">=</span> <span class="dv">4</span>)</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>     tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_hill_t&quot;</span>))</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>     <span class="fu">assign</span>(tmp_name, tmp_hill)</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>()</span></code></pre></div>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<h3 id="sample-summary-1">Sample Summary</h3>
<p>Now we summarize the data for each sample against all three metrics. The table contains the results of ASV diversity estimates from the full data set and the PIME filtered data set, as well as the lineage diversity from the PIME data set.</p>
<p>The suffix <code>_p</code> indicates metrics for the PIME data set and the suffix <code>_pt</code> indicates the lineage diversity for the PIME data set.</p>
<div class="layout-chunk" data-layout="l-body">

</div>
<p><br/></p>
<div class="layout-chunk" data-layout="l-page">
<div id="k3dzw6vcxxkzoyofwxo8" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="k3dzw6vcxxkzoyofwxo8">{"x":{"filter":"top","filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"disabled\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"2665\" data-max=\"11088\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"2132\" data-max=\"3588\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"1299.32588813316\" data-max=\"2108.83202934989\" data-scale=\"12\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"1375.19369013996\" data-max=\"3626.3171684408\" data-scale=\"12\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"1110.60710321743\" data-max=\"2162.87556588727\" data-scale=\"12\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"265.130494002995\" data-max=\"394.043388361464\" data-scale=\"13\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"404.377389790711\" data-max=\"1472.85609671704\" data-scale=\"13\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"350.664444068854\" data-max=\"1119.22636426693\" data-scale=\"13\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"20.1511951854713\" data-max=\"21.9048975835004\" data-scale=\"14\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","extensions":["Buttons"],"caption":"<caption style=\"caption-side: bottom; text-align: left;\">\n  Table: \n  <em>Sample summary table including\n            ASV diversity indices for FULL and PIME filtered data.\n            Use the buttons to navigate through the table or\n            download a copy.<\/em>\n<\/caption>","data":[["ALMR_W01_IB_HS","ALMR_W03_IB_HS","ALMR_W05_IB_HS","ALMR_W07_IB_HS","ALMR_W09_IB_HS","ALMR_W11_IB_HS","ALMR_W13_IB_NS","ALMR_W15_IB_NS","ALMR_W17_IB_NS","ALMR_W19_IB_NS","ALMR_W21_IB_NS","ALMR_W23_IB_NS","ALMR_W25_IB_NS","ALMR_W27_IB_NS","ALMR_W29_IB_NS","ALMR_W31_IB_NS","ALMR_W33_IB_NS","ALMR_W35_IB_NS","ALMR_W37_IB_NS","ALMR_W39_IB_NS","ALMR_W41_IB_HS","ALMR_W43_IB_HS","ALMR_W45_IB_HS","ALMR_W47_IB_HS","ALMR_W49_IB_HS","ALMR_W51_IB_HS","CRIS_W01_OB_HS","CRIS_W03_OB_HS","CRIS_W05_OB_HS","CRIS_W07_OB_HS","CRIS_W09_OB_HS","CRIS_W11_OB_HS","CRIS_W13_OB_NS","CRIS_W15_OB_NS","CRIS_W17_OB_NS","CRIS_W19_OB_NS","CRIS_W21_OB_NS","CRIS_W23_OB_NS","CRIS_W25_OB_NS","CRIS_W27_OB_NS","CRIS_W29_OB_NS","CRIS_W31_OB_NS","CRIS_W33_OB_NS","CRIS_W35_OB_NS","CRIS_W37_OB_NS","CRIS_W39_OB_NS","CRIS_W41_OB_HS","CRIS_W43_OB_HS","CRIS_W45_OB_HS","CRIS_W47_OB_HS","CRIS_W49_OB_HS","CRIS_W51_OB_HS","PAST_W01_IB_HS","PAST_W03_IB_HS","PAST_W05_IB_HS","PAST_W07_IB_HS","PAST_W09_IB_HS","PAST_W11_IB_HS","PAST_W13_IB_NS","PAST_W15_IB_NS","PAST_W17_IB_NS","PAST_W19_IB_NS","PAST_W21_IB_NS","PAST_W23_IB_NS","PAST_W25_IB_NS","PAST_W27_IB_NS","PAST_W29_IB_NS","PAST_W31_IB_NS","PAST_W33_IB_NS","PAST_W35_IB_NS","PAST_W37_IB_NS","PAST_W39_IB_NS","PAST_W41_IB_HS","PAST_W43_IB_HS","PAST_W45_IB_HS","PAST_W47_IB_HS","PAST_W49_IB_HS","PAST_W51_IB_HS","PUCL_W01_OB_HS","PUCL_W03_OB_HS","PUCL_W05_OB_HS","PUCL_W07_OB_HS","PUCL_W09_OB_HS","PUCL_W11_OB_HS","PUCL_W13_OB_NS","PUCL_W15_OB_NS","PUCL_W17_OB_NS","PUCL_W19_OB_NS","PUCL_W21_OB_NS","PUCL_W23_OB_NS","PUCL_W25_OB_NS","PUCL_W27_OB_NS","PUCL_W29_OB_NS","PUCL_W31_OB_NS","PUCL_W33_OB_NS","PUCL_W35_OB_NS","PUCL_W37_OB_NS","PUCL_W39_OB_NS","PUCL_W41_OB_HS","PUCL_W43_OB_HS","PUCL_W45_OB_HS","PUCL_W47_OB_HS","PUCL_W49_OB_HS","PUCL_W51_OB_HS"],["ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","ALMR","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","CRIS","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PAST","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL","PUCL"],["W01","W03","W05","W07","W09","W11","W13","W15","W17","W19","W21","W23","W25","W27","W29","W31","W33","W35","W37","W39","W41","W43","W45","W47","W49","W51","W01","W03","W05","W07","W09","W11","W13","W15","W17","W19","W21","W23","W25","W27","W29","W31","W33","W35","W37","W39","W41","W43","W45","W47","W49","W51","W01","W03","W05","W07","W09","W11","W13","W15","W17","W19","W21","W23","W25","W27","W29","W31","W33","W35","W37","W39","W41","W43","W45","W47","W49","W51","W01","W03","W05","W07","W09","W11","W13","W15","W17","W19","W21","W23","W25","W27","W29","W31","W33","W35","W37","W39","W41","W43","W45","W47","W49","W51"],["IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","IB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB","OB"],["HS","HS","HS","HS","HS","HS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","HS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","NS","HS","HS","HS","HS","HS","HS"],["R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R"],[5779,5739,5593,7462,6120,4714,5298,4740,6578,3751,4151,6095,4258,6231,3610,3601,7743,7501,2935,6244,4984,4229,7157,9968,8402,7756,5600,5836,4627,5760,5475,3926,5146,6302,4255,5364,3973,4165,3635,4286,3608,3950,8415,4596,4194,4328,2665,4183,4445,6057,6685,6035,6028,5807,5988,6513,6531,4399,4999,4196,6151,4158,5588,4511,6509,3534,4127,5192,10519,5024,4156,4002,4795,3815,10600,11088,6295,6677,5101,5692,5806,5307,4529,4042,5308,5359,4261,4857,4103,3461,5752,3685,4003,6960,8861,4719,4319,3273,4940,2871,8771,9162,7117,5352],[2879,2807,2894,3122,2891,2615,2831,2710,3031,2485,2545,3080,2601,3035,2464,2448,3233,3091,2233,3006,2833,2673,2921,3227,3137,3047,2886,3003,2700,2931,2882,2620,2872,3006,2656,2901,2587,2667,2482,2636,2476,2528,3137,2731,2634,2728,2132,2646,2650,2942,3051,2963,2975,2698,3027,3022,3119,2627,2842,2277,3020,2608,2916,2711,3075,2455,2574,2690,2649,2817,2598,2584,2757,2575,3393,3163,3008,2984,3085,3225,3193,2966,2937,2809,3146,3076,2890,2935,2829,2659,3088,2655,2789,3458,3578,3104,2891,2561,3063,2402,3566,3588,3403,3018],[1725.16285528266,1676.1599485307,1726.97480783618,1856.74119849785,1730.54068947982,1571.18655892492,1692.17340588393,1634.22908396306,1804.88199633527,1505.31220732595,1539.27275846768,1826.29863270988,1565.92450265957,1801.29057660466,1489.46971700288,1474.87037863424,1917.31076303823,1845.25486693111,1367.75506959196,1794.15444515721,1690.45589148097,1607.22969794786,1744.65355103149,1908.10068046651,1863.6057507963,1816.31003936613,1722.55604989858,1789.49551605098,1623.63182924482,1750.4912355777,1711.95473501983,1576.32383971356,1713.35580861226,1786.56654125488,1599.63207525045,1731.56454588921,1558.44202539411,1592.29277174385,1491.74034354798,1590.72432762544,1484.33459387857,1517.74865407022,1857.73987477186,1639.69109850858,1575.19255113976,1629.16106296121,1299.32588813316,1586.03314919888,1585.78425092996,1748.59252209298,1810.50523799157,1764.88004990536,1775.00275574125,1613.03722013424,1804.49789313641,1800.62657026653,1846.151561195,1577.16156716989,1699.74002534446,1388.51781191743,1799.85242634959,1567.76473140908,1742.76635054908,1630.64319150702,1834.04139193926,1476.65988359208,1552.51862188041,1619.75529418542,1585.01915983509,1687.84887668,1568.92893322548,1555.29851239489,1653.15479335936,1550.1586200775,1999.51112210038,1876.58520188956,1791.75549083195,1782.43339254605,1829.02123033611,1903.27919312104,1894.02366270819,1767.09618620534,1748.80290504763,1680.10997622125,1859.17926900358,1817.21336398199,1724.83392377216,1745.76532270146,1684.87873700391,1597.06160688561,1832.27542470396,1589.16990641289,1662.09112613973,2036.02604109963,2097.97341893145,1835.9617503114,1720.65123751521,1542.3033434632,1808.61650647953,1448.25761610723,2091.69921377307,2108.83202934989,2002.91303972519,1794.69913131596],[2056.0321832139,1746.78284328323,1943.99593173585,2511.32181224823,2165.60340030278,1827.53426330828,1943.80239615699,1724.52216384953,2173.03692694109,1484.60770098425,1743.65766188634,2308.06932416071,1615.92522241601,2219.28850944056,1510.15331557605,1441.79327949779,2574.0825718458,2275.33719982902,1375.19369013996,2055.30035292015,1850.0193580593,1628.02179510652,2101.87547821345,2848.10691354067,2526.01303896864,2388.98663242067,2186.1019923973,2396.56160957379,1850.18913336351,2263.46973978744,2281.24075279505,1733.89461813232,2173.11838924212,2587.47986073038,1806.57424747507,2161.46678557814,1898.58031480737,1884.86166055997,1641.69253564103,1884.04980383849,1641.62522061254,1791.82036744975,2818.64928896633,1948.88747858815,1921.004317803,1931.03648668486,1422.44950820033,1884.37839830658,1879.39952668158,2426.10219189248,2481.87008785588,2324.94845903215,2186.4906169546,2239.35166485748,2371.82616699606,2456.34614128076,2437.55570783541,1908.83318231771,1902.1304829397,1717.41434546402,2269.38783535571,1774.02975755408,2180.29243854667,1845.24988578067,2399.27360783763,1613.20023680764,1931.70763049985,2015.63989624479,2777.84106343559,1956.67986406592,1795.79834787496,1708.23344959471,1992.50009289743,1734.27925717116,3210.53634396868,3144.31696379537,2274.19643020374,2409.1718931753,2518.54465771614,2623.29050872116,2655.0548426001,2326.46902692834,2193.11395412456,2093.25306936535,2634.78031247199,2464.83999601817,2245.40531594366,2284.66982694272,2182.35233891636,1924.60064868581,2637.27000590539,1926.37903867,2072.7748254919,3093.28026466106,3626.3171684408,2463.59285642937,2154.9227851466,1807.28356333759,2436.83514758792,1656.05376069823,3541.74692792095,3598.85167580331,3067.8844529446,2517.69491384929],[1366.48798250784,1207.18909816442,1356.58293981897,1554.73416921706,1407.96302339029,1247.64078361851,1334.79129762374,1267.15920223249,1444.92073340552,1157.07052801813,1280.10890978726,1557.80225097097,1190.3812013442,1451.9219567059,1152.19307830805,1121.75312087469,1620.40159773269,1503.05535212339,1120.7273989437,1408.98398955391,1341.97125236821,1245.73616516596,1347.971954104,1639.72737956554,1536.65515088141,1474.35504170469,1488.12908386451,1577.18880151315,1337.64257647286,1510.69891516407,1494.09003774343,1317.34026545627,1489.72386132217,1618.29791278465,1343.87264302325,1457.45196150221,1382.01712955057,1385.52165399579,1253.7592634916,1353.34268252994,1254.39521336721,1300.1272444081,1622.00507246834,1401.37481847011,1363.96925432801,1405.18662803866,1150.13673556888,1359.05403447292,1317.48401962802,1540.99565423176,1546.33841113861,1542.31500093498,1461.42960254086,1400.10318046611,1590.63371683055,1583.68728957774,1607.88246810591,1361.66849322996,1374.94480841941,1110.60710321743,1529.64775238266,1326.56554239901,1482.0994616278,1312.76875365159,1551.53173807656,1243.58295800421,1363.26116360149,1400.68108071302,1277.9671361811,1422.61779534678,1312.00620318076,1266.37603636699,1394.15638681868,1293.71376561098,1784.62732721538,1627.96940799868,1504.11437742008,1550.06421380214,1800.86806776014,1878.12660000092,1828.61347121294,1592.4546122336,1644.18954428346,1625.77553106714,1843.52043773921,1710.10581508006,1686.06052805491,1618.50232884181,1655.19295269195,1566.5002214673,1775.71778317179,1493.03035493383,1585.88704309908,1990.93160513568,2162.87556588727,1855.59586655803,1653.38178873737,1452.0658201829,1776.31925378892,1411.32391756448,2088.91941119799,2062.54529929004,1949.89208062156,1710.73610093717],[301.88534864812,279.158617406431,296.969777007252,324.427011635309,307.410424254289,283.545246454788,295.848565874357,289.133684772895,310.150349701816,272.844836754918,288.695571202247,326.682103232916,275.405026169435,310.36737202637,270.272902974192,265.130494002995,332.574411109761,320.660441041398,268.028633203169,306.393341760345,296.687359330597,285.221496244862,298.288074325505,338.36498612117,324.109645797528,315.828071294603,312.130489200777,325.220544414429,289.163951354359,317.657008230907,309.640407791837,288.84197052361,310.088487376129,327.813206694218,293.627879152034,305.800198845274,299.389082781314,292.452354213918,281.928989187011,293.609619372067,277.543297192223,284.522928516766,325.802652417613,298.628110936332,292.442310572116,299.295871780769,267.807073855049,293.631652585052,283.57283244973,317.828326054908,317.742060594343,319.419896631457,309.73363280911,302.95091453632,328.416252666195,325.844418604925,327.480817948237,298.26117577789,297.836654007253,266.79379786152,319.156858282123,292.972119853593,314.749064300105,291.397346904381,324.043645537159,281.727150009278,297.061409825836,305.554257695253,287.665731340445,304.16199155818,295.505578932809,282.775687842946,300.640838019185,287.617531540077,349.321700146703,331.029238103559,315.614054879819,322.727719560323,357.656710711918,364.24865066742,358.974611326753,328.765101084824,336.742093475325,335.087917210199,357.366803661982,340.895359605284,342.838988630418,331.596900847057,335.837493176859,328.142426211268,349.491228737882,315.959124609776,328.935506877491,377.800998895027,394.043388361464,364.406787563116,337.08330160303,312.299709634751,351.369241196288,309.728193999298,387.798747492462,387.088760149236,372.220043300511,347.840601299465],[627.884004964247,404.377389790711,513.424881087308,686.115827839253,638.072769373309,578.726512329746,594.184974939676,479.350067051005,624.087489823587,494.384859019882,637.109195646437,716.164123290136,466.225549580705,574.408592850018,461.856035469045,458.375778668284,723.562348442881,599.831591209317,524.024200477164,546.37633129222,532.024578170405,496.164964609877,549.779586992542,792.480504518502,659.377487067827,706.399927599074,756.928459174902,858.926156461191,641.128946745451,805.611360012354,849.678425314321,650.618852420524,765.57402396474,902.476693075174,657.654419600101,746.830202267158,778.060642544557,726.468855090322,619.239665320228,746.873879367346,642.436186573582,674.507706648915,811.397888140941,712.742999719052,714.936897060944,728.184767654436,622.056168234809,692.295093292599,599.332410329423,878.959309114124,786.512538481718,805.911828909174,665.317410941386,811.795642369243,851.892081901681,834.471698551979,820.880456592984,735.361686081938,605.502023683839,517.535298149417,745.595082331117,718.817929504739,747.294770547616,603.004192429003,788.821399685086,579.242482878225,771.603706749039,803.892247169535,751.926524783895,685.03332413234,714.709834519556,628.893046873661,681.251607416791,677.420918835078,967.621336113388,935.571454333233,740.953629767211,868.1099665676,1165.50673889157,1133.25833166748,1121.26036648132,905.086578164507,934.314779634782,992.880821174736,1205.80957353749,1017.79048560444,1129.22746135204,958.106120639118,1109.96925867034,990.238458895379,1123.35125815047,920.692422036099,1002.94079093275,1214.65159827578,1472.85609671704,1169.72548492115,965.029264329323,846.13963067439,1109.74468344359,846.957715329383,1354.99719192737,1319.75938598521,1234.89082633378,1041.88357380174],[502.348382305254,350.664444068854,437.666059929287,559.652648901032,519.228111199621,457.581738754522,476.191264941547,433.627787877708,528.118875383308,453.290129687639,545.786009230022,611.729319813383,407.972421815806,437.380632475832,384.716732650981,401.01365468588,595.318266800468,514.142936113085,465.130213968408,467.498402088574,469.101371649996,447.38295763283,479.064235329431,629.757733281126,547.711653546353,552.705942084807,644.219221758037,690.028983458221,545.654228509789,657.52752205824,655.607933688573,567.333175002771,625.188702202659,695.862037731943,570.37424352746,592.738491010655,635.08280883845,604.267082182099,539.806434466996,607.651028735879,558.47447137902,576.12039965168,631.138278677852,605.101860425962,582.308750341236,620.408824766847,526.704164044075,552.755963475922,474.437142077993,690.63709860105,611.133879427138,685.520187033096,563.376354178266,632.811883968437,688.286426630238,687.694116192219,688.365807926314,609.957147706183,537.149180358166,405.459393954938,639.693639977286,617.9890589119,613.990988221447,479.75787417378,641.158300386276,505.530278496841,612.483912044933,677.128231984256,473.916395975116,600.738823490781,595.34828764573,533.639881678573,569.760540553616,554.864062065099,732.413441123193,700.044413975598,622.393996149133,698.568779485734,950.887214654269,968.388767923526,927.110168832179,723.962865964884,795.758437727043,851.652876898238,971.135642353717,812.087823309844,936.540175125755,789.806901656442,922.729970326409,863.497489839828,881.148704426309,757.067718963047,845.919293783464,959.65217743569,1119.22636426693,989.238402714127,851.191143583079,722.402694034638,930.334621569746,745.467017055702,989.606354334949,971.286453839517,940.749307644401,841.700176837403],[21.7505911907355,21.7342467100818,21.5577641539372,21.7501461661161,21.7427373683627,21.5813099296065,21.6870876273853,21.7187046234625,21.7392669357052,21.6660947385808,21.5731768733734,21.8543481097229,21.5469641591232,21.5456620913628,21.5856586241699,21.6362772692017,21.7180761206089,21.4927228760814,21.4968685741788,21.8160583906173,21.6801556307109,21.6898083197952,21.7757391001518,21.9048975835004,21.6986101271378,21.8307269740062,20.7631932919673,20.9557510791554,20.4160605079904,21.0196506112365,20.7401599549115,20.438802159492,20.521941679864,20.8999565068995,20.5603380625521,20.6663045841025,20.7727478516804,20.4208139932696,20.672322701883,20.4862075894972,20.3879116792687,20.6644775770624,20.790214408853,20.484446821045,20.5324527728779,20.6474886132252,20.7718344338345,20.5962924395206,20.1511951854713,20.8685826800426,20.6661631438879,20.9353156399904,21.5907599429505,21.517926155029,21.7280084047029,21.7178322952076,21.6533649619082,21.5854339248885,21.5445374203906,21.6443872236708,21.6036719718927,21.6206761832529,21.6984424402631,21.6474377643314,21.7578846090779,21.6000568325297,21.459325600355,21.8005116467624,21.6063792668278,21.4754938593354,21.8645071546515,21.4185423784944,21.5733236177617,21.4166816688624,21.7444318010139,21.4792186926813,21.7177663153255,21.653320107387,21.4956727762237,21.4880808561763,21.2925420431532,21.2025618688596,21.3507534581951,21.3213125605308,21.3626407316617,21.1738189895448,21.5257239420939,21.2513507071369,21.2760478818037,21.4082730429256,21.196199563866,21.1677232201591,21.2511095419182,21.4060675874043,21.4253608396516,21.5725140700904,21.3124421055089,21.143570228585,21.3636146526525,21.1799731580811,21.4098463926565,21.4677863073045,21.3622556482839,21.5771976981341]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>sample_id<\/th>\n      <th>SITE<\/th>\n      <th>WEEK<\/th>\n      <th>REGION<\/th>\n      <th>SEASON<\/th>\n      <th>REP<\/th>\n      <th>Observed<\/th>\n      <th>Observed_p<\/th>\n      <th>Observed_pt<\/th>\n      <th>Shannon_exp<\/th>\n      <th>Shannon_exp_p<\/th>\n      <th>Shannon_exp_pt<\/th>\n      <th>InvSimpson<\/th>\n      <th>InvSimpson_p<\/th>\n      <th>InvSimpson_pt<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"dom":"Blfrtip","buttons":["copy","csv","excel"],"pageLength":5,"lengthMenu":[[5,-1],["5","All"]],"columnDefs":[{"targets":8,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\");\n  }"},{"targets":9,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\");\n  }"},{"targets":10,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\");\n  }"},{"targets":11,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\");\n  }"},{"targets":12,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\");\n  }"},{"targets":13,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\");\n  }"},{"targets":14,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\");\n  }"},{"className":"dt-right","targets":[6,7,8,9,10,11,12,13,14]}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true,"rowCallback":"function(row, data) {\nvar value=data[0]; $(this.api().cell(row, 0).node()).css({'font-size':'80%'});\nvar value=data[1]; $(this.api().cell(row, 1).node()).css({'font-size':'80%'});\nvar value=data[2]; $(this.api().cell(row, 2).node()).css({'font-size':'80%'});\nvar value=data[3]; $(this.api().cell(row, 3).node()).css({'font-size':'80%'});\nvar value=data[4]; $(this.api().cell(row, 4).node()).css({'font-size':'80%'});\nvar value=data[5]; $(this.api().cell(row, 5).node()).css({'font-size':'80%'});\nvar value=data[6]; $(this.api().cell(row, 6).node()).css({'font-size':'80%'});\nvar value=data[7]; $(this.api().cell(row, 7).node()).css({'font-size':'80%'});\nvar value=data[8]; $(this.api().cell(row, 8).node()).css({'font-size':'80%'});\nvar value=data[9]; $(this.api().cell(row, 9).node()).css({'font-size':'80%'});\nvar value=data[10]; $(this.api().cell(row, 10).node()).css({'font-size':'80%'});\nvar value=data[11]; $(this.api().cell(row, 11).node()).css({'font-size':'80%'});\nvar value=data[12]; $(this.api().cell(row, 12).node()).css({'font-size':'80%'});\nvar value=data[13]; $(this.api().cell(row, 13).node()).css({'font-size':'80%'});\nvar value=data[14]; $(this.api().cell(row, 14).node()).css({'font-size':'80%'});\n}"}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render","options.columnDefs.4.render","options.columnDefs.5.render","options.columnDefs.6.render","options.rowCallback"],"jsHooks":[]}</script>
</div>
<h3 id="normality-tests-1">Normality Tests</h3>
<p>Before running significance tests, we need to know if data is normally distributed, which will tell use whether to use a parametric or non-parametric test. To test if the data are normally distributed, we use the Shapiro-Wilk Normality test and the Bartlett Test of Homogeneity of Variances.</p>
<p>If the p-values are both <strong>not significant</strong> (p &gt; 0.05) from the tests, we accept the null hypothesis (that the results are normally distributed) and test for significance between samples using an ANOVA. If the p-values are both <strong>significant</strong> (p &lt; 0.05), we reject the null hypothesis (that the results are normally distributed) and test for significance between samples using Kruskal-Wallis (non-parametric equivalent of ANOVA).</p>
<p>The commands are as follows:</p>
<p><code>shapiro.test(x)</code>, where <code>x</code> is a numeric vector of alpha diversity values from the sample data table.</p>
<p><code>bartlett.test(Value ~ Group, data = df)</code> Where <code>Value</code> is the metric of interest, <code>Group</code> in the treatment to compare, and <code>df</code> is the data frame.</p>
<p>First the Shapiro-Wilk Normality test.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>ssu_div_tab <span class="ot">&lt;-</span> ssu_samp_data_tab</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>ssu_shap_tests <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">colnames</span>(ssu_div_tab[,<span class="dv">7</span><span class="sc">:</span><span class="dv">15</span>])) {</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>   tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">&quot;ssu_shap_&quot;</span>, .))</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>   ssu_shap_tests <span class="ot">&lt;-</span> <span class="fu">append</span>(ssu_shap_tests, tmp_name)</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>   tmp_test <span class="ot">&lt;-</span> <span class="fu">eval</span>(<span class="fu">shapiro.test</span>(ssu_div_tab[[i]]))</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>   tmp_test<span class="sc">$</span>data.name <span class="ot">&lt;-</span> tmp_name</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">assign</span>(tmp_name, tmp_test)</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<p>And then the Bartlett Test of Homogeneity of Variances.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>ssu_div_tab <span class="ot">&lt;-</span> ssu_samp_data_tab</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>ssu_bart_tests <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">colnames</span>(ssu_div_tab[,<span class="dv">7</span><span class="sc">:</span><span class="dv">15</span>])) {</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>   tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">&quot;ssu_bart_&quot;</span>, .))</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>   ssu_bart_tests <span class="ot">&lt;-</span> <span class="fu">append</span>(ssu_bart_tests, tmp_name)</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>   tmp_test <span class="ot">&lt;-</span> <span class="fu">eval</span>(<span class="fu">bartlett.test</span>(ssu_div_tab[[i]] <span class="sc">~</span> SITE, <span class="at">data =</span> ssu_div_tab))</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>   tmp_test<span class="sc">$</span>data.name <span class="ot">&lt;-</span> tmp_name</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">assign</span>(tmp_name, tmp_test)</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<p>Here we see which Shapiro-Wilk Normality <strong>and</strong> Bartlett tests were significant and which were not for the FULL data set analysis?</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">colnames</span>(ssu_div_tab[,<span class="dv">7</span><span class="sc">:</span><span class="dv">15</span>])) {</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  tmp_get_shap <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">&quot;ssu_shap_&quot;</span>, .)))</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  tmp_shap_p <span class="ot">&lt;-</span> <span class="fu">round</span>(tmp_get_shap[[<span class="dv">2</span>]], <span class="dv">4</span>)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  tmp_get_bart <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">&quot;ssu_bart_&quot;</span>, .)))</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  tmp_bart_p <span class="ot">&lt;-</span> <span class="fu">round</span>(tmp_get_bart[[<span class="dv">3</span>]], <span class="dv">4</span>)</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>  tmp_res <span class="ot">&lt;-</span> <span class="fu">eval</span>(<span class="fu">isTRUE</span>(tmp_get_shap[[<span class="dv">2</span>]] <span class="sc">&gt;</span> <span class="fl">0.05</span>) <span class="sc">&amp;</span> <span class="fu">isTRUE</span>(tmp_get_bart[[<span class="dv">3</span>]] <span class="sc">&gt;</span> <span class="fl">0.05</span>))</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>  tmp_print <span class="ot">&lt;-</span> <span class="fu">c</span>(i, <span class="st">&quot;Shapiro p-value =&quot;</span>, tmp_shap_p, </span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;Bartlett p-value =&quot;</span>, tmp_bart_p, </span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;Are both p-values &gt; 0.05?&quot;</span>, tmp_res)</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(tmp_print,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>Observed Shapiro p-value = 0 Bartlett p-value = 0.0895 Are both p-values &gt; 0.05? FALSE 
Observed_p Shapiro p-value = 0.2399 Bartlett p-value = 0.4321 Are both p-values &gt; 0.05? TRUE 
Observed_pt Shapiro p-value = 0.2994 Bartlett p-value = 0.4728 Are both p-values &gt; 0.05? TRUE 
Shannon_exp Shapiro p-value = 0.0002 Bartlett p-value = 0.1238 Are both p-values &gt; 0.05? FALSE 
Shannon_exp_p Shapiro p-value = 0.0024 Bartlett p-value = 0.1272 Are both p-values &gt; 0.05? FALSE 
Shannon_exp_pt Shapiro p-value = 0.0065 Bartlett p-value = 0.3507 Are both p-values &gt; 0.05? FALSE 
InvSimpson Shapiro p-value = 0.0005 Bartlett p-value = 0.0125 Are both p-values &gt; 0.05? FALSE 
InvSimpson_p Shapiro p-value = 0.0002 Bartlett p-value = 0.0531 Are both p-values &gt; 0.05? FALSE 
InvSimpson_pt Shapiro p-value = 0 Bartlett p-value = 0.0037 Are both p-values &gt; 0.05? FALSE </code></pre>
</div>
<p>So wherever the value of both p-values in <code>&gt; 0.05</code> we can use an ANOVA, otherwise we use Kruskal-Wallis.</p>
<h3 id="significance-tests-1">Significance Tests</h3>
<p>To begin, we need to create a hierarchy variable; a two-column matrix specifying the relationship between samples (first column) and groups (second column).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>ssu_hill_hier <span class="ot">&lt;-</span> ssu_samp_data_tab</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>ssu_hill_hier <span class="ot">&lt;-</span> ssu_hill_hier <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="st">&quot;sample_id&quot;</span>, <span class="st">&quot;SITE&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">remove_rownames</span>()</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>ssu_hill_hier <span class="ot">&lt;-</span> ssu_hill_hier[<span class="fu">order</span>(ssu_hill_hier<span class="sc">$</span>SITE), ]</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="co">#ssu_hill_hier$SITE = paste(ssu_hill_hier$SITE, &#39;C&#39;, sep=&#39;&#39;)</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="co"># ADD NEXT LINE TO REORDER BY SITE</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a><span class="co">#ssu_hill_hier &lt;- ssu_hill_hier[order(factor(ssu_hill_hier$SITE,levels=c(c(&quot;ALMR&quot;, &quot;PAST&quot;, &quot;CRIS&quot;, &quot;PUCL&quot;)))),]</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>ssu_hill_hier <span class="ot">&lt;-</span> ssu_hill_hier <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">remove_rownames</span>()</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(ssu_hill_hier, <span class="st">&quot;files/trepo/alpha/rdata/ssu_merge_hill_hier.rds&quot;</span>)</span></code></pre></div>
</div>
<p>Again, we start by testing significance of ASV diversity for the full data set against each of the three metrics using the <code>div_test</code> function.</p>
<p>The command is as follows:</p>
<p><code>div_test(countable = x, qvalue = i, hierarchy = hier, tree = ultrametric_tree, posthoc = TRUE)</code>, where <code>x</code> is ASV by sample table, <code>i</code> is the q-value corresponding to the metric of interest, <code>hier</code> is the hierarchy matrix, <code>tree</code> is an ultrametric formatted phylogenetic tree (see below), and <code>posthoc</code> indicates whether to run post hoc pairwise analyses.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>ssu_alpha_ds_full <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;ssu_ps_work_merge&quot;</span>, <span class="st">&quot;ssu_ps_pime_merge&quot;</span>)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>qvalue <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> ssu_alpha_ds_full) {</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>     <span class="cf">for</span> (j <span class="cf">in</span> qvalue) {</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>         tmp_get <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_tu&quot;</span>)))</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>         tmp_test <span class="ot">&lt;-</span> <span class="fu">div_test</span>(tmp_get, <span class="at">qvalue =</span> j,</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">hierarchy =</span> ssu_hill_hier,</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">posthoc =</span> <span class="cn">TRUE</span>)</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>         tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_q&quot;</span>, j, <span class="st">&quot;_adt&quot;</span>))</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>         <span class="fu">print</span>(tmp_name)</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>         <span class="fu">assign</span>(tmp_name, tmp_test)</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>         <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>(<span class="at">pattern =</span> <span class="st">&quot;_t&quot;</span>)</span></code></pre></div>
</div>
<p>And then test significance of lineage diversity for the PIME filtered data set only.</p>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>ssu_alpha_ds_full_tree <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;ssu_ps_pime_merge&quot;</span>)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>qvalue <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> ssu_alpha_ds_full_tree) {</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>     <span class="cf">for</span> (j <span class="cf">in</span> qvalue) {</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>         tmp_get <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_tu&quot;</span>)))</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>         tmp_tree <span class="ot">&lt;-</span> <span class="fu">get</span>(purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_tree_ult&quot;</span>)))</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>         tmp_test <span class="ot">&lt;-</span> <span class="fu">div_test</span>(tmp_get, <span class="at">qvalue =</span> j,</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">hierarchy =</span> ssu_hill_hier,</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">posthoc =</span> <span class="cn">TRUE</span>,</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">tree =</span> tmp_tree)</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>         tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_t_q&quot;</span>, j, <span class="st">&quot;_adt&quot;</span>))</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>         <span class="fu">print</span>(tmp_name)</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>         <span class="fu">assign</span>(tmp_name, tmp_test)</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>         <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(ssu_ps_pime_merge_t_q0_adt, ssu_ps_pime_merge_t_q1_adt, ssu_ps_pime_merge_t_q2_adt, </span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a>     <span class="at">file =</span> <span class="st">&quot;files/trepo/alpha/rdata/ssu_ps_pime_merge_hill_lineage_test.rdata&quot;</span>)</span></code></pre></div>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<p><br/></p>
<div class="layout-chunk" data-layout="l-page">
<table>
<colgroup>
<col style="width: 13%" />
<col style="width: 5%" />
<col style="width: 12%" />
<col style="width: 13%" />
<col style="width: 13%" />
<col style="width: 30%" />
<col style="width: 10%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">metric</th>
<th style="text-align: left;">q-value</th>
<th style="text-align: right;">normality p-value</th>
<th style="text-align: right;">homogeneity p-value</th>
<th style="text-align: left;">method</th>
<th style="text-align: left;">posthoc method</th>
<th style="text-align: right;">posthoc p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Observed</td>
<td style="text-align: left;">0</td>
<td style="text-align: right;">0.0000032</td>
<td style="text-align: right;">0.0894791</td>
<td style="text-align: left;">Kruskal-Wallis Test</td>
<td style="text-align: left;">Dunn test with Benjamini-Hochberg correction</td>
<td style="text-align: right;">0.2075816</td>
</tr>
<tr class="even">
<td style="text-align: left;">Shannon exponential</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">0.0001597</td>
<td style="text-align: right;">0.1238040</td>
<td style="text-align: left;">Kruskal-Wallis Test</td>
<td style="text-align: left;">Dunn test with Benjamini-Hochberg correction</td>
<td style="text-align: right;">0.0012826</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inverse Simpson</td>
<td style="text-align: left;">2</td>
<td style="text-align: right;">0.0005432</td>
<td style="text-align: right;">0.0125484</td>
<td style="text-align: left;">Kruskal-Wallis Test</td>
<td style="text-align: left;">Dunn test with Benjamini-Hochberg correction</td>
<td style="text-align: right;">0.0000000</td>
</tr>
</tbody>
</table>
</div>
<p><em>Summary of significant tests (<strong>ASV diversity</strong>).</em></p>
<p><br/></p>
<div class="layout-chunk" data-layout="l-page">
<table>
<colgroup>
<col style="width: 13%" />
<col style="width: 5%" />
<col style="width: 12%" />
<col style="width: 13%" />
<col style="width: 13%" />
<col style="width: 30%" />
<col style="width: 10%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">metric</th>
<th style="text-align: left;">q-value</th>
<th style="text-align: right;">normality p-value</th>
<th style="text-align: right;">homogeneity p-value</th>
<th style="text-align: left;">method</th>
<th style="text-align: left;">posthoc method</th>
<th style="text-align: right;">posthoc p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Observed</td>
<td style="text-align: left;">0</td>
<td style="text-align: right;">0.2399448</td>
<td style="text-align: right;">0.4320767</td>
<td style="text-align: left;">ANOVA</td>
<td style="text-align: left;">Tukey post-hoc test</td>
<td style="text-align: right;">0.001358</td>
</tr>
<tr class="even">
<td style="text-align: left;">Shannon exponential</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">0.0024114</td>
<td style="text-align: right;">0.1272253</td>
<td style="text-align: left;">Kruskal-Wallis Test</td>
<td style="text-align: left;">Dunn test with Benjamini-Hochberg correction</td>
<td style="text-align: right;">0.000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inverse Simpson</td>
<td style="text-align: left;">2</td>
<td style="text-align: right;">0.0001801</td>
<td style="text-align: right;">0.0530918</td>
<td style="text-align: left;">Kruskal-Wallis Test</td>
<td style="text-align: left;">Dunn test with Benjamini-Hochberg correction</td>
<td style="text-align: right;">0.000000</td>
</tr>
</tbody>
</table>
</div>
<p><em>Summary of significant tests for PIME filtered data (<strong>ASV diversity</strong>).</em></p>
<p><br/></p>
<div class="layout-chunk" data-layout="l-page">
<table>
<colgroup>
<col style="width: 13%" />
<col style="width: 5%" />
<col style="width: 12%" />
<col style="width: 13%" />
<col style="width: 13%" />
<col style="width: 30%" />
<col style="width: 10%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">metric</th>
<th style="text-align: left;">q-value</th>
<th style="text-align: right;">normality p-value</th>
<th style="text-align: right;">homogeneity p-value</th>
<th style="text-align: left;">method</th>
<th style="text-align: left;">posthoc method</th>
<th style="text-align: right;">posthoc p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Observed</td>
<td style="text-align: left;">0</td>
<td style="text-align: right;">0.2994211</td>
<td style="text-align: right;">0.4728254</td>
<td style="text-align: left;">ANOVA</td>
<td style="text-align: left;">Tukey post-hoc test</td>
<td style="text-align: right;">0.0018443</td>
</tr>
<tr class="even">
<td style="text-align: left;">Shannon exponential</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">0.0065482</td>
<td style="text-align: right;">0.3506509</td>
<td style="text-align: left;">Kruskal-Wallis Test</td>
<td style="text-align: left;">Dunn test with Benjamini-Hochberg correction</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inverse Simpson</td>
<td style="text-align: left;">2</td>
<td style="text-align: right;">0.0000001</td>
<td style="text-align: right;">0.0036993</td>
<td style="text-align: left;">Kruskal-Wallis Test</td>
<td style="text-align: left;">Dunn test with Benjamini-Hochberg correction</td>
<td style="text-align: right;">0.0000000</td>
</tr>
</tbody>
</table>
</div>
<p><em>Summary of significant tests the PIME filtered data (<strong>ASV Lineage diversity</strong>).</em></p>
<p><br/></p>
<h3 id="posthoc-analyses-1">PostHoc Analyses</h3>
<p>First let’s check the results of each posthoc analysis.</p>
<details>
<summary>
Detailed results of PostHoc Analyses for each metric
</summary>
<h4 id="observed-q-value-0-1">Observed (q-value = 0)</h4>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;ASV diversity FULL data set (Observed)&quot;
[1] &quot;Dunn test with Benjamini-Hochberg correction&quot;
                   Z    P.unadj     P.adj
ALMR-CRIS  1.8847836 0.05945906 0.3567544
ALMR-PAST  0.3217923 0.74761003 0.7476100
CRIS-PAST -1.5629913 0.11805465 0.3541640
ALMR-PUCL  1.3055574 0.19170311 0.3834062
CRIS-PUCL -0.5792262 0.56243657 0.6749239
PAST-PUCL  0.9837651 0.32523103 0.4878465</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;ASV diversity PIME data set (Observed)&quot;
[1] &quot;Tukey post-hoc test&quot;
               diff         lwr      upr       p.adj
CRIS-ALMR -92.00000 -284.733749 100.7337 0.598515244
PAST-ALMR -25.96154 -218.695288 166.7722 0.984958245
PUCL-ALMR 195.19231    2.458558 387.9261 0.045953219
PAST-CRIS  66.03846 -126.695288 258.7722 0.807326224
PUCL-CRIS 287.19231   94.458558 479.9261 0.001012313
PUCL-PAST 221.15385   28.420097 413.8876 0.017745897</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;Lineage diversity PIME data set (Observed)&quot;
[1] &quot;Tukey post-hoc test&quot;
                 diff         lwr       upr       p.adj
CRISC-ALMRC -55.29075 -162.066591  51.48509 0.531726143
PASTC-ALMRC -15.22649 -122.002329  91.54935 0.982254750
PUCLC-ALMRC 101.82366   -4.952184 208.59950 0.067369932
PASTC-CRISC  40.06426  -66.711579 146.84010 0.760938419
PUCLC-CRISC 157.11441   50.338566 263.89025 0.001200643
PUCLC-PASTC 117.05014   10.274303 223.82599 0.025809519
[1] &quot;ssu_ps_pime_merge_t_q0_adt&quot;     
[2] &quot;ssu_ps_pime_merge_t_q0_adt_plot&quot;
[3] &quot;ssu_ps_pime_t_q0_adt_plot&quot;      </code></pre>
</div>
<h4 id="shannon-exponential-q-value-1-1">Shannon exponential (q-value = 1)</h4>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;ASV diversity FULL data set(Shannon exponential)&quot;
[1] &quot;Dunn test with Benjamini-Hochberg correction&quot;
                   Z      P.unadj       P.adj
ALMR-CRIS -0.3309864 0.7406547704 0.740654770
ALMR-PAST -1.1584523 0.2466794886 0.370019233
CRIS-PAST -0.8274660 0.4079730079 0.489567610
ALMR-PUCL -3.5856858 0.0003361935 0.002017161
CRIS-PUCL -3.2546994 0.0011351243 0.003405373
PAST-PUCL -2.4272335 0.0152144608 0.030428922</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;ASV diversity PIME data set (Shannon exponential)&quot;
[1] &quot;Dunn test with Benjamini-Hochberg correction&quot;
                   Z            P.unadj             P.adj
ALMR-CRIS -1.0067503 0.3140548067994535 0.376865768159344
ALMR-PAST -1.2228108 0.2214011623194150 0.332101743479123
CRIS-PAST -0.2160606 0.8289405450268563 0.828940545026856
ALMR-PUCL -6.1922036 0.0000000005932884 0.000000003559731
CRIS-PUCL -5.1854534 0.0000002154900225 0.000000646470067
PAST-PUCL -4.9693928 0.0000006716289164 0.000001343257833</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;Lineage diversity PIME data set (Shannon exponential)&quot;
[1] &quot;Dunn test with Benjamini-Hochberg correction&quot;
                     Z           P.unadj            P.adj
ALMRC-CRISC -0.1287169 0.897581640898052 0.89758164089805
ALMRC-PASTC -0.8872274 0.374956488372791 0.56243473255919
CRISC-PASTC -0.7585105 0.448145451347491 0.53777454161699
ALMRC-PUCLC -5.9347697 0.000000002942582 0.00000001765549
CRISC-PUCLC -5.8060528 0.000000006396279 0.00000001918884
PASTC-PUCLC -5.0475424 0.000000447529571 0.00000089505914</code></pre>
</div>
<h4 id="simpson-multiplicative-i.e.-inverse-simpson-q-value-2-1">Simpson multiplicative (i.e., Inverse Simpson) (q-value = 2)</h4>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;ASV diversity FULL data set (Inverse Simpson)&quot;
[1] &quot;Dunn test with Benjamini-Hochberg correction&quot;
                   Z                   P.unadj
ALMR-CRIS -3.5305214 0.00041474141527059112675
ALMR-PAST -3.5856858 0.00033619350474802537016
CRIS-PAST -0.0551644 0.95600749252137762201897
ALMR-PUCL -8.4401528 0.00000000000000003169231
CRIS-PUCL -4.9096314 0.00000091247758276900749
PAST-PUCL -4.8544670 0.00000120710988320547623
                             P.adj
ALMR-CRIS 0.0004976896983247093087
ALMR-PAST 0.0005042902571220380823
CRIS-PAST 0.9560074925213776220190
ALMR-PUCL 0.0000000000000001901539
CRIS-PUCL 0.0000027374327483070224
PAST-PUCL 0.0000024142197664109525</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;ASV diversity PIME data set (Inverse Simpson)&quot;
[1] &quot;Dunn test with Benjamini-Hochberg correction&quot;
                    Z                    P.unadj
ALMR-CRIS -3.58108879 0.000342165333238837905943
ALMR-PAST -3.55810363 0.000373541947897687608756
CRIS-PAST  0.02298517 0.981662105989184685661542
ALMR-PUCL -8.58266082 0.000000000000000009270339
CRIS-PUCL -5.00157203 0.000000568647142344905631
PAST-PUCL -5.02455719 0.000000504595416401124205
                              P.adj
ALMR-CRIS 0.00051324799985825683181
ALMR-PAST 0.00044825033747722511967
CRIS-PAST 0.98166210598918468566154
ALMR-PUCL 0.00000000000000005562204
CRIS-PUCL 0.00000113729428468981126
PAST-PUCL 0.00000151378624920337261</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;Lineage diversity PIME data set (Inverse Simpson)&quot;
[1] &quot;Dunn test with Benjamini-Hochberg correction&quot;
                    Z                  P.unadj
ALMRC-CRISC  8.168928 0.0000000000000003111422
ALMRC-PASTC  1.029735 0.3031342249161792512524
CRISC-PASTC -7.139192 0.0000000000009388083534
ALMRC-PUCLC  4.831482 0.0000013552060777679617
CRISC-PUCLC -3.337446 0.0008455213793625449697
PASTC-PUCLC  3.801746 0.0001436797613425384293
                              P.adj
ALMRC-CRISC 0.000000000000001866853
ALMRC-PASTC 0.303134224916179251252
CRISC-PASTC 0.000000000002816425060
ALMRC-PUCLC 0.000002710412155535923
CRISC-PUCLC 0.001014625655235053834
PASTC-PUCLC 0.000215519642013807630</code></pre>
</div>
</details>
<h3 id="alpha-diversity-plots-1">Alpha Diversity Plots</h3>
<p>Now we can plot the results from the posthoc analyses for each metric and data set using the function <code>div_test_plot_jjs</code>. I modified the orihginal function (<code>div_test_plot</code>) to control a little of the formatting.</p>
<p>The command is as follows:</p>
<p><code>div_test_plot(divtest = x, chart = "type", colour = col.pal, posthoc = TRUE, threshold = value))</code>, where <code>x</code> is the results from the <code>div_test</code> function, <code>"type"</code> is chart type (box, jitter, or violin),<code>colour</code> is is a color palette, <code>posthoc</code> indicates whether to run posthoc pairwise analyses, and <code>value</code> is the maximum p-value to show in pairwise posthoc results. <strong>WARNING</strong> if none of the posthoc results are below the specified threshold, the function will throw an error. Therefore, until this is fixed, all posthoc values are shown.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;hack_code/div_test_plot_jjs.R&quot;</span>)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>(<span class="at">pattern=</span><span class="st">&quot;_adt_plot&quot;</span>))</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">objects</span>(<span class="at">pattern=</span><span class="st">&quot;_adt&quot;</span>)) {</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>     tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_plot&quot;</span>))</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>     tmp_get <span class="ot">&lt;-</span> <span class="fu">get</span>(i)</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>     tmp_get<span class="sc">$</span>data <span class="ot">&lt;-</span> tmp_get<span class="sc">$</span>data[<span class="fu">order</span>(<span class="fu">factor</span>(tmp_get<span class="sc">$</span>data<span class="sc">$</span>Group,</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>                                <span class="at">levels=</span><span class="fu">c</span>(<span class="fu">c</span>(<span class="st">&quot;ALMR&quot;</span>, <span class="st">&quot;PAST&quot;</span>, <span class="st">&quot;CRIS&quot;</span>, <span class="st">&quot;PUCL&quot;</span>)))),]</span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>     tmp_get<span class="sc">$</span>data <span class="ot">&lt;-</span> tmp_get<span class="sc">$</span>data <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">remove_rownames</span>()</span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>     tmp_df <span class="ot">&lt;-</span> <span class="fu">div_test_plot_jjs</span>(tmp_get, <span class="at">chart =</span> <span class="st">&quot;box&quot;</span>,</span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">colour =</span> swel_col, <span class="at">posthoc =</span> <span class="cn">TRUE</span>)</span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>     tmp_df <span class="ot">&lt;-</span> <span class="fu">ggpar</span>(tmp_df, <span class="at">legend =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>     <span class="fu">print</span>(tmp_name)</span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>     <span class="fu">assign</span>(tmp_name, tmp_df)</span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>(<span class="at">pattern =</span> <span class="st">&quot;_adt&quot;</span>)</span></code></pre></div>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<p><br/></p>
<p>Posthoc adjusted p-values given for each pairwise comparison.</p>
<div class="layout-chunk" data-layout="l-page">
<div class="figure"><span id="fig:unnamed-chunk-108"></span>
<img src="include/trepo/alpha/ssu_merge_alph_div_plots_asv.png" alt="**Top row** = Observed; **middle row** = Shannon exponential; **bottom row** = Inverse Simpson. **Left** = ASV diversity full data set; **middle** = ASV diversity PIME data set; **right** = Lineage diversity PIME data set." width="4724" />
<p class="caption">
Figure 2: <strong>Top row</strong> = Observed; <strong>middle row</strong> = Shannon exponential; <strong>bottom row</strong> = Inverse Simpson. <strong>Left</strong> = ASV diversity full data set; <strong>middle</strong> = ASV diversity PIME data set; <strong>right</strong> = Lineage diversity PIME data set.
</p>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<h2 id="alpha-diversity-by-site-1">Alpha Diversity by Site</h2>
<p>Next, we calculate alpha diversity for each site using <code>alpha_div()</code> function, which computes a single alpha diversity value for a <strong>group of samples</strong>. So we need to create/use data frames containing samples split by group. If a tree object is provided, the computed alpha diversity is based on lineage diversity. We will run the analysis on the FULL and PIME data sets, both with and without trees.</p>
<p>The command is as follows:</p>
<p><code>alpha_div(countable = x, qvalue = j, tree = ultrametric_tree)</code>, where <code>x</code> is a count table , <code>j</code> is the q-value corresponding to the metric of interest, and <code>tree</code> is an ultrametric formatted phylogenetic tree.</p>
<h3 id="full-data-set-split-by-site-1">Full data set split by site</h3>
<p>We will start by splitting the full data set by treatment then generating new trees and ASV tables for each split.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>site <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;ALMR&quot;</span>,<span class="st">&quot;PAST&quot;</span>,<span class="st">&quot;CRIS&quot;</span>, <span class="st">&quot;PUCL&quot;</span>)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> site) {</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>     tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">&quot;ssu_ps_work_merge_&quot;</span>, .))</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>     tmp_ps <span class="ot">&lt;-</span> <span class="fu">subset_samples</span>(ssu_ps_work_merge, SITE <span class="sc">==</span> i)</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>     tmp_ps <span class="ot">&lt;-</span>  <span class="fu">prune_taxa</span>(<span class="fu">taxa_sums</span>(tmp_ps) <span class="sc">&gt;</span> <span class="dv">0</span>, tmp_ps)</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>     tmp_ps<span class="sc">@</span>phy_tree <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>     tmp_ps_tree <span class="ot">&lt;-</span> <span class="fu">rtree</span>(<span class="fu">ntaxa</span>(tmp_ps), <span class="at">rooted =</span> <span class="cn">TRUE</span>,</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>                            <span class="at">tip.label =</span> <span class="fu">taxa_names</span>(tmp_ps))</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>     tmp_ps <span class="ot">&lt;-</span> <span class="fu">merge_phyloseq</span>(tmp_ps, sample_data, tmp_ps_tree)</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>     <span class="fu">print</span>(tmp_name)</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>     <span class="fu">assign</span>(tmp_name, tmp_ps)</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>     tmp_asv <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(tmp_name, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_tu&quot;</span>))</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>     tmp_get <span class="ot">&lt;-</span> <span class="fu">get</span>(tmp_name)</span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>     tmp_get_asv <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">otu_table</span>(tmp_get))</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>     <span class="fu">print</span>(tmp_asv)</span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>     <span class="fu">assign</span>(tmp_asv, tmp_get_asv)</span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<p>As mentioned above, any tree used in the <code>hilldv</code> package must be <strong>ultrametric</strong>. So we need to convert the trees in order to look at lineage diversity. We will also save copies of each tree since this process takes a while to run.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>site <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;ALMR&quot;</span>,<span class="st">&quot;PAST&quot;</span>,<span class="st">&quot;CRIS&quot;</span>, <span class="st">&quot;PUCL&quot;</span>)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> site) {</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>     tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">&quot;ssu_ps_work_merge_&quot;</span>, .))</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>     tmp_name_tr <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(tmp_name, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_tree_ult&quot;</span>))</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>     tmp_get_name <span class="ot">&lt;-</span> <span class="fu">get</span>(tmp_name)</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>     tmp_ult_tree <span class="ot">&lt;-</span> <span class="fu">force.ultrametric</span>(tmp_get_name<span class="sc">@</span>phy_tree, <span class="at">method=</span><span class="fu">c</span>(<span class="st">&quot;extend&quot;</span>))</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>     <span class="fu">print</span>(tmp_name_tr)</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>     <span class="fu">assign</span>(tmp_name_tr, tmp_ult_tree)</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>     save_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(tmp_name_tr, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">&quot;files/trepo/alpha/rdata/&quot;</span>, ., <span class="st">&quot;.rds&quot;</span>))</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>     tree <span class="ot">&lt;-</span> <span class="fu">get</span>(tmp_name_tr)</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>     <span class="fu">saveRDS</span>(tree, save_name)</span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rm</span>(save_name)</span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>qvalue <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> site) {</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> qvalue){</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>     tmp_asv_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">&quot;ssu_ps_work_merge_&quot;</span>, ., <span class="st">&quot;_tu&quot;</span>))</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>     tmp_asv_name <span class="ot">&lt;-</span> <span class="fu">get</span>(tmp_asv_name)</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>     tmp_div_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">&quot;ssu_ps_work_merge_&quot;</span>, ., <span class="st">&quot;_aldiv_&quot;</span>, j))</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>     <span class="fu">print</span>(tmp_div_name)</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>     tmp_alpha_div <span class="ot">&lt;-</span> <span class="fu">alpha_div</span>(<span class="at">countable =</span> tmp_asv_name, <span class="at">qvalue =</span> j)</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>     <span class="fu">assign</span>(tmp_div_name, tmp_alpha_div)</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>qvalue <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> site) {</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> qvalue){</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>     tmp_asv_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">&quot;ssu_ps_work_merge_&quot;</span>, ., <span class="st">&quot;_tu&quot;</span>))</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>     tmp_asv_name <span class="ot">&lt;-</span> <span class="fu">get</span>(tmp_asv_name)</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>     tmp_tree_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">&quot;ssu_ps_work_merge_&quot;</span>, ., <span class="st">&quot;_tree_ult&quot;</span>))</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>     tmp_tree_name <span class="ot">&lt;-</span> <span class="fu">get</span>(tmp_tree_name)</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>     tmp_div_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">&quot;ssu_ps_work_merge_&quot;</span>, ., <span class="st">&quot;_aldiv_&quot;</span>, j, <span class="st">&quot;t&quot;</span>))</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>     <span class="fu">print</span>(tmp_div_name)</span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>     tmp_alpha_div <span class="ot">&lt;-</span> <span class="fu">alpha_div</span>(<span class="at">countable =</span> tmp_asv_name, <span class="at">qvalue =</span> j, <span class="at">tree =</span> tmp_tree_name)</span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>     <span class="fu">assign</span>(tmp_div_name, tmp_alpha_div)</span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<h3 id="pime-filtered-data-set-1">PIME filtered data set</h3>
<p>For this step, we will use the PIME data set. We start by making new trees and ASV tables for each split.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> site) {</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>     tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">&quot;ssu_ps_pime_merge_&quot;</span>, .))</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>     tmp_ps <span class="ot">&lt;-</span> <span class="fu">get</span>(tmp_name)</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>     tmp_ps<span class="sc">@</span>phy_tree <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>     tmp_ps_tree <span class="ot">&lt;-</span> <span class="fu">rtree</span>(<span class="fu">ntaxa</span>(tmp_ps), <span class="at">rooted =</span> <span class="cn">TRUE</span>,</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>                            <span class="at">tip.label =</span> <span class="fu">taxa_names</span>(tmp_ps))</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>     tmp_ps <span class="ot">&lt;-</span> <span class="fu">merge_phyloseq</span>(tmp_ps, sample_data, tmp_ps_tree)</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>     <span class="fu">print</span>(tmp_name)</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>     <span class="fu">assign</span>(tmp_name, tmp_ps)</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>     tmp_asv_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(tmp_name, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_tu&quot;</span>))</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>     tmp_get <span class="ot">&lt;-</span> <span class="fu">get</span>(tmp_name)</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>     tmp_asv_tab <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">otu_table</span>(tmp_get))</span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>     <span class="fu">print</span>(tmp_asv_name)</span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>     <span class="fu">assign</span>(tmp_asv_name, tmp_asv_tab)</span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> site) {</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>     tmp_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">&quot;ssu_ps_pime_merge_&quot;</span>, .))</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>     tmp_tr_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(tmp_name, <span class="sc">~</span> <span class="fu">paste0</span>(., <span class="st">&quot;_tree_ult&quot;</span>))</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>     tmp_get_name <span class="ot">&lt;-</span> <span class="fu">get</span>(tmp_name)</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>     ultra_tree <span class="ot">&lt;-</span> <span class="fu">force.ultrametric</span>(tmp_get_name<span class="sc">@</span>phy_tree, <span class="at">method=</span><span class="fu">c</span>(<span class="st">&quot;extend&quot;</span>))</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>     <span class="fu">print</span>(tmp_tr_name)</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>     <span class="fu">assign</span>(tmp_tr_name, ultra_tree)</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>     tmp_save_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(tmp_tr_name, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">&quot;files/trepo/alpha/rdata/&quot;</span>, ., <span class="st">&quot;.rds&quot;</span>))</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>     tmp_tree <span class="ot">&lt;-</span> <span class="fu">get</span>(tmp_tr_name)</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>     <span class="fu">saveRDS</span>(tmp_tree, tmp_save_name)</span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rm</span>(ultra_tree)</span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>qvalue <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> site) {</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> qvalue){</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>     tmp_asv_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">&quot;ssu_ps_pime_merge_&quot;</span>, ., <span class="st">&quot;_tu&quot;</span>))</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>     tmp_asv_name <span class="ot">&lt;-</span> <span class="fu">get</span>(tmp_asv_name)</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>     tmp_spl_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">&quot;ssu_ps_pime_merge_&quot;</span>, ., <span class="st">&quot;_tree_ult&quot;</span>))</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>     tmp_spl_name <span class="ot">&lt;-</span> <span class="fu">get</span>(tmp_spl_name)</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>     tmp_div_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">&quot;ssu_ps_pime_merge_&quot;</span>, ., <span class="st">&quot;_aldiv_&quot;</span>, j))</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>     <span class="fu">print</span>(tmp_div_name)</span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>     tmp_alpha_div <span class="ot">&lt;-</span> <span class="fu">alpha_div</span>(<span class="at">countable =</span> tmp_asv_name, <span class="at">qvalue =</span> j)</span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>     <span class="fu">assign</span>(tmp_div_name, tmp_alpha_div)</span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>qvalue <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> site) {</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> qvalue){</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>     tmp_asv_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">&quot;ssu_ps_pime_merge_&quot;</span>, ., <span class="st">&quot;_tu&quot;</span>))</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>     tmp_asv_name <span class="ot">&lt;-</span> <span class="fu">get</span>(tmp_asv_name)</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>     tmp_spl_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">&quot;ssu_ps_pime_merge_&quot;</span>, ., <span class="st">&quot;_tree_ult&quot;</span>))</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>     tmp_spl_name <span class="ot">&lt;-</span> <span class="fu">get</span>(tmp_spl_name)</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>     tmp_div_name <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(i, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">&quot;ssu_ps_pime_merge_&quot;</span>, ., <span class="st">&quot;_aldiv_&quot;</span>, j, <span class="st">&quot;t&quot;</span>))</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>     <span class="fu">print</span>(tmp_div_name)</span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>     tmp_alpha_div <span class="ot">&lt;-</span> <span class="fu">alpha_div</span>(<span class="at">countable =</span> tmp_asv_name, <span class="at">qvalue =</span> j, <span class="at">tree =</span> tmp_spl_name)</span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>     <span class="fu">assign</span>(tmp_div_name, tmp_alpha_div)</span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">&quot;tmp_&quot;</span>))</span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<p><br/></p>
<div class="layout-chunk" data-layout="l-page">
<table>
<colgroup>
<col style="width: 9%" />
<col style="width: 5%" />
<col style="width: 8%" />
<col style="width: 18%" />
<col style="width: 30%" />
<col style="width: 26%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">data set</th>
<th style="text-align: left;">site</th>
<th style="text-align: left;">type</th>
<th style="text-align: right;">Observed (q = 0)</th>
<th style="text-align: right;">Shannon exponential (q = 1)</th>
<th style="text-align: right;">Inverse Simpson (q = 2)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">full</td>
<td style="text-align: left;">ALMR</td>
<td style="text-align: left;">asv</td>
<td style="text-align: right;">5793.808</td>
<td style="text-align: right;">1965.1239</td>
<td style="text-align: right;">564.549518</td>
</tr>
<tr class="even">
<td style="text-align: left;">full</td>
<td style="text-align: left;">CRIS</td>
<td style="text-align: left;">asv</td>
<td style="text-align: right;">4904.269</td>
<td style="text-align: right;">2021.9701</td>
<td style="text-align: right;">728.151255</td>
</tr>
<tr class="odd">
<td style="text-align: left;">full</td>
<td style="text-align: left;">PAST</td>
<td style="text-align: left;">asv</td>
<td style="text-align: right;">5815.462</td>
<td style="text-align: right;">2128.1377</td>
<td style="text-align: right;">725.065978</td>
</tr>
<tr class="even">
<td style="text-align: left;">full</td>
<td style="text-align: left;">PUCL</td>
<td style="text-align: left;">asv</td>
<td style="text-align: right;">5292.731</td>
<td style="text-align: right;">2439.9823</td>
<td style="text-align: right;">1067.225431</td>
</tr>
<tr class="odd">
<td style="text-align: left;">full</td>
<td style="text-align: left;">ALMR</td>
<td style="text-align: left;">lineage</td>
<td style="text-align: right;">3203.430</td>
<td style="text-align: right;">305.2822</td>
<td style="text-align: right;">12.429029</td>
</tr>
<tr class="even">
<td style="text-align: left;">full</td>
<td style="text-align: left;">CRIS</td>
<td style="text-align: left;">lineage</td>
<td style="text-align: right;">2929.589</td>
<td style="text-align: right;">465.2024</td>
<td style="text-align: right;">28.335363</td>
</tr>
<tr class="odd">
<td style="text-align: left;">full</td>
<td style="text-align: left;">PAST</td>
<td style="text-align: left;">lineage</td>
<td style="text-align: right;">3511.358</td>
<td style="text-align: right;">475.1634</td>
<td style="text-align: right;">25.060708</td>
</tr>
<tr class="even">
<td style="text-align: left;">full</td>
<td style="text-align: left;">PUCL</td>
<td style="text-align: left;">lineage</td>
<td style="text-align: right;">3073.812</td>
<td style="text-align: right;">413.3335</td>
<td style="text-align: right;">13.423236</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pime</td>
<td style="text-align: left;">ALMR</td>
<td style="text-align: left;">asv</td>
<td style="text-align: right;">2839.962</td>
<td style="text-align: right;">1350.6638</td>
<td style="text-align: right;">477.769101</td>
</tr>
<tr class="even">
<td style="text-align: left;">pime</td>
<td style="text-align: left;">CRIS</td>
<td style="text-align: left;">asv</td>
<td style="text-align: right;">2747.962</td>
<td style="text-align: right;">1410.8571</td>
<td style="text-align: right;">600.482387</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pime</td>
<td style="text-align: left;">PAST</td>
<td style="text-align: left;">asv</td>
<td style="text-align: right;">2814.000</td>
<td style="text-align: right;">1420.8394</td>
<td style="text-align: right;">591.689516</td>
</tr>
<tr class="even">
<td style="text-align: left;">pime</td>
<td style="text-align: left;">PUCL</td>
<td style="text-align: left;">asv</td>
<td style="text-align: right;">3035.154</td>
<td style="text-align: right;">1736.5943</td>
<td style="text-align: right;">876.520914</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pime</td>
<td style="text-align: left;">ALMR</td>
<td style="text-align: left;">lineage</td>
<td style="text-align: right;">1433.311</td>
<td style="text-align: right;">135.8599</td>
<td style="text-align: right;">5.563441</td>
</tr>
<tr class="even">
<td style="text-align: left;">pime</td>
<td style="text-align: left;">CRIS</td>
<td style="text-align: left;">lineage</td>
<td style="text-align: right;">1740.892</td>
<td style="text-align: right;">305.8255</td>
<td style="text-align: right;">16.952373</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pime</td>
<td style="text-align: left;">PAST</td>
<td style="text-align: left;">lineage</td>
<td style="text-align: right;">1455.374</td>
<td style="text-align: right;">219.1365</td>
<td style="text-align: right;">15.665769</td>
</tr>
<tr class="even">
<td style="text-align: left;">pime</td>
<td style="text-align: left;">PUCL</td>
<td style="text-align: left;">lineage</td>
<td style="text-align: right;">1631.922</td>
<td style="text-align: right;">258.5645</td>
<td style="text-align: right;">17.225847</td>
</tr>
</tbody>
</table>
</div>
<p><em>Alpha diversity for sample groups from the full and PIME filtered data.</em> <br/></p>
<div class="layout-chunk" data-layout="l-page">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<h2 class="appendix" id="source-code">Source Code</h2>
<p>The source code for this page can be accessed on GitHub by <a href="https://github.com/tropical-repo/web/blob/master/trepo-alpha.Rmd">clicking this link</a>. Please note, that in order to process the data <em>and</em> build the website, we needed to run the workflow and get the results. Then hard code the results and turn off the individual commands. So the raw file for this page is a bit messy—you have been warned.</p>
<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-alberdi2019guide" class="csl-entry" role="doc-biblioentry">
Alberdi, Antton, and M Thomas P Gilbert. 2019a. <span>“A Guide to the Application of Hill Numbers to DNA-Based Diversity Analyses.”</span> <em>Molecular Ecology Resources</em> 19 (4): 804–17. <a href="https://doi.org/10.1111/1755‐0998.13014">https://doi.org/10.1111/1755‐0998.13014</a>.
</div>
<div id="ref-alberdi2019hilldiv" class="csl-entry" role="doc-biblioentry">
———. 2019b. <span>“Hilldiv: An r Package for the Integral Analysis of Diversity Based on Hill Numbers.”</span> <em>bioRxiv</em>, 545665. <a href="https://doi.org/10.1101/545665">https://doi.org/10.1101/545665</a>.
</div>
</div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
<h3 id="references">References</h3>
<div id="references-listing"></div>
<h3 id="updates-and-corrections">Corrections</h3>
<p>If you see mistakes or want to suggest changes, please <a href="https://github.com/tropical-repo/web/issues/new">create an issue</a> on the source repository.</p>
<h3 id="reuse">Reuse</h3>
<p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>. Source code is available at <a href="https://github.com/tropical-repo/web/">https://github.com/tropical-repo/web/</a>, unless otherwise noted. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<div class="distill-site-nav distill-site-footer">
<p>© Copyright 2021 The TROPICAL-REPO Project.</p>
<p>Site constructed using <a href="https://rstudio.github.io/distill/">Distill for R Markdown</a>.</p>
</div>
<!--/radix_placeholder_navigation_after_body-->


</body>

</html>
